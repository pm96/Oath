{"version":3,"names":["_streakService","require","StreakRecoveryService","exports","_classCallCheck2","default","_createClass2","key","value","generateBrokenStreakMessage","habitId","previousStreak","habitName","messages","title","message","randomMessage","Math","floor","random","length","type","actionText","reminderOffered","generateRestartEncouragement","bestStreak","targetStreak","encouragementMessages","generateAchievementPreservationMessage","totalCompletions","generateMultipleBreakGuidance","brokenStreakCount","guidance","push","description","actionSteps","generateRestartReminderOffer","userTimezone","defaultTime","getOptimalReminderTime","_getStreakRecoverySupport","_asyncToGenerator2","userId","streak","streakService","getHabitStreak","Error","estimateBrokenStreakCount","motivationalMessage","restartEncouragement","achievementPreservation","estimateTotalCompletions","restartReminder","result","multipleBreakGuidance","getStreakRecoverySupport","_x","_x2","_x3","apply","arguments","isStreakBroken","timezone","undefined","currentStreak","today","Date","toISOString","split","yesterday","now","lastCompletionDate","_getRecoveryMessageForStreak","getRecoveryMessageForStreak","_x4","_x5","_x6","morningHabits","eveningHabits","habitLower","toLowerCase","some","h","includes","performanceRatio","streakRecoveryService"],"sources":["streakRecoveryService.ts"],"sourcesContent":["import { HabitStreak } from \"../../types/habit-streaks\";\nimport { streakService } from \"./streakService\";\n\n/**\n * Streak Recovery and Motivation Service\n *\n * Handles motivational messaging, recovery guidance, and restart assistance\n * when users break their habit streaks.\n *\n * Requirements: 7.1, 7.2, 7.3, 7.4, 7.5\n */\n\nexport interface StreakRecoveryMessage {\n    type:\n    | \"broken_streak\"\n    | \"restart_encouragement\"\n    | \"achievement_preservation\"\n    | \"multiple_breaks\"\n    | \"restart_reminder\";\n    title: string;\n    message: string;\n    actionText?: string;\n    targetStreak?: number;\n    reminderOffered?: boolean;\n}\n\nexport interface MultipleBreakGuidance {\n    type:\n    | \"habit_stacking\"\n    | \"easier_goals\"\n    | \"schedule_adjustment\"\n    | \"accountability_partner\";\n    title: string;\n    description: string;\n    actionSteps: string[];\n}\n\nexport interface RestartReminderOptions {\n    enabled: boolean;\n    time: string; // HH:MM format\n    timezone: string;\n    message: string;\n}\n\nexport class StreakRecoveryService {\n    /**\n     * Generate motivational message for a broken streak\n     * Requirements: 7.1\n     */\n    generateBrokenStreakMessage(\n        habitId: string,\n        previousStreak: number,\n        habitName: string,\n    ): StreakRecoveryMessage {\n        const messages = [\n            {\n                title: \"Don't Give Up! üí™\",\n                message: `Your ${previousStreak}-day streak with ${habitName} was amazing! Every expert was once a beginner who refused to give up. Today is a fresh start.`,\n            },\n            {\n                title: \"Progress, Not Perfection ‚ú®\",\n                message: `You built a ${previousStreak}-day streak with ${habitName} - that's real progress! One missed day doesn't erase your achievement. Let's get back on track.`,\n            },\n            {\n                title: \"Comeback Time! üöÄ\",\n                message: `The best comeback stories start with a single step. Your ${previousStreak}-day streak proves you can do this. Ready to start your next chapter?`,\n            },\n            {\n                title: \"Resilience in Action üå±\",\n                message: `Building habits is like growing a garden - sometimes you need to replant. Your ${previousStreak}-day streak shows your dedication. Time to grow again!`,\n            },\n        ];\n\n        const randomMessage = messages[Math.floor(Math.random() * messages.length)];\n\n        return {\n            type: \"broken_streak\",\n            title: randomMessage.title,\n            message: randomMessage.message,\n            actionText: \"Start Fresh Today\",\n            reminderOffered: true,\n        };\n    }\n\n    /**\n     * Generate restart encouragement with previous best streak targeting\n     * Requirements: 7.2\n     */\n    generateRestartEncouragement(\n        habitId: string,\n        bestStreak: number,\n        habitName: string,\n    ): StreakRecoveryMessage {\n        const targetStreak = bestStreak + 1; // Aim to beat previous best\n\n        const encouragementMessages = [\n            {\n                title: \"Beat Your Record! üéØ\",\n                message: `Your best streak with ${habitName} was ${bestStreak} days. You've done it before - now let's aim for ${targetStreak} days and set a new personal record!`,\n            },\n            {\n                title: \"Level Up Challenge üìà\",\n                message: `Time to level up! Your ${bestStreak}-day streak was impressive. Can you push it to ${targetStreak} days this time? You've got this!`,\n            },\n            {\n                title: \"New Personal Best Awaits üèÜ\",\n                message: `You crushed ${bestStreak} days before with ${habitName}. Your next goal: ${targetStreak} days. Every champion has comeback stories!`,\n            },\n        ];\n\n        const randomMessage =\n            encouragementMessages[\n            Math.floor(Math.random() * encouragementMessages.length)\n            ];\n\n        return {\n            type: \"restart_encouragement\",\n            title: randomMessage.title,\n            message: randomMessage.message,\n            actionText: `Aim for ${targetStreak} Days`,\n            targetStreak: targetStreak,\n        };\n    }\n\n    /**\n     * Generate achievement preservation message\n     * Requirements: 7.3\n     */\n    generateAchievementPreservationMessage(\n        habitId: string,\n        bestStreak: number,\n        totalCompletions: number,\n        habitName: string,\n    ): StreakRecoveryMessage {\n        return {\n            type: \"achievement_preservation\",\n            title: \"Your Progress Still Counts! üèÖ\",\n            message: `Remember: You've completed ${habitName} ${totalCompletions} times and achieved a ${bestStreak}-day streak. That's real progress that no one can take away. One missed day doesn't erase your dedication and growth.`,\n            actionText: \"View My Achievements\",\n        };\n    }\n\n    /**\n     * Generate guidance for users with multiple broken streaks\n     * Requirements: 7.4\n     */\n    generateMultipleBreakGuidance(\n        brokenStreakCount: number,\n    ): MultipleBreakGuidance[] {\n        const guidance: MultipleBreakGuidance[] = [];\n\n        if (brokenStreakCount >= 2) {\n            guidance.push({\n                type: \"habit_stacking\",\n                title: \"Try Habit Stacking\",\n                description:\n                    \"Link your new habit to an existing routine you already do consistently.\",\n                actionSteps: [\n                    \"Choose a habit you never miss (like brushing teeth)\",\n                    \"Do your new habit immediately after the existing one\",\n                    \"Start with just 2 minutes to build the connection\",\n                    \"Gradually increase duration once the link is strong\",\n                ],\n            });\n        }\n\n        if (brokenStreakCount >= 3) {\n            guidance.push({\n                type: \"easier_goals\",\n                title: \"Start Smaller\",\n                description:\n                    \"Sometimes we aim too high too fast. Let's build momentum with easier wins.\",\n                actionSteps: [\n                    \"Reduce your habit to the smallest possible version\",\n                    \"Focus on consistency over intensity\",\n                    \"Celebrate small wins to build confidence\",\n                    \"Gradually increase difficulty after 2 weeks of consistency\",\n                ],\n            });\n        }\n\n        if (brokenStreakCount >= 4) {\n            guidance.push({\n                type: \"schedule_adjustment\",\n                title: \"Optimize Your Timing\",\n                description:\n                    \"Your schedule might be working against you. Let's find your optimal time.\",\n                actionSteps: [\n                    \"Track when you have the most energy and motivation\",\n                    \"Schedule habits during your peak performance times\",\n                    \"Prepare everything the night before\",\n                    \"Set up environmental cues to trigger the habit\",\n                ],\n            });\n        }\n\n        if (brokenStreakCount >= 5) {\n            guidance.push({\n                type: \"accountability_partner\",\n                title: \"Get Support\",\n                description:\n                    \"Sometimes we need external accountability to stay on track.\",\n                actionSteps: [\n                    \"Share your goals with friends or family\",\n                    \"Find an accountability partner with similar goals\",\n                    \"Join online communities focused on your habit\",\n                    \"Consider working with a coach or mentor\",\n                ],\n            });\n        }\n\n        return guidance;\n    }\n\n    /**\n     * Generate restart reminder offer\n     * Requirements: 7.5\n     */\n    generateRestartReminderOffer(\n        habitId: string,\n        habitName: string,\n        userTimezone: string,\n    ): StreakRecoveryMessage {\n        // Suggest optimal reminder times based on habit type\n        const defaultTime = this.getOptimalReminderTime(habitName);\n\n        return {\n            type: \"restart_reminder\",\n            title: \"Set a Restart Reminder? ‚è∞\",\n            message: `Would you like me to remind you tomorrow to restart your ${habitName} habit? I can send you a gentle nudge at the perfect time.`,\n            actionText: \"Set Reminder\",\n            reminderOffered: true,\n        };\n    }\n\n    /**\n     * Get comprehensive recovery support for a broken streak\n     * Combines all recovery elements into a complete support package\n     */\n    async getStreakRecoverySupport(\n        habitId: string,\n        userId: string,\n        habitName: string,\n    ): Promise<{\n        motivationalMessage: StreakRecoveryMessage;\n        restartEncouragement: StreakRecoveryMessage;\n        achievementPreservation: StreakRecoveryMessage;\n        multipleBreakGuidance?: MultipleBreakGuidance[];\n        restartReminder: StreakRecoveryMessage;\n    }> {\n        // Get current streak data\n        const streak = await streakService.getHabitStreak(habitId, userId);\n        if (!streak) {\n            throw new Error(\"Streak data not found\");\n        }\n\n        // Get user's broken streak history (simplified - in real implementation,\n        // this would track historical break patterns)\n        const brokenStreakCount = this.estimateBrokenStreakCount(streak);\n\n        // Generate all recovery components\n        const motivationalMessage = this.generateBrokenStreakMessage(\n            habitId,\n            streak.bestStreak,\n            habitName,\n        );\n\n        const restartEncouragement = this.generateRestartEncouragement(\n            habitId,\n            streak.bestStreak,\n            habitName,\n        );\n\n        const achievementPreservation = this.generateAchievementPreservationMessage(\n            habitId,\n            streak.bestStreak,\n            this.estimateTotalCompletions(streak),\n            habitName,\n        );\n\n        const restartReminder = this.generateRestartReminderOffer(\n            habitId,\n            habitName,\n            \"UTC\", // Would get from user preferences\n        );\n\n        const result: any = {\n            motivationalMessage,\n            restartEncouragement,\n            achievementPreservation,\n            restartReminder,\n        };\n\n        // Add multiple break guidance if needed\n        if (brokenStreakCount >= 2) {\n            result.multipleBreakGuidance =\n                this.generateMultipleBreakGuidance(brokenStreakCount);\n        }\n\n        return result;\n    }\n\n    /**\n     * Check if a streak is considered \"broken\" (no completion yesterday or today)\n     */\n    isStreakBroken(streak: HabitStreak, timezone: string = \"UTC\"): boolean {\n        if (streak.currentStreak === 0) {\n            return true;\n        }\n\n        // Check if last completion was recent enough to maintain streak\n        const today = new Date().toISOString().split(\"T\")[0];\n        const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000)\n            .toISOString()\n            .split(\"T\")[0];\n\n        return (\n            streak.lastCompletionDate !== today &&\n            streak.lastCompletionDate !== yesterday\n        );\n    }\n\n    /**\n     * Get recovery message based on streak status\n     */\n    async getRecoveryMessageForStreak(\n        habitId: string,\n        userId: string,\n        habitName: string,\n    ): Promise<StreakRecoveryMessage | null> {\n        const streak = await streakService.getHabitStreak(habitId, userId);\n        if (!streak) {\n            return null;\n        }\n\n        if (this.isStreakBroken(streak)) {\n            return this.generateBrokenStreakMessage(\n                habitId,\n                streak.bestStreak,\n                habitName,\n            );\n        }\n\n        return null;\n    }\n\n    // Private helper methods\n\n    private getOptimalReminderTime(habitName: string): string {\n        // Simple heuristic for optimal reminder times based on habit type\n        const morningHabits = [\"exercise\", \"meditation\", \"reading\", \"journaling\"];\n        const eveningHabits = [\"reflection\", \"planning\", \"stretching\"];\n\n        const habitLower = habitName.toLowerCase();\n\n        if (morningHabits.some((h) => habitLower.includes(h))) {\n            return \"08:00\";\n        } else if (eveningHabits.some((h) => habitLower.includes(h))) {\n            return \"20:00\";\n        } else {\n            return \"10:00\"; // Default morning time\n        }\n    }\n\n    private estimateBrokenStreakCount(streak: HabitStreak): number {\n        // Simplified estimation based on the ratio of best streak to current performance\n        // In a real implementation, this would track historical break patterns\n        if (streak.bestStreak === 0) return 0;\n\n        const performanceRatio = streak.currentStreak / streak.bestStreak;\n\n        if (performanceRatio < 0.1) return 5; // Very poor recent performance\n        if (performanceRatio < 0.3) return 4;\n        if (performanceRatio < 0.5) return 3;\n        if (performanceRatio < 0.7) return 2;\n        return 1;\n    }\n\n    private estimateTotalCompletions(streak: HabitStreak): number {\n        // Simplified estimation - in real implementation, this would query completion history\n        return streak.bestStreak + Math.floor(streak.bestStreak * 0.3);\n    }\n}\n\n// Export singleton instance\nexport const streakRecoveryService = new StreakRecoveryService();\n"],"mappings":"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","ignoreList":[]}