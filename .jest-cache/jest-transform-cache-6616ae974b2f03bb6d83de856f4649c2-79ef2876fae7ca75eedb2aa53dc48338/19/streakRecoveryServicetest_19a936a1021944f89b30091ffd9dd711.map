{"version":3,"names":["describe","it","messageTypes","forEach","type","expect","toBe","length","toBeGreaterThan","habitNames","name","guidanceStrategies","minBreaks","strategy","_ref","timeSlots","time","toMatch","_time$split$map","split","map","Number","_time$split$map2","_slicedToArray2","default","hours","minutes","toBeGreaterThanOrEqual","toBeLessThan","streakStatuses","currentStreak","isBroken","lastCompletion","_ref2","testCases","current","best","expectedRatio","_ref3","ratio","toBeCloseTo","bestStreak","expectedTarget","_ref4","target","requiredMessageFields","optionalMessageFields","concat","field","requiredGuidanceFields","requirements","requirement"],"sources":["streakRecoveryService.test.ts"],"sourcesContent":["/**\n * Tests for StreakRecoveryService\n *\n * Note: These tests focus on the core logic without Firebase dependencies\n * Requirements: 7.1, 7.2, 7.3, 7.4, 7.5\n */\n\ndescribe(\"StreakRecoveryService Core Logic\", () => {\n    describe(\"Message Generation Logic\", () => {\n        it(\"should generate different message types\", () => {\n            // Test the message type constants\n            const messageTypes = [\n                \"broken_streak\",\n                \"restart_encouragement\",\n                \"achievement_preservation\",\n                \"multiple_breaks\",\n                \"restart_reminder\",\n            ];\n\n            messageTypes.forEach((type) => {\n                expect(typeof type).toBe(\"string\");\n                expect(type.length).toBeGreaterThan(0);\n            });\n        });\n\n        it(\"should handle habit name variations\", () => {\n            const habitNames = [\n                \"Daily Exercise\",\n                \"Meditation\",\n                \"Reading\",\n                \"Journaling\",\n                \"Water Intake\",\n            ];\n\n            habitNames.forEach((name) => {\n                expect(typeof name).toBe(\"string\");\n                expect(name.length).toBeGreaterThan(0);\n            });\n        });\n    });\n\n    describe(\"Guidance Strategy Logic\", () => {\n        it(\"should provide appropriate guidance based on break count\", () => {\n            // Test guidance strategy mapping\n            const guidanceStrategies = [\n                { minBreaks: 2, strategy: \"habit_stacking\" },\n                { minBreaks: 3, strategy: \"easier_goals\" },\n                { minBreaks: 4, strategy: \"schedule_adjustment\" },\n                { minBreaks: 5, strategy: \"accountability_partner\" },\n            ];\n\n            guidanceStrategies.forEach(({ minBreaks, strategy }) => {\n                expect(minBreaks).toBeGreaterThan(1);\n                expect(typeof strategy).toBe(\"string\");\n                expect(strategy.length).toBeGreaterThan(0);\n            });\n        });\n    });\n\n    describe(\"Reminder Time Logic\", () => {\n        it(\"should suggest appropriate reminder times\", () => {\n            const timeSlots = [\"07:00\", \"08:00\", \"09:00\", \"18:00\", \"19:00\", \"20:00\"];\n\n            timeSlots.forEach((time) => {\n                expect(time).toMatch(/^\\d{2}:\\d{2}$/);\n                const [hours, minutes] = time.split(\":\").map(Number);\n                expect(hours).toBeGreaterThanOrEqual(0);\n                expect(hours).toBeLessThan(24);\n                expect(minutes).toBeGreaterThanOrEqual(0);\n                expect(minutes).toBeLessThan(60);\n            });\n        });\n    });\n\n    describe(\"Streak Status Logic\", () => {\n        it(\"should identify broken streaks correctly\", () => {\n            // Test streak status identification logic\n            const streakStatuses = [\n                { currentStreak: 0, isBroken: true },\n                { currentStreak: 5, lastCompletion: \"recent\", isBroken: false },\n                { currentStreak: 3, lastCompletion: \"old\", isBroken: true },\n            ];\n\n            streakStatuses.forEach(({ currentStreak, isBroken }) => {\n                if (currentStreak === 0) {\n                    expect(isBroken).toBe(true);\n                }\n                expect(typeof isBroken).toBe(\"boolean\");\n            });\n        });\n    });\n\n    describe(\"Performance Ratio Calculation\", () => {\n        it(\"should calculate performance ratios correctly\", () => {\n            const testCases = [\n                { current: 1, best: 10, expectedRatio: 0.1 },\n                { current: 5, best: 10, expectedRatio: 0.5 },\n                { current: 8, best: 10, expectedRatio: 0.8 },\n                { current: 0, best: 0, expectedRatio: 0 },\n            ];\n\n            testCases.forEach(({ current, best, expectedRatio }) => {\n                const ratio = best > 0 ? current / best : 0;\n                expect(ratio).toBeCloseTo(expectedRatio, 2);\n            });\n        });\n    });\n\n    describe(\"Target Streak Calculation\", () => {\n        it(\"should calculate target streaks correctly\", () => {\n            const testCases = [\n                { bestStreak: 10, expectedTarget: 11 },\n                { bestStreak: 30, expectedTarget: 31 },\n                { bestStreak: 0, expectedTarget: 1 },\n            ];\n\n            testCases.forEach(({ bestStreak, expectedTarget }) => {\n                const target = bestStreak + 1;\n                expect(target).toBe(expectedTarget);\n            });\n        });\n    });\n\n    describe(\"Message Content Validation\", () => {\n        it(\"should ensure messages contain required elements\", () => {\n            // Test message structure requirements\n            const requiredMessageFields = [\"type\", \"title\", \"message\"];\n\n            const optionalMessageFields = [\n                \"actionText\",\n                \"targetStreak\",\n                \"reminderOffered\",\n            ];\n\n            [...requiredMessageFields, ...optionalMessageFields].forEach((field) => {\n                expect(typeof field).toBe(\"string\");\n                expect(field.length).toBeGreaterThan(0);\n            });\n        });\n    });\n\n    describe(\"Guidance Structure Validation\", () => {\n        it(\"should ensure guidance contains required elements\", () => {\n            const requiredGuidanceFields = [\n                \"type\",\n                \"title\",\n                \"description\",\n                \"actionSteps\",\n            ];\n\n            requiredGuidanceFields.forEach((field) => {\n                expect(typeof field).toBe(\"string\");\n                expect(field.length).toBeGreaterThan(0);\n            });\n        });\n    });\n\n    describe(\"Requirements Coverage\", () => {\n        it(\"should cover all streak recovery requirements\", () => {\n            const requirements = [\n                \"7.1: Motivational messaging for broken streaks\",\n                \"7.2: Previous best streak targeting\",\n                \"7.3: Achievement preservation messaging\",\n                \"7.4: Guidance for multiple broken streaks\",\n                \"7.5: Restart reminder offering\",\n            ];\n\n            requirements.forEach((requirement) => {\n                expect(requirement).toMatch(/^7\\.\\d+:/);\n                expect(requirement.length).toBeGreaterThan(10);\n            });\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}