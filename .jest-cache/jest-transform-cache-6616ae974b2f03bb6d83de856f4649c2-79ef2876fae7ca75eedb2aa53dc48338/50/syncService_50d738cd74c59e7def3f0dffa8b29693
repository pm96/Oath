2e8a476eee6d0e37b6e4bf3699fc9ac9
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.syncService = exports.SyncService = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _firebaseConfig = require("../../firebaseConfig");
var _errorHandling = require("../../utils/errorHandling");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _firestore = require("firebase/firestore");
var _collections = require("./collections");
var _habitStreakSchemas = require("./habitStreakSchemas");
var SyncService = exports.SyncService = function () {
  function SyncService() {
    (0, _classCallCheck2.default)(this, SyncService);
    this.syncListeners = new Map();
    this.pendingOperations = new Map();
    this.syncStatus = {
      isOnline: true,
      lastSync: null,
      pendingOperations: 0,
      syncInProgress: false
    };
    this.statusCallbacks = new Set();
    this.initializeSync();
  }
  return (0, _createClass2.default)(SyncService, [{
    key: "initializeSync",
    value: (function () {
      var _initializeSync = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield this.loadPendingOperations();
          var online = yield (0, _errorHandling.isOnline)();
          this.updateSyncStatus({
            isOnline: online
          });
          if (online) {
            yield this.processPendingOperations();
          }
          this.startConnectivityMonitoring();
        } catch (error) {
          console.error("Failed to initialize sync service:", error);
        }
      });
      function initializeSync() {
        return _initializeSync.apply(this, arguments);
      }
      return initializeSync;
    }())
  }, {
    key: "startRealtimeSync",
    value: (function () {
      var _startRealtimeSync = (0, _asyncToGenerator2.default)(function* (userId) {
        var _this = this;
        if (!userId) {
          throw new Error("User ID is required for sync");
        }
        this.stopRealtimeSync(userId);
        try {
          var streaksCollection = (0, _collections.getHabitStreaksCollection)();
          var streaksQuery = (0, _firestore.query)(streaksCollection, (0, _firestore.where)("userId", "==", userId));
          var streakListener = (0, _firestore.onSnapshot)(streaksQuery, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref = (0, _asyncToGenerator2.default)(function* (change) {
                var streakData = change.doc.data();
                yield _this.handleRealtimeStreakUpdate(change.doc.id, streakData, change.type);
              });
              return function (_x2) {
                return _ref.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Streak sync error:", error);
            _this.handleSyncError(error);
          });
          var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
          var completionsQuery = (0, _firestore.query)(completionsCollection, (0, _firestore.where)("userId", "==", userId));
          var completionListener = (0, _firestore.onSnapshot)(completionsQuery, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref2 = (0, _asyncToGenerator2.default)(function* (change) {
                var completionData = change.doc.data();
                yield _this.handleRealtimeCompletionUpdate(change.doc.id, completionData, change.type);
              });
              return function (_x3) {
                return _ref2.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Completion sync error:", error);
            _this.handleSyncError(error);
          });
          this.syncListeners.set(`streaks_${userId}`, streakListener);
          this.syncListeners.set(`completions_${userId}`, completionListener);
        } catch (error) {
          console.error("Failed to start realtime sync:", error);
          throw error;
        }
      });
      function startRealtimeSync(_x) {
        return _startRealtimeSync.apply(this, arguments);
      }
      return startRealtimeSync;
    }())
  }, {
    key: "stopRealtimeSync",
    value: function stopRealtimeSync(userId) {
      var streakKey = `streaks_${userId}`;
      var completionKey = `completions_${userId}`;
      var streakListener = this.syncListeners.get(streakKey);
      if (streakListener) {
        streakListener();
        this.syncListeners.delete(streakKey);
      }
      var completionListener = this.syncListeners.get(completionKey);
      if (completionListener) {
        completionListener();
        this.syncListeners.delete(completionKey);
      }
    }
  }, {
    key: "cacheData",
    value: (function () {
      var _cacheData = (0, _asyncToGenerator2.default)(function* (key, data) {
        var version = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
        try {
          var checksum = this.generateChecksum(data);
          var cachedData = {
            data: data,
            timestamp: _firestore.Timestamp.now(),
            version: version,
            checksum: checksum
          };
          yield _asyncStorage.default.setItem(key, JSON.stringify(cachedData));
        } catch (error) {
          console.error("Failed to cache data:", error);
        }
      });
      function cacheData(_x4, _x5) {
        return _cacheData.apply(this, arguments);
      }
      return cacheData;
    }())
  }, {
    key: "getCachedData",
    value: (function () {
      var _getCachedData = (0, _asyncToGenerator2.default)(function* (key) {
        try {
          var cachedString = yield _asyncStorage.default.getItem(key);
          if (!cachedString) {
            return null;
          }
          var cachedData = JSON.parse(cachedString);
          var expectedChecksum = this.generateChecksum(cachedData.data);
          if (cachedData.checksum !== expectedChecksum) {
            console.warn("Cache integrity check failed, removing corrupted data");
            yield _asyncStorage.default.removeItem(key);
            return null;
          }
          return cachedData.data;
        } catch (error) {
          console.error("Failed to retrieve cached data:", error);
          return null;
        }
      });
      function getCachedData(_x6) {
        return _getCachedData.apply(this, arguments);
      }
      return getCachedData;
    }())
  }, {
    key: "updateAggregateRecord",
    value: function () {
      var _updateAggregateRecord = (0, _asyncToGenerator2.default)(function* (key, docId, entry) {
        var current = (yield this.getCachedData(key)) || {};
        if (entry) {
          current[docId] = entry;
        } else {
          delete current[docId];
        }
        yield this.cacheData(key, current);
      });
      function updateAggregateRecord(_x7, _x8, _x9) {
        return _updateAggregateRecord.apply(this, arguments);
      }
      return updateAggregateRecord;
    }()
  }, {
    key: "getCachedStreakMap",
    value: function () {
      var _getCachedStreakMap = (0, _asyncToGenerator2.default)(function* () {
        var record = (yield this.getCachedData(SyncService.CACHE_KEYS.STREAKS)) || {};
        return Object.values(record).reduce(function (acc, streak) {
          if (streak.habitId) {
            acc[streak.habitId] = streak;
          }
          return acc;
        }, {});
      });
      function getCachedStreakMap() {
        return _getCachedStreakMap.apply(this, arguments);
      }
      return getCachedStreakMap;
    }()
  }, {
    key: "getCachedCompletionsMap",
    value: function () {
      var _getCachedCompletionsMap = (0, _asyncToGenerator2.default)(function* () {
        return (yield this.getCachedData(SyncService.CACHE_KEYS.COMPLETIONS)) || {};
      });
      function getCachedCompletionsMap() {
        return _getCachedCompletionsMap.apply(this, arguments);
      }
      return getCachedCompletionsMap;
    }()
  }, {
    key: "cleanupCachePrefix",
    value: (function () {
      var _cleanupCachePrefix = (0, _asyncToGenerator2.default)(function* (prefix, activeDocIds) {
        try {
          var allKeys = yield _asyncStorage.default.getAllKeys();
          if (!allKeys || allKeys.length === 0) {
            return;
          }
          var prefixWithSeparator = `${prefix}_`;
          var allowedKeys = activeDocIds && new Set(Array.from(activeDocIds.values()).map(function (id) {
            return `${prefixWithSeparator}${id}`;
          }));
          var keysToRemove = allKeys.filter(function (key) {
            if (!key.startsWith(prefixWithSeparator)) {
              return false;
            }
            if (!allowedKeys) {
              return true;
            }
            return !allowedKeys.has(key);
          });
          if (keysToRemove.length > 0) {
            yield _asyncStorage.default.multiRemove(keysToRemove);
          }
        } catch (error) {
          console.error("Failed to clean up cache prefix:", error);
        }
      });
      function cleanupCachePrefix(_x0, _x1) {
        return _cleanupCachePrefix.apply(this, arguments);
      }
      return cleanupCachePrefix;
    }())
  }, {
    key: "queueOperation",
    value: (function () {
      var _queueOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var syncOp = Object.assign({}, operation, {
          id: this.generateOperationId(),
          timestamp: _firestore.Timestamp.now(),
          retryCount: 0
        });
        this.pendingOperations.set(syncOp.id, syncOp);
        yield this.savePendingOperations();
        this.updateSyncStatus({
          pendingOperations: this.pendingOperations.size
        });
        if (this.syncStatus.isOnline) {
          yield this.processPendingOperations();
        }
      });
      function queueOperation(_x10) {
        return _queueOperation.apply(this, arguments);
      }
      return queueOperation;
    }())
  }, {
    key: "processPendingOperations",
    value: (function () {
      var _processPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        if (this.syncStatus.syncInProgress || this.pendingOperations.size === 0) {
          return;
        }
        this.updateSyncStatus({
          syncInProgress: true
        });
        try {
          var operations = Array.from(this.pendingOperations.values()).sort(function (a, b) {
            return a.timestamp.toMillis() - b.timestamp.toMillis();
          });
          for (var operation of operations) {
            try {
              yield this.executeOperation(operation);
              this.pendingOperations.delete(operation.id);
            } catch (error) {
              console.error("Failed to execute operation:", error);
              operation.retryCount++;
              operation.lastAttempt = _firestore.Timestamp.now();
              if (operation.retryCount >= 3) {
                console.warn("Max retries exceeded, removing operation:", operation.id);
                this.pendingOperations.delete(operation.id);
              }
            }
          }
          yield this.savePendingOperations();
          this.updateSyncStatus({
            pendingOperations: this.pendingOperations.size,
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function processPendingOperations() {
        return _processPendingOperations.apply(this, arguments);
      }
      return processPendingOperations;
    }())
  }, {
    key: "executeOperation",
    value: (function () {
      var _executeOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var _this2 = this;
        return yield (0, _errorHandling.retryWithBackoff)((0, _asyncToGenerator2.default)(function* () {
          return yield (0, _firestore.runTransaction)(_firebaseConfig.db, function () {
            var _ref4 = (0, _asyncToGenerator2.default)(function* (transaction) {
              switch (operation.type) {
                case "completion":
                  yield _this2.executeCompletionOperation(operation, transaction);
                  break;
                case "streak":
                  yield _this2.executeStreakOperation(operation, transaction);
                  break;
                case "milestone":
                  yield _this2.executeMilestoneOperation(operation, transaction);
                  break;
                default:
                  throw new Error(`Unknown operation type: ${operation.type}`);
              }
            });
            return function (_x12) {
              return _ref4.apply(this, arguments);
            };
          }());
        }));
      });
      function executeOperation(_x11) {
        return _executeOperation.apply(this, arguments);
      }
      return executeOperation;
    }())
  }, {
    key: "handleRealtimeStreakUpdate",
    value: (function () {
      var _handleRealtimeStreakUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            yield this.updateAggregateRecord(SyncService.CACHE_KEYS.STREAKS, docId);
            return;
          }
          var streak = (0, _habitStreakSchemas.transformFirestoreToStreak)(data);
          var cacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
          var cachedStreak = yield this.getCachedData(cacheKey);
          if (cachedStreak && this.hasConflict(cachedStreak, streak)) {
            var resolvedStreak = yield this.resolveStreakConflict(cachedStreak, streak);
            yield this.cacheData(cacheKey, resolvedStreak);
          } else {
            yield this.cacheData(cacheKey, streak);
          }
          yield this.updateAggregateRecord(SyncService.CACHE_KEYS.STREAKS, docId, streak);
        } catch (error) {
          console.error("Error handling realtime streak update:", error);
        }
      });
      function handleRealtimeStreakUpdate(_x13, _x14, _x15) {
        return _handleRealtimeStreakUpdate.apply(this, arguments);
      }
      return handleRealtimeStreakUpdate;
    }())
  }, {
    key: "handleRealtimeCompletionUpdate",
    value: (function () {
      var _handleRealtimeCompletionUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            yield this.updateAggregateRecord(SyncService.CACHE_KEYS.COMPLETIONS, docId);
            return;
          }
          var completion = (0, _habitStreakSchemas.transformFirestoreToCompletion)(docId, data);
          var cacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
          yield this.cacheData(cacheKey, completion);
          yield this.updateAggregateRecord(SyncService.CACHE_KEYS.COMPLETIONS, docId, completion);
        } catch (error) {
          console.error("Error handling realtime completion update:", error);
        }
      });
      function handleRealtimeCompletionUpdate(_x16, _x17, _x18) {
        return _handleRealtimeCompletionUpdate.apply(this, arguments);
      }
      return handleRealtimeCompletionUpdate;
    }())
  }, {
    key: "resolveStreakConflict",
    value: (function () {
      var _resolveStreakConflict = (0, _asyncToGenerator2.default)(function* (localStreak, remoteStreak) {
        if (!localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          return remoteStreak;
        }
        if (localStreak.lastCompletionDate && !remoteStreak.lastCompletionDate) {
          return localStreak;
        }
        if (localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          if (localStreak.lastCompletionDate > remoteStreak.lastCompletionDate) {
            return localStreak;
          } else if (localStreak.lastCompletionDate < remoteStreak.lastCompletionDate) {
            return remoteStreak;
          } else {
            return localStreak.currentStreak >= remoteStreak.currentStreak ? localStreak : remoteStreak;
          }
        }
        return remoteStreak;
      });
      function resolveStreakConflict(_x19, _x20) {
        return _resolveStreakConflict.apply(this, arguments);
      }
      return resolveStreakConflict;
    }())
  }, {
    key: "hasConflict",
    value: function hasConflict(local, remote) {
      return local.currentStreak !== remote.currentStreak || local.bestStreak !== remote.bestStreak || local.lastCompletionDate !== remote.lastCompletionDate || local.freezesAvailable !== remote.freezesAvailable || local.freezesUsed !== remote.freezesUsed;
    }
  }, {
    key: "executeCompletionOperation",
    value: (function () {
      var _executeCompletionOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
        switch (operation.action) {
          case "create":
            var completionRef = (0, _firestore.doc)(completionsCollection);
            transaction.set(completionRef, Object.assign({}, operation.data, {
              createdAt: (0, _firestore.serverTimestamp)()
            }));
            break;
          case "update":
            var updateRef = (0, _firestore.doc)(completionsCollection, operation.data.id);
            transaction.update(updateRef, Object.assign({}, operation.data, {
              updatedAt: (0, _firestore.serverTimestamp)()
            }));
            break;
          case "delete":
            var deleteRef = (0, _firestore.doc)(completionsCollection, operation.data.id);
            transaction.delete(deleteRef);
            break;
        }
      });
      function executeCompletionOperation(_x21, _x22) {
        return _executeCompletionOperation.apply(this, arguments);
      }
      return executeCompletionOperation;
    }())
  }, {
    key: "executeStreakOperation",
    value: (function () {
      var _executeStreakOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var streaksCollection = (0, _collections.getHabitStreaksCollection)();
        var streakId = (0, _habitStreakSchemas.generateStreakId)(operation.userId, operation.habitId);
        var streakRef = (0, _firestore.doc)(streaksCollection, streakId);
        switch (operation.action) {
          case "create":
          case "update":
            var streakData = (0, _habitStreakSchemas.transformStreakToFirestore)(operation.data);
            transaction.set(streakRef, streakData);
            break;
          case "delete":
            transaction.delete(streakRef);
            break;
        }
      });
      function executeStreakOperation(_x23, _x24) {
        return _executeStreakOperation.apply(this, arguments);
      }
      return executeStreakOperation;
    }())
  }, {
    key: "executeMilestoneOperation",
    value: (function () {
      var _executeMilestoneOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        console.log("Executing milestone operation:", operation);
      });
      function executeMilestoneOperation(_x25, _x26) {
        return _executeMilestoneOperation.apply(this, arguments);
      }
      return executeMilestoneOperation;
    }())
  }, {
    key: "generateChecksum",
    value: function generateChecksum(data) {
      var str = JSON.stringify(data);
      var hash = 0;
      for (var i = 0; i < str.length; i++) {
        var char = str.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash = hash & hash;
      }
      return hash.toString();
    }
  }, {
    key: "generateOperationId",
    value: function generateOperationId() {
      return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
  }, {
    key: "savePendingOperations",
    value: (function () {
      var _savePendingOperations = (0, _asyncToGenerator2.default)(function* () {
        try {
          var operations = Array.from(this.pendingOperations.values());
          var serialized = operations.map(function (op) {
            var _op$lastAttempt;
            return Object.assign({}, op, {
              timestamp: op.timestamp.toMillis(),
              lastAttempt: (_op$lastAttempt = op.lastAttempt) == null ? void 0 : _op$lastAttempt.toMillis()
            });
          });
          yield _asyncStorage.default.setItem(SyncService.CACHE_KEYS.PENDING_OPS, JSON.stringify(serialized));
        } catch (error) {
          console.error("Failed to save pending operations:", error);
        }
      });
      function savePendingOperations() {
        return _savePendingOperations.apply(this, arguments);
      }
      return savePendingOperations;
    }())
  }, {
    key: "loadPendingOperations",
    value: (function () {
      var _loadPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        var _this3 = this;
        try {
          var stored = yield _asyncStorage.default.getItem(SyncService.CACHE_KEYS.PENDING_OPS);
          if (!stored) return;
          var operations = JSON.parse(stored);
          this.pendingOperations.clear();
          operations.forEach(function (op) {
            var operation = Object.assign({}, op, {
              timestamp: _firestore.Timestamp.fromMillis(op.timestamp),
              lastAttempt: op.lastAttempt ? _firestore.Timestamp.fromMillis(op.lastAttempt) : undefined
            });
            _this3.pendingOperations.set(operation.id, operation);
          });
        } catch (error) {
          console.error("Failed to load pending operations:", error);
        }
      });
      function loadPendingOperations() {
        return _loadPendingOperations.apply(this, arguments);
      }
      return loadPendingOperations;
    }())
  }, {
    key: "startConnectivityMonitoring",
    value: function startConnectivityMonitoring() {
      var _this4 = this;
      setInterval((0, _asyncToGenerator2.default)(function* () {
        var online = yield (0, _errorHandling.isOnline)();
        var wasOnline = _this4.syncStatus.isOnline;
        _this4.updateSyncStatus({
          isOnline: online
        });
        if (online && !wasOnline) {
          console.log("Connection restored, processing pending operations");
          yield _this4.processPendingOperations();
        }
      }), 30000);
    }
  }, {
    key: "handleSyncError",
    value: function handleSyncError(error) {
      var _error$message;
      console.error("Sync error:", error);
      if (error.code === "unavailable" || (_error$message = error.message) != null && _error$message.includes("network")) {
        this.updateSyncStatus({
          isOnline: false
        });
      }
    }
  }, {
    key: "updateSyncStatus",
    value: function updateSyncStatus(updates) {
      var _this5 = this;
      this.syncStatus = Object.assign({}, this.syncStatus, updates);
      this.statusCallbacks.forEach(function (callback) {
        try {
          callback(_this5.syncStatus);
        } catch (error) {
          console.error("Error in sync status callback:", error);
        }
      });
    }
  }, {
    key: "onSyncStatusChange",
    value: function onSyncStatusChange(callback) {
      var _this6 = this;
      this.statusCallbacks.add(callback);
      callback(this.syncStatus);
      return function () {
        _this6.statusCallbacks.delete(callback);
      };
    }
  }, {
    key: "getSyncStatus",
    value: function getSyncStatus() {
      return Object.assign({}, this.syncStatus);
    }
  }, {
    key: "forceSyncUserData",
    value: (function () {
      var _forceSyncUserData = (0, _asyncToGenerator2.default)(function* (userId) {
        if (!this.syncStatus.isOnline) {
          throw new Error("Cannot force sync while offline");
        }
        try {
          this.updateSyncStatus({
            syncInProgress: true
          });
          yield this.syncUserStreaks(userId);
          yield this.syncUserCompletions(userId);
          this.updateSyncStatus({
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function forceSyncUserData(_x27) {
        return _forceSyncUserData.apply(this, arguments);
      }
      return forceSyncUserData;
    }())
  }, {
    key: "syncUserStreaks",
    value: (function () {
      var _syncUserStreaks = (0, _asyncToGenerator2.default)(function* (userId) {
        var _this7 = this;
        try {
          var streaksCollection = (0, _collections.getHabitStreaksCollection)();
          var streaksQuery = (0, _firestore.query)(streaksCollection, (0, _firestore.where)("userId", "==", userId));
          var snapshot = yield (0, _firestore.getDocs)(streaksQuery);
          var streakEntries = snapshot.docs.map(function (docSnap) {
            return {
              id: docSnap.id,
              streak: (0, _habitStreakSchemas.transformFirestoreToStreak)(docSnap.data())
            };
          });
          var aggregateRecord = {};
          yield Promise.all(streakEntries.map(function () {
            var _ref7 = (0, _asyncToGenerator2.default)(function* (_ref6) {
              var id = _ref6.id,
                streak = _ref6.streak;
              aggregateRecord[id] = streak;
              yield _this7.cacheData(`${SyncService.CACHE_KEYS.STREAKS}_${id}`, streak);
            });
            return function (_x29) {
              return _ref7.apply(this, arguments);
            };
          }()));
          yield this.cacheData(SyncService.CACHE_KEYS.STREAKS, aggregateRecord);
          yield this.cleanupCachePrefix(SyncService.CACHE_KEYS.STREAKS, new Set(streakEntries.map(function (entry) {
            return entry.id;
          })));
        } catch (error) {
          console.error("Failed to sync streaks:", error);
        }
      });
      function syncUserStreaks(_x28) {
        return _syncUserStreaks.apply(this, arguments);
      }
      return syncUserStreaks;
    }())
  }, {
    key: "syncUserCompletions",
    value: (function () {
      var _syncUserCompletions = (0, _asyncToGenerator2.default)(function* (userId) {
        var _this8 = this;
        try {
          var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
          var completionsQuery = (0, _firestore.query)(completionsCollection, (0, _firestore.where)("userId", "==", userId));
          var snapshot = yield (0, _firestore.getDocs)(completionsQuery);
          var completionEntries = snapshot.docs.map(function (docSnap) {
            return {
              id: docSnap.id,
              completion: (0, _habitStreakSchemas.transformFirestoreToCompletion)(docSnap.id, docSnap.data())
            };
          });
          var aggregateRecord = {};
          yield Promise.all(completionEntries.map(function () {
            var _ref9 = (0, _asyncToGenerator2.default)(function* (_ref8) {
              var id = _ref8.id,
                completion = _ref8.completion;
              aggregateRecord[id] = completion;
              yield _this8.cacheData(`${SyncService.CACHE_KEYS.COMPLETIONS}_${id}`, completion);
            });
            return function (_x31) {
              return _ref9.apply(this, arguments);
            };
          }()));
          yield this.cacheData(SyncService.CACHE_KEYS.COMPLETIONS, aggregateRecord);
          yield this.cleanupCachePrefix(SyncService.CACHE_KEYS.COMPLETIONS, new Set(completionEntries.map(function (entry) {
            return entry.id;
          })));
        } catch (error) {
          console.error("Failed to sync completions:", error);
        }
      });
      function syncUserCompletions(_x30) {
        return _syncUserCompletions.apply(this, arguments);
      }
      return syncUserCompletions;
    }())
  }, {
    key: "clearCache",
    value: (function () {
      var _clearCache = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield _asyncStorage.default.multiRemove([SyncService.CACHE_KEYS.STREAKS, SyncService.CACHE_KEYS.COMPLETIONS, SyncService.CACHE_KEYS.PENDING_OPS, SyncService.CACHE_KEYS.LAST_SYNC]);
          yield this.cleanupCachePrefix(SyncService.CACHE_KEYS.STREAKS);
          yield this.cleanupCachePrefix(SyncService.CACHE_KEYS.COMPLETIONS);
          this.pendingOperations.clear();
          this.updateSyncStatus({
            pendingOperations: 0,
            lastSync: null
          });
        } catch (error) {
          console.error("Failed to clear cache:", error);
        }
      });
      function clearCache() {
        return _clearCache.apply(this, arguments);
      }
      return clearCache;
    }())
  }], [{
    key: "getInstance",
    value: function getInstance() {
      if (!SyncService.instance) {
        SyncService.instance = new SyncService();
      }
      return SyncService.instance;
    }
  }]);
}();
SyncService.CACHE_KEYS = {
  STREAKS: "@habit_streaks_cache",
  COMPLETIONS: "@habit_completions_cache",
  PENDING_OPS: "@pending_sync_operations",
  LAST_SYNC: "@last_sync_timestamp"
};
var syncService = exports.syncService = SyncService.getInstance();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZmlyZWJhc2VDb25maWciLCJyZXF1aXJlIiwiX2Vycm9ySGFuZGxpbmciLCJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9maXJlc3RvcmUiLCJfY29sbGVjdGlvbnMiLCJfaGFiaXRTdHJlYWtTY2hlbWFzIiwiU3luY1NlcnZpY2UiLCJleHBvcnRzIiwiX2NsYXNzQ2FsbENoZWNrMiIsImRlZmF1bHQiLCJzeW5jTGlzdGVuZXJzIiwiTWFwIiwicGVuZGluZ09wZXJhdGlvbnMiLCJzeW5jU3RhdHVzIiwiaXNPbmxpbmUiLCJsYXN0U3luYyIsInN5bmNJblByb2dyZXNzIiwic3RhdHVzQ2FsbGJhY2tzIiwiU2V0IiwiaW5pdGlhbGl6ZVN5bmMiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJfaW5pdGlhbGl6ZVN5bmMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJsb2FkUGVuZGluZ09wZXJhdGlvbnMiLCJvbmxpbmUiLCJ1cGRhdGVTeW5jU3RhdHVzIiwicHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zIiwic3RhcnRDb25uZWN0aXZpdHlNb25pdG9yaW5nIiwiZXJyb3IiLCJjb25zb2xlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfc3RhcnRSZWFsdGltZVN5bmMiLCJ1c2VySWQiLCJfdGhpcyIsIkVycm9yIiwic3RvcFJlYWx0aW1lU3luYyIsInN0cmVha3NDb2xsZWN0aW9uIiwiZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbiIsInN0cmVha3NRdWVyeSIsInF1ZXJ5Iiwid2hlcmUiLCJzdHJlYWtMaXN0ZW5lciIsIm9uU25hcHNob3QiLCJzbmFwc2hvdCIsImRvY0NoYW5nZXMiLCJmb3JFYWNoIiwiX3JlZiIsImNoYW5nZSIsInN0cmVha0RhdGEiLCJkb2MiLCJkYXRhIiwiaGFuZGxlUmVhbHRpbWVTdHJlYWtVcGRhdGUiLCJpZCIsInR5cGUiLCJfeDIiLCJoYW5kbGVTeW5jRXJyb3IiLCJjb21wbGV0aW9uc0NvbGxlY3Rpb24iLCJnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbiIsImNvbXBsZXRpb25zUXVlcnkiLCJjb21wbGV0aW9uTGlzdGVuZXIiLCJfcmVmMiIsImNvbXBsZXRpb25EYXRhIiwiaGFuZGxlUmVhbHRpbWVDb21wbGV0aW9uVXBkYXRlIiwiX3gzIiwic2V0Iiwic3RhcnRSZWFsdGltZVN5bmMiLCJfeCIsInN0cmVha0tleSIsImNvbXBsZXRpb25LZXkiLCJnZXQiLCJkZWxldGUiLCJfY2FjaGVEYXRhIiwidmVyc2lvbiIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNoZWNrc3VtIiwiZ2VuZXJhdGVDaGVja3N1bSIsImNhY2hlZERhdGEiLCJ0aW1lc3RhbXAiLCJUaW1lc3RhbXAiLCJub3ciLCJBc3luY1N0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNhY2hlRGF0YSIsIl94NCIsIl94NSIsIl9nZXRDYWNoZWREYXRhIiwiY2FjaGVkU3RyaW5nIiwiZ2V0SXRlbSIsInBhcnNlIiwiZXhwZWN0ZWRDaGVja3N1bSIsIndhcm4iLCJyZW1vdmVJdGVtIiwiZ2V0Q2FjaGVkRGF0YSIsIl94NiIsIl91cGRhdGVBZ2dyZWdhdGVSZWNvcmQiLCJkb2NJZCIsImVudHJ5IiwiY3VycmVudCIsInVwZGF0ZUFnZ3JlZ2F0ZVJlY29yZCIsIl94NyIsIl94OCIsIl94OSIsIl9nZXRDYWNoZWRTdHJlYWtNYXAiLCJyZWNvcmQiLCJDQUNIRV9LRVlTIiwiU1RSRUFLUyIsIk9iamVjdCIsInZhbHVlcyIsInJlZHVjZSIsImFjYyIsInN0cmVhayIsImhhYml0SWQiLCJnZXRDYWNoZWRTdHJlYWtNYXAiLCJfZ2V0Q2FjaGVkQ29tcGxldGlvbnNNYXAiLCJDT01QTEVUSU9OUyIsImdldENhY2hlZENvbXBsZXRpb25zTWFwIiwiX2NsZWFudXBDYWNoZVByZWZpeCIsInByZWZpeCIsImFjdGl2ZURvY0lkcyIsImFsbEtleXMiLCJnZXRBbGxLZXlzIiwicHJlZml4V2l0aFNlcGFyYXRvciIsImFsbG93ZWRLZXlzIiwiQXJyYXkiLCJmcm9tIiwibWFwIiwia2V5c1RvUmVtb3ZlIiwiZmlsdGVyIiwic3RhcnRzV2l0aCIsImhhcyIsIm11bHRpUmVtb3ZlIiwiY2xlYW51cENhY2hlUHJlZml4IiwiX3gwIiwiX3gxIiwiX3F1ZXVlT3BlcmF0aW9uIiwib3BlcmF0aW9uIiwic3luY09wIiwiYXNzaWduIiwiZ2VuZXJhdGVPcGVyYXRpb25JZCIsInJldHJ5Q291bnQiLCJzYXZlUGVuZGluZ09wZXJhdGlvbnMiLCJzaXplIiwicXVldWVPcGVyYXRpb24iLCJfeDEwIiwiX3Byb2Nlc3NQZW5kaW5nT3BlcmF0aW9ucyIsIm9wZXJhdGlvbnMiLCJzb3J0IiwiYSIsImIiLCJ0b01pbGxpcyIsImV4ZWN1dGVPcGVyYXRpb24iLCJsYXN0QXR0ZW1wdCIsIl9leGVjdXRlT3BlcmF0aW9uIiwiX3RoaXMyIiwicmV0cnlXaXRoQmFja29mZiIsInJ1blRyYW5zYWN0aW9uIiwiZGIiLCJfcmVmNCIsInRyYW5zYWN0aW9uIiwiZXhlY3V0ZUNvbXBsZXRpb25PcGVyYXRpb24iLCJleGVjdXRlU3RyZWFrT3BlcmF0aW9uIiwiZXhlY3V0ZU1pbGVzdG9uZU9wZXJhdGlvbiIsIl94MTIiLCJfeDExIiwiX2hhbmRsZVJlYWx0aW1lU3RyZWFrVXBkYXRlIiwiY2hhbmdlVHlwZSIsInJlbW92ZUNhY2hlS2V5IiwidHJhbnNmb3JtRmlyZXN0b3JlVG9TdHJlYWsiLCJjYWNoZUtleSIsImNhY2hlZFN0cmVhayIsImhhc0NvbmZsaWN0IiwicmVzb2x2ZWRTdHJlYWsiLCJyZXNvbHZlU3RyZWFrQ29uZmxpY3QiLCJfeDEzIiwiX3gxNCIsIl94MTUiLCJfaGFuZGxlUmVhbHRpbWVDb21wbGV0aW9uVXBkYXRlIiwiY29tcGxldGlvbiIsInRyYW5zZm9ybUZpcmVzdG9yZVRvQ29tcGxldGlvbiIsIl94MTYiLCJfeDE3IiwiX3gxOCIsIl9yZXNvbHZlU3RyZWFrQ29uZmxpY3QiLCJsb2NhbFN0cmVhayIsInJlbW90ZVN0cmVhayIsImxhc3RDb21wbGV0aW9uRGF0ZSIsImN1cnJlbnRTdHJlYWsiLCJfeDE5IiwiX3gyMCIsImxvY2FsIiwicmVtb3RlIiwiYmVzdFN0cmVhayIsImZyZWV6ZXNBdmFpbGFibGUiLCJmcmVlemVzVXNlZCIsIl9leGVjdXRlQ29tcGxldGlvbk9wZXJhdGlvbiIsImFjdGlvbiIsImNvbXBsZXRpb25SZWYiLCJjcmVhdGVkQXQiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJ1cGRhdGVSZWYiLCJ1cGRhdGUiLCJ1cGRhdGVkQXQiLCJkZWxldGVSZWYiLCJfeDIxIiwiX3gyMiIsIl9leGVjdXRlU3RyZWFrT3BlcmF0aW9uIiwic3RyZWFrSWQiLCJnZW5lcmF0ZVN0cmVha0lkIiwic3RyZWFrUmVmIiwidHJhbnNmb3JtU3RyZWFrVG9GaXJlc3RvcmUiLCJfeDIzIiwiX3gyNCIsIl9leGVjdXRlTWlsZXN0b25lT3BlcmF0aW9uIiwibG9nIiwiX3gyNSIsIl94MjYiLCJzdHIiLCJoYXNoIiwiaSIsImNoYXIiLCJjaGFyQ29kZUF0IiwidG9TdHJpbmciLCJEYXRlIiwiTWF0aCIsInJhbmRvbSIsInN1YnN0ciIsIl9zYXZlUGVuZGluZ09wZXJhdGlvbnMiLCJzZXJpYWxpemVkIiwib3AiLCJfb3AkbGFzdEF0dGVtcHQiLCJQRU5ESU5HX09QUyIsIl9sb2FkUGVuZGluZ09wZXJhdGlvbnMiLCJfdGhpczMiLCJzdG9yZWQiLCJjbGVhciIsImZyb21NaWxsaXMiLCJfdGhpczQiLCJzZXRJbnRlcnZhbCIsIndhc09ubGluZSIsIl9lcnJvciRtZXNzYWdlIiwiY29kZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsInVwZGF0ZXMiLCJfdGhpczUiLCJjYWxsYmFjayIsIm9uU3luY1N0YXR1c0NoYW5nZSIsIl90aGlzNiIsImFkZCIsImdldFN5bmNTdGF0dXMiLCJfZm9yY2VTeW5jVXNlckRhdGEiLCJzeW5jVXNlclN0cmVha3MiLCJzeW5jVXNlckNvbXBsZXRpb25zIiwiZm9yY2VTeW5jVXNlckRhdGEiLCJfeDI3IiwiX3N5bmNVc2VyU3RyZWFrcyIsIl90aGlzNyIsImdldERvY3MiLCJzdHJlYWtFbnRyaWVzIiwiZG9jcyIsImRvY1NuYXAiLCJhZ2dyZWdhdGVSZWNvcmQiLCJQcm9taXNlIiwiYWxsIiwiX3JlZjciLCJfcmVmNiIsIl94MjkiLCJfeDI4IiwiX3N5bmNVc2VyQ29tcGxldGlvbnMiLCJfdGhpczgiLCJjb21wbGV0aW9uRW50cmllcyIsIl9yZWY5IiwiX3JlZjgiLCJfeDMxIiwiX3gzMCIsIl9jbGVhckNhY2hlIiwiTEFTVF9TWU5DIiwiY2xlYXJDYWNoZSIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJzeW5jU2VydmljZSJdLCJzb3VyY2VzIjpbInN5bmNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGF0YSBTeW5jaHJvbml6YXRpb24gU2VydmljZVxuICpcbiAqIEhhbmRsZXMgY3Jvc3MtZGV2aWNlIGRhdGEgc3luY2hyb25pemF0aW9uLCBvZmZsaW5lIGNhY2hpbmcsIGFuZCBjb25mbGljdCByZXNvbHV0aW9uXG4gKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjIsIDEwLjMsIDEwLjQsIDEwLjVcbiAqL1xuXG5pbXBvcnQgeyBkYiB9IGZyb20gXCJAL2ZpcmViYXNlQ29uZmlnXCI7XG5pbXBvcnQgeyBIYWJpdENvbXBsZXRpb24sIEhhYml0U3RyZWFrIH0gZnJvbSBcIkAvdHlwZXNcIjtcbmltcG9ydCB7IGlzT25saW5lLCByZXRyeVdpdGhCYWNrb2ZmIH0gZnJvbSBcIkAvdXRpbHMvZXJyb3JIYW5kbGluZ1wiO1xuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tIFwiQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2VcIjtcbmltcG9ydCB7IFVuc3Vic2NyaWJlIH0gZnJvbSBcImZpcmViYXNlL2F1dGhcIjtcbmltcG9ydCB7XG4gICAgVGltZXN0YW1wLFxuICAgIGRvYyxcbiAgICBnZXREb2NzLFxuICAgIG9uU25hcHNob3QsXG4gICAgcXVlcnksXG4gICAgcnVuVHJhbnNhY3Rpb24sXG4gICAgc2VydmVyVGltZXN0YW1wLFxuICAgIHdoZXJlLFxufSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XG5pbXBvcnQge1xuICAgIGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uLFxuICAgIGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24sXG59IGZyb20gXCIuL2NvbGxlY3Rpb25zXCI7XG5pbXBvcnQge1xuICAgIGdlbmVyYXRlU3RyZWFrSWQsXG4gICAgdHJhbnNmb3JtRmlyZXN0b3JlVG9Db21wbGV0aW9uLFxuICAgIHRyYW5zZm9ybUZpcmVzdG9yZVRvU3RyZWFrLFxuICAgIHRyYW5zZm9ybVN0cmVha1RvRmlyZXN0b3JlLFxufSBmcm9tIFwiLi9oYWJpdFN0cmVha1NjaGVtYXNcIjtcblxuLyoqXG4gKiBTeW5jIG9wZXJhdGlvbiB0eXBlc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNPcGVyYXRpb24ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdHlwZTogXCJjb21wbGV0aW9uXCIgfCBcInN0cmVha1wiIHwgXCJtaWxlc3RvbmVcIjtcbiAgICBhY3Rpb246IFwiY3JlYXRlXCIgfCBcInVwZGF0ZVwiIHwgXCJkZWxldGVcIjtcbiAgICBkYXRhOiBhbnk7XG4gICAgdGltZXN0YW1wOiBUaW1lc3RhbXA7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgaGFiaXRJZD86IHN0cmluZztcbiAgICByZXRyeUNvdW50OiBudW1iZXI7XG4gICAgbGFzdEF0dGVtcHQ/OiBUaW1lc3RhbXA7XG59XG5cbi8qKlxuICogQ2FjaGVkIGRhdGEgc3RydWN0dXJlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVkRGF0YTxUPiB7XG4gICAgZGF0YTogVDtcbiAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcDtcbiAgICB2ZXJzaW9uOiBudW1iZXI7XG4gICAgY2hlY2tzdW06IHN0cmluZztcbn1cblxuLyoqXG4gKiBTeW5jIHN0YXR1c1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNTdGF0dXMge1xuICAgIGlzT25saW5lOiBib29sZWFuO1xuICAgIGxhc3RTeW5jOiBUaW1lc3RhbXAgfCBudWxsO1xuICAgIHBlbmRpbmdPcGVyYXRpb25zOiBudW1iZXI7XG4gICAgc3luY0luUHJvZ3Jlc3M6IGJvb2xlYW47XG59XG4vKipcbiAqIERhdGEgU3luY2hyb25pemF0aW9uIFNlcnZpY2UgSW1wbGVtZW50YXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFN5bmNTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU3luY1NlcnZpY2U7XG4gICAgcHJpdmF0ZSBzeW5jTGlzdGVuZXJzOiBNYXA8c3RyaW5nLCBVbnN1YnNjcmliZT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBwZW5kaW5nT3BlcmF0aW9uczogTWFwPHN0cmluZywgU3luY09wZXJhdGlvbj4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBzeW5jU3RhdHVzOiBTeW5jU3RhdHVzID0ge1xuICAgICAgICBpc09ubGluZTogdHJ1ZSxcbiAgICAgICAgbGFzdFN5bmM6IG51bGwsXG4gICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiAwLFxuICAgICAgICBzeW5jSW5Qcm9ncmVzczogZmFsc2UsXG4gICAgfTtcbiAgICBwcml2YXRlIHN0YXR1c0NhbGxiYWNrczogU2V0PChzdGF0dXM6IFN5bmNTdGF0dXMpID0+IHZvaWQ+ID0gbmV3IFNldCgpO1xuXG4gICAgLy8gQ2FjaGUga2V5c1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENBQ0hFX0tFWVMgPSB7XG4gICAgICAgIFNUUkVBS1M6IFwiQGhhYml0X3N0cmVha3NfY2FjaGVcIixcbiAgICAgICAgQ09NUExFVElPTlM6IFwiQGhhYml0X2NvbXBsZXRpb25zX2NhY2hlXCIsXG4gICAgICAgIFBFTkRJTkdfT1BTOiBcIkBwZW5kaW5nX3N5bmNfb3BlcmF0aW9uc1wiLFxuICAgICAgICBMQVNUX1NZTkM6IFwiQGxhc3Rfc3luY190aW1lc3RhbXBcIixcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplU3luYygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU3luY1NlcnZpY2Uge1xuICAgICAgICBpZiAoIVN5bmNTZXJ2aWNlLmluc3RhbmNlKSB7XG4gICAgICAgICAgICBTeW5jU2VydmljZS5pbnN0YW5jZSA9IG5ldyBTeW5jU2VydmljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBTeW5jU2VydmljZS5pbnN0YW5jZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHN5bmNocm9uaXphdGlvbiBzeXN0ZW1cbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVTeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gTG9hZCBwZW5kaW5nIG9wZXJhdGlvbnMgZnJvbSBzdG9yYWdlXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRQZW5kaW5nT3BlcmF0aW9ucygpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBjb25uZWN0aXZpdHkgYW5kIHN0YXJ0IHN5bmMgaWYgb25saW5lXG4gICAgICAgICAgICBjb25zdCBvbmxpbmUgPSBhd2FpdCBpc09ubGluZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgaXNPbmxpbmU6IG9ubGluZSB9KTtcblxuICAgICAgICAgICAgaWYgKG9ubGluZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCB1cCBjb25uZWN0aXZpdHkgbW9uaXRvcmluZ1xuICAgICAgICAgICAgdGhpcy5zdGFydENvbm5lY3Rpdml0eU1vbml0b3JpbmcoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBzeW5jIHNlcnZpY2U6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHJlYWwtdGltZSBzeW5jaHJvbml6YXRpb24gZm9yIGEgdXNlcidzIGhhYml0IGRhdGFcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjFcbiAgICAgKi9cbiAgICBhc3luYyBzdGFydFJlYWx0aW1lU3luYyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBJRCBpcyByZXF1aXJlZCBmb3Igc3luY1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0b3AgZXhpc3RpbmcgbGlzdGVuZXJzIGZvciB0aGlzIHVzZXJcbiAgICAgICAgdGhpcy5zdG9wUmVhbHRpbWVTeW5jKHVzZXJJZCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNldCB1cCBzdHJlYWsgZGF0YSBsaXN0ZW5lclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFrc0NvbGxlY3Rpb24gPSBnZXRIYWJpdFN0cmVha3NDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBzdHJlYWtzUXVlcnkgPSBxdWVyeShcbiAgICAgICAgICAgICAgICBzdHJlYWtzQ29sbGVjdGlvbixcbiAgICAgICAgICAgICAgICB3aGVyZShcInVzZXJJZFwiLCBcIj09XCIsIHVzZXJJZCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFrTGlzdGVuZXIgPSBvblNuYXBzaG90KFxuICAgICAgICAgICAgICAgIHN0cmVha3NRdWVyeSxcbiAgICAgICAgICAgICAgICAoc25hcHNob3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc25hcHNob3QuZG9jQ2hhbmdlcygpLmZvckVhY2goYXN5bmMgKGNoYW5nZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RyZWFrRGF0YSA9IGNoYW5nZS5kb2MuZGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVSZWFsdGltZVN0cmVha1VwZGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UuZG9jLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVha0RhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU3RyZWFrIHN5bmMgZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTeW5jRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBTZXQgdXAgY29tcGxldGlvbiBkYXRhIGxpc3RlbmVyXG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uc0NvbGxlY3Rpb24gPSBnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbigpO1xuICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbnNRdWVyeSA9IHF1ZXJ5KFxuICAgICAgICAgICAgICAgIGNvbXBsZXRpb25zQ29sbGVjdGlvbixcbiAgICAgICAgICAgICAgICB3aGVyZShcInVzZXJJZFwiLCBcIj09XCIsIHVzZXJJZCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbkxpc3RlbmVyID0gb25TbmFwc2hvdChcbiAgICAgICAgICAgICAgICBjb21wbGV0aW9uc1F1ZXJ5LFxuICAgICAgICAgICAgICAgIChzbmFwc2hvdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdC5kb2NDaGFuZ2VzKCkuZm9yRWFjaChhc3luYyAoY2hhbmdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uRGF0YSA9IGNoYW5nZS5kb2MuZGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVSZWFsdGltZUNvbXBsZXRpb25VcGRhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLmRvYy5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb21wbGV0aW9uIHN5bmMgZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTeW5jRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBTdG9yZSBsaXN0ZW5lcnNcbiAgICAgICAgICAgIHRoaXMuc3luY0xpc3RlbmVycy5zZXQoYHN0cmVha3NfJHt1c2VySWR9YCwgc3RyZWFrTGlzdGVuZXIpO1xuICAgICAgICAgICAgdGhpcy5zeW5jTGlzdGVuZXJzLnNldChgY29tcGxldGlvbnNfJHt1c2VySWR9YCwgY29tcGxldGlvbkxpc3RlbmVyKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc3RhcnQgcmVhbHRpbWUgc3luYzpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcCByZWFsLXRpbWUgc3luY2hyb25pemF0aW9uIGZvciBhIHVzZXJcbiAgICAgKi9cbiAgICBzdG9wUmVhbHRpbWVTeW5jKHVzZXJJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHN0cmVha0tleSA9IGBzdHJlYWtzXyR7dXNlcklkfWA7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25LZXkgPSBgY29tcGxldGlvbnNfJHt1c2VySWR9YDtcblxuICAgICAgICBjb25zdCBzdHJlYWtMaXN0ZW5lciA9IHRoaXMuc3luY0xpc3RlbmVycy5nZXQoc3RyZWFrS2V5KTtcbiAgICAgICAgaWYgKHN0cmVha0xpc3RlbmVyKSB7XG4gICAgICAgICAgICBzdHJlYWtMaXN0ZW5lcigpO1xuICAgICAgICAgICAgdGhpcy5zeW5jTGlzdGVuZXJzLmRlbGV0ZShzdHJlYWtLZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29tcGxldGlvbkxpc3RlbmVyID0gdGhpcy5zeW5jTGlzdGVuZXJzLmdldChjb21wbGV0aW9uS2V5KTtcbiAgICAgICAgaWYgKGNvbXBsZXRpb25MaXN0ZW5lcikge1xuICAgICAgICAgICAgY29tcGxldGlvbkxpc3RlbmVyKCk7XG4gICAgICAgICAgICB0aGlzLnN5bmNMaXN0ZW5lcnMuZGVsZXRlKGNvbXBsZXRpb25LZXkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FjaGUgZGF0YSBsb2NhbGx5IHdpdGggaW50ZWdyaXR5IHZlcmlmaWNhdGlvblxuICAgICAqIFJlcXVpcmVtZW50czogMTAuNFxuICAgICAqL1xuICAgIGFzeW5jIGNhY2hlRGF0YTxUPihrZXk6IHN0cmluZywgZGF0YTogVCwgdmVyc2lvbjogbnVtYmVyID0gMSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY2hlY2tzdW0gPSB0aGlzLmdlbmVyYXRlQ2hlY2tzdW0oZGF0YSk7XG4gICAgICAgICAgICBjb25zdCBjYWNoZWREYXRhOiBDYWNoZWREYXRhPFQ+ID0ge1xuICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBUaW1lc3RhbXAubm93KCksXG4gICAgICAgICAgICAgICAgdmVyc2lvbixcbiAgICAgICAgICAgICAgICBjaGVja3N1bSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoY2FjaGVkRGF0YSkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjYWNoZSBkYXRhOlwiLCBlcnJvcik7XG4gICAgICAgICAgICAvLyBEb24ndCB0aHJvdyAtIGNhY2hpbmcgZmFpbHVyZSBzaG91bGRuJ3QgYnJlYWsgdGhlIGFwcFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgY2FjaGVkIGRhdGEgd2l0aCBpbnRlZ3JpdHkgdmVyaWZpY2F0aW9uXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC40LCAxMi41XG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q2FjaGVkRGF0YTxUPihrZXk6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZFN0cmluZyA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgICAgICAgICBpZiAoIWNhY2hlZFN0cmluZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjYWNoZWREYXRhOiBDYWNoZWREYXRhPFQ+ID0gSlNPTi5wYXJzZShjYWNoZWRTdHJpbmcpO1xuXG4gICAgICAgICAgICAvLyBWZXJpZnkgZGF0YSBpbnRlZ3JpdHlcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkQ2hlY2tzdW0gPSB0aGlzLmdlbmVyYXRlQ2hlY2tzdW0oY2FjaGVkRGF0YS5kYXRhKTtcbiAgICAgICAgICAgIGlmIChjYWNoZWREYXRhLmNoZWNrc3VtICE9PSBleHBlY3RlZENoZWNrc3VtKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQ2FjaGUgaW50ZWdyaXR5IGNoZWNrIGZhaWxlZCwgcmVtb3ZpbmcgY29ycnVwdGVkIGRhdGFcIik7XG4gICAgICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGEuZGF0YTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgY2FjaGVkIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVBZ2dyZWdhdGVSZWNvcmQ8VD4oXG4gICAgICAgIGtleTogc3RyaW5nLFxuICAgICAgICBkb2NJZDogc3RyaW5nLFxuICAgICAgICBlbnRyeT86IFQsXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPVxuICAgICAgICAgICAgKGF3YWl0IHRoaXMuZ2V0Q2FjaGVkRGF0YTxSZWNvcmQ8c3RyaW5nLCBUPj4oa2V5KSkgfHwge307XG5cbiAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICBjdXJyZW50W2RvY0lkXSA9IGVudHJ5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIGN1cnJlbnRbZG9jSWRdO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5jYWNoZURhdGEoa2V5LCBjdXJyZW50KTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRDYWNoZWRTdHJlYWtNYXAoKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBIYWJpdFN0cmVhaz4+IHtcbiAgICAgICAgY29uc3QgcmVjb3JkID1cbiAgICAgICAgICAgIChhd2FpdCB0aGlzLmdldENhY2hlZERhdGE8UmVjb3JkPHN0cmluZywgSGFiaXRTdHJlYWs+PihcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlNUUkVBS1MsXG4gICAgICAgICAgICApKSB8fCB7fTtcblxuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhyZWNvcmQpLnJlZHVjZShcbiAgICAgICAgICAgIChhY2MsIHN0cmVhaykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzdHJlYWsuaGFiaXRJZCkge1xuICAgICAgICAgICAgICAgICAgICBhY2Nbc3RyZWFrLmhhYml0SWRdID0gc3RyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHt9IGFzIFJlY29yZDxzdHJpbmcsIEhhYml0U3RyZWFrPixcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRDYWNoZWRDb21wbGV0aW9uc01hcCgpOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIEhhYml0Q29tcGxldGlvbj4+IHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIChhd2FpdCB0aGlzLmdldENhY2hlZERhdGE8UmVjb3JkPHN0cmluZywgSGFiaXRDb21wbGV0aW9uPj4oXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OUyxcbiAgICAgICAgICAgICkpIHx8IHt9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGNhY2hlZCBlbnRyaWVzIGZvciBhIHByZWZpeCB0aGF0IGFyZSBubyBsb25nZXIgYWN0aXZlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBjbGVhbnVwQ2FjaGVQcmVmaXgoXG4gICAgICAgIHByZWZpeDogc3RyaW5nLFxuICAgICAgICBhY3RpdmVEb2NJZHM/OiBTZXQ8c3RyaW5nPixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGFsbEtleXMgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0QWxsS2V5cygpO1xuICAgICAgICAgICAgaWYgKCFhbGxLZXlzIHx8IGFsbEtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBwcmVmaXhXaXRoU2VwYXJhdG9yID0gYCR7cHJlZml4fV9gO1xuICAgICAgICAgICAgY29uc3QgYWxsb3dlZEtleXMgPVxuICAgICAgICAgICAgICAgIGFjdGl2ZURvY0lkcyAmJlxuICAgICAgICAgICAgICAgIG5ldyBTZXQoXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20oYWN0aXZlRG9jSWRzLnZhbHVlcygpKS5tYXAoXG4gICAgICAgICAgICAgICAgICAgICAgICAoaWQpID0+IGAke3ByZWZpeFdpdGhTZXBhcmF0b3J9JHtpZH1gLFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGtleXNUb1JlbW92ZSA9IGFsbEtleXMuZmlsdGVyKChrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWtleS5zdGFydHNXaXRoKHByZWZpeFdpdGhTZXBhcmF0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWFsbG93ZWRLZXlzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiAhYWxsb3dlZEtleXMuaGFzKGtleSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGtleXNUb1JlbW92ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLm11bHRpUmVtb3ZlKGtleXNUb1JlbW92ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNsZWFuIHVwIGNhY2hlIHByZWZpeDpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUXVldWUgb3BlcmF0aW9uIGZvciBvZmZsaW5lIHN5bmNcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjRcbiAgICAgKi9cbiAgICBhc3luYyBxdWV1ZU9wZXJhdGlvbihcbiAgICAgICAgb3BlcmF0aW9uOiBPbWl0PFN5bmNPcGVyYXRpb24sIFwiaWRcIiB8IFwicmV0cnlDb3VudFwiIHwgXCJ0aW1lc3RhbXBcIj4sXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHN5bmNPcDogU3luY09wZXJhdGlvbiA9IHtcbiAgICAgICAgICAgIC4uLm9wZXJhdGlvbixcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlT3BlcmF0aW9uSWQoKSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogVGltZXN0YW1wLm5vdygpLFxuICAgICAgICAgICAgcmV0cnlDb3VudDogMCxcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNldChzeW5jT3AuaWQsIHN5bmNPcCk7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVBlbmRpbmdPcGVyYXRpb25zKCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHtcbiAgICAgICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNpemUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRyeSB0byBwcm9jZXNzIGltbWVkaWF0ZWx5IGlmIG9ubGluZVxuICAgICAgICBpZiAodGhpcy5zeW5jU3RhdHVzLmlzT25saW5lKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NQZW5kaW5nT3BlcmF0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBwZW5kaW5nIG9wZXJhdGlvbnMgd2hlbiBjb25uZWN0aW9uIGlzIHJlc3RvcmVkXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC40LCAxMC41XG4gICAgICovXG4gICAgYXN5bmMgcHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5zeW5jU3RhdHVzLnN5bmNJblByb2dyZXNzIHx8IHRoaXMucGVuZGluZ09wZXJhdGlvbnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgc3luY0luUHJvZ3Jlc3M6IHRydWUgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBBcnJheS5mcm9tKHRoaXMucGVuZGluZ09wZXJhdGlvbnMudmFsdWVzKCkpLnNvcnQoXG4gICAgICAgICAgICAgICAgKGEsIGIpID0+IGEudGltZXN0YW1wLnRvTWlsbGlzKCkgLSBiLnRpbWVzdGFtcC50b01pbGxpcygpLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2Ygb3BlcmF0aW9ucykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZU9wZXJhdGlvbihvcGVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLmRlbGV0ZShvcGVyYXRpb24uaWQpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZXhlY3V0ZSBvcGVyYXRpb246XCIsIGVycm9yKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBJbmNyZW1lbnQgcmV0cnkgY291bnRcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uLnJldHJ5Q291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uLmxhc3RBdHRlbXB0ID0gVGltZXN0YW1wLm5vdygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvcGVyYXRpb24gaWYgbWF4IHJldHJpZXMgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wZXJhdGlvbi5yZXRyeUNvdW50ID49IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk1heCByZXRyaWVzIGV4Y2VlZGVkLCByZW1vdmluZyBvcGVyYXRpb246XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ09wZXJhdGlvbnMuZGVsZXRlKG9wZXJhdGlvbi5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZVBlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoe1xuICAgICAgICAgICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNpemUsXG4gICAgICAgICAgICAgICAgbGFzdFN5bmM6IFRpbWVzdGFtcC5ub3coKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgc3luY0luUHJvZ3Jlc3M6IGZhbHNlIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIHN5bmMgb3BlcmF0aW9uIHdpdGggYXRvbWljIHVwZGF0ZXNcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjJcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVPcGVyYXRpb24ob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXRyeVdpdGhCYWNrb2ZmKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBydW5UcmFuc2FjdGlvbihkYiwgYXN5bmMgKHRyYW5zYWN0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY29tcGxldGlvblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlQ29tcGxldGlvbk9wZXJhdGlvbihvcGVyYXRpb24sIHRyYW5zYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3RyZWFrXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVTdHJlYWtPcGVyYXRpb24ob3BlcmF0aW9uLCB0cmFuc2FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm1pbGVzdG9uZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlTWlsZXN0b25lT3BlcmF0aW9uKG9wZXJhdGlvbiwgdHJhbnNhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gb3BlcmF0aW9uIHR5cGU6ICR7b3BlcmF0aW9uLnR5cGV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSByZWFsLXRpbWUgc3RyZWFrIHVwZGF0ZXMgd2l0aCBjb25mbGljdCByZXNvbHV0aW9uXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC4xLCAxMC41XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVSZWFsdGltZVN0cmVha1VwZGF0ZShcbiAgICAgICAgZG9jSWQ6IHN0cmluZyxcbiAgICAgICAgZGF0YTogYW55LFxuICAgICAgICBjaGFuZ2VUeXBlOiBcImFkZGVkXCIgfCBcIm1vZGlmaWVkXCIgfCBcInJlbW92ZWRcIixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VUeXBlID09PSBcInJlbW92ZWRcIikge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9tIGNhY2hlXG4gICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlQ2FjaGVLZXkgPSBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLlNUUkVBS1N9XyR7ZG9jSWR9YDtcbiAgICAgICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShyZW1vdmVDYWNoZUtleSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVBZ2dyZWdhdGVSZWNvcmQoXG4gICAgICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLUyxcbiAgICAgICAgICAgICAgICAgICAgZG9jSWQsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHN0cmVhayA9IHRyYW5zZm9ybUZpcmVzdG9yZVRvU3RyZWFrKGRhdGEpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgY29uZmxpY3RzIHdpdGggbG9jYWwgZGF0YVxuICAgICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLlNUUkVBS1N9XyR7ZG9jSWR9YDtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZFN0cmVhayA9IGF3YWl0IHRoaXMuZ2V0Q2FjaGVkRGF0YTxIYWJpdFN0cmVhaz4oY2FjaGVLZXkpO1xuXG4gICAgICAgICAgICBpZiAoY2FjaGVkU3RyZWFrICYmIHRoaXMuaGFzQ29uZmxpY3QoY2FjaGVkU3RyZWFrLCBzdHJlYWspKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzb2x2ZWRTdHJlYWsgPSBhd2FpdCB0aGlzLnJlc29sdmVTdHJlYWtDb25mbGljdChcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVkU3RyZWFrLFxuICAgICAgICAgICAgICAgICAgICBzdHJlYWssXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShjYWNoZUtleSwgcmVzb2x2ZWRTdHJlYWspO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShjYWNoZUtleSwgc3RyZWFrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVBZ2dyZWdhdGVSZWNvcmQoXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5TVFJFQUtTLFxuICAgICAgICAgICAgICAgIGRvY0lkLFxuICAgICAgICAgICAgICAgIHN0cmVhayxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaGFuZGxpbmcgcmVhbHRpbWUgc3RyZWFrIHVwZGF0ZTpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHJlYWwtdGltZSBjb21wbGV0aW9uIHVwZGF0ZXNcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVJlYWx0aW1lQ29tcGxldGlvblVwZGF0ZShcbiAgICAgICAgZG9jSWQ6IHN0cmluZyxcbiAgICAgICAgZGF0YTogYW55LFxuICAgICAgICBjaGFuZ2VUeXBlOiBcImFkZGVkXCIgfCBcIm1vZGlmaWVkXCIgfCBcInJlbW92ZWRcIixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VUeXBlID09PSBcInJlbW92ZWRcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZUNhY2hlS2V5ID0gYCR7U3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OU31fJHtkb2NJZH1gO1xuICAgICAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKHJlbW92ZUNhY2hlS2V5KTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUFnZ3JlZ2F0ZVJlY29yZChcbiAgICAgICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OUyxcbiAgICAgICAgICAgICAgICAgICAgZG9jSWQsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSB0cmFuc2Zvcm1GaXJlc3RvcmVUb0NvbXBsZXRpb24oZG9jSWQsIGRhdGEpO1xuICAgICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TfV8ke2RvY0lkfWA7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShjYWNoZUtleSwgY29tcGxldGlvbik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUFnZ3JlZ2F0ZVJlY29yZChcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TLFxuICAgICAgICAgICAgICAgIGRvY0lkLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRpb24sXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGhhbmRsaW5nIHJlYWx0aW1lIGNvbXBsZXRpb24gdXBkYXRlOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNvbHZlIGNvbmZsaWN0cyB1c2luZyB0aW1lc3RhbXAgcHJpb3JpdHlcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJlc29sdmVTdHJlYWtDb25mbGljdChcbiAgICAgICAgbG9jYWxTdHJlYWs6IEhhYml0U3RyZWFrLFxuICAgICAgICByZW1vdGVTdHJlYWs6IEhhYml0U3RyZWFrLFxuICAgICk6IFByb21pc2U8SGFiaXRTdHJlYWs+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBzdHJlYWsgd2l0aCB0aGUgbW9zdCByZWNlbnQgbGFzdENvbXBsZXRpb25EYXRlXG4gICAgICAgIC8vIElmIGRhdGVzIGFyZSBlcXVhbCwgcHJlZmVyIHRoZSBvbmUgd2l0aCBoaWdoZXIgY3VycmVudFN0cmVha1xuXG4gICAgICAgIGlmICghbG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmIHJlbW90ZVN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGVTdHJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmICFyZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxTdHJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmIHJlbW90ZVN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUpIHtcbiAgICAgICAgICAgIGlmIChsb2NhbFN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUgPiByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICBsb2NhbFN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUgPCByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlU3RyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBTYW1lIGRhdGUsIHVzZSBoaWdoZXIgc3RyZWFrXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RyZWFrLmN1cnJlbnRTdHJlYWsgPj0gcmVtb3RlU3RyZWFrLmN1cnJlbnRTdHJlYWtcbiAgICAgICAgICAgICAgICAgICAgPyBsb2NhbFN0cmVha1xuICAgICAgICAgICAgICAgICAgICA6IHJlbW90ZVN0cmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIHJlbW90ZSBpZiBubyBjbGVhciB3aW5uZXJcbiAgICAgICAgcmV0dXJuIHJlbW90ZVN0cmVhaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGVyZSdzIGEgY29uZmxpY3QgYmV0d2VlbiBsb2NhbCBhbmQgcmVtb3RlIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGhhc0NvbmZsaWN0KGxvY2FsOiBIYWJpdFN0cmVhaywgcmVtb3RlOiBIYWJpdFN0cmVhayk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgbG9jYWwuY3VycmVudFN0cmVhayAhPT0gcmVtb3RlLmN1cnJlbnRTdHJlYWsgfHxcbiAgICAgICAgICAgIGxvY2FsLmJlc3RTdHJlYWsgIT09IHJlbW90ZS5iZXN0U3RyZWFrIHx8XG4gICAgICAgICAgICBsb2NhbC5sYXN0Q29tcGxldGlvbkRhdGUgIT09IHJlbW90ZS5sYXN0Q29tcGxldGlvbkRhdGUgfHxcbiAgICAgICAgICAgIGxvY2FsLmZyZWV6ZXNBdmFpbGFibGUgIT09IHJlbW90ZS5mcmVlemVzQXZhaWxhYmxlIHx8XG4gICAgICAgICAgICBsb2NhbC5mcmVlemVzVXNlZCAhPT0gcmVtb3RlLmZyZWV6ZXNVc2VkXG4gICAgICAgICk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgY29tcGxldGlvbiBvcGVyYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21wbGV0aW9uT3BlcmF0aW9uKFxuICAgICAgICBvcGVyYXRpb246IFN5bmNPcGVyYXRpb24sXG4gICAgICAgIHRyYW5zYWN0aW9uOiBhbnksXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25zQ29sbGVjdGlvbiA9IGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uKCk7XG5cbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24uYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiY3JlYXRlXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGxldGlvblJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24pO1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnNldChjb21wbGV0aW9uUmVmLCB7XG4gICAgICAgICAgICAgICAgICAgIC4uLm9wZXJhdGlvbi5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVwZGF0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24sIG9wZXJhdGlvbi5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi51cGRhdGUodXBkYXRlUmVmLCB7XG4gICAgICAgICAgICAgICAgICAgIC4uLm9wZXJhdGlvbi5kYXRhLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImRlbGV0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGRlbGV0ZVJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24sIG9wZXJhdGlvbi5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5kZWxldGUoZGVsZXRlUmVmKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgc3RyZWFrIG9wZXJhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVN0cmVha09wZXJhdGlvbihcbiAgICAgICAgb3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLFxuICAgICAgICB0cmFuc2FjdGlvbjogYW55LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzdHJlYWtzQ29sbGVjdGlvbiA9IGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24oKTtcbiAgICAgICAgY29uc3Qgc3RyZWFrSWQgPSBnZW5lcmF0ZVN0cmVha0lkKG9wZXJhdGlvbi51c2VySWQsIG9wZXJhdGlvbi5oYWJpdElkISk7XG4gICAgICAgIGNvbnN0IHN0cmVha1JlZiA9IGRvYyhzdHJlYWtzQ29sbGVjdGlvbiwgc3RyZWFrSWQpO1xuXG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiOlxuICAgICAgICAgICAgY2FzZSBcInVwZGF0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha0RhdGEgPSB0cmFuc2Zvcm1TdHJlYWtUb0ZpcmVzdG9yZShvcGVyYXRpb24uZGF0YSk7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uc2V0KHN0cmVha1JlZiwgc3RyZWFrRGF0YSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZGVsZXRlXCI6XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uZGVsZXRlKHN0cmVha1JlZik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIG1pbGVzdG9uZSBvcGVyYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVNaWxlc3RvbmVPcGVyYXRpb24oXG4gICAgICAgIG9wZXJhdGlvbjogU3luY09wZXJhdGlvbixcbiAgICAgICAgdHJhbnNhY3Rpb246IGFueSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gTWlsZXN0b25lIG9wZXJhdGlvbnMgYXJlIHR5cGljYWxseSBwYXJ0IG9mIHN0cmVhayB1cGRhdGVzXG4gICAgICAgIC8vIFRoaXMgaXMgYSBwbGFjZWhvbGRlciBmb3IgZnV0dXJlIG1pbGVzdG9uZS1zcGVjaWZpYyBvcGVyYXRpb25zXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRXhlY3V0aW5nIG1pbGVzdG9uZSBvcGVyYXRpb246XCIsIG9wZXJhdGlvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgY2hlY2tzdW0gZm9yIGRhdGEgaW50ZWdyaXR5XG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZUNoZWNrc3VtKGRhdGE6IGFueSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBsZXQgaGFzaCA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgICAgICBoYXNoID0gKGhhc2ggPDwgNSkgLSBoYXNoICsgY2hhcjtcbiAgICAgICAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDsgLy8gQ29udmVydCB0byAzMi1iaXQgaW50ZWdlclxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoYXNoLnRvU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG9wZXJhdGlvbiBJRFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVPcGVyYXRpb25JZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG9wXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIHBlbmRpbmcgb3BlcmF0aW9ucyB0byBzdG9yYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlUGVuZGluZ09wZXJhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBvcGVyYXRpb25zID0gQXJyYXkuZnJvbSh0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnZhbHVlcygpKTtcbiAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBvcGVyYXRpb25zLm1hcCgob3ApID0+ICh7XG4gICAgICAgICAgICAgICAgLi4ub3AsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBvcC50aW1lc3RhbXAudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICAgICBsYXN0QXR0ZW1wdDogb3AubGFzdEF0dGVtcHQ/LnRvTWlsbGlzKCksXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuUEVORElOR19PUFMsXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoc2VyaWFsaXplZCksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBzYXZlIHBlbmRpbmcgb3BlcmF0aW9uczpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBwZW5kaW5nIG9wZXJhdGlvbnMgZnJvbSBzdG9yYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkUGVuZGluZ09wZXJhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdG9yZWQgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlBFTkRJTkdfT1BTLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghc3RvcmVkKSByZXR1cm47XG5cbiAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBKU09OLnBhcnNlKHN0b3JlZCk7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLmNsZWFyKCk7XG5cbiAgICAgICAgICAgIG9wZXJhdGlvbnMuZm9yRWFjaCgob3A6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbjogU3luY09wZXJhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ub3AsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogVGltZXN0YW1wLmZyb21NaWxsaXMob3AudGltZXN0YW1wKSxcbiAgICAgICAgICAgICAgICAgICAgbGFzdEF0dGVtcHQ6IG9wLmxhc3RBdHRlbXB0XG4gICAgICAgICAgICAgICAgICAgICAgICA/IFRpbWVzdGFtcC5mcm9tTWlsbGlzKG9wLmxhc3RBdHRlbXB0KVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNldChvcGVyYXRpb24uaWQsIG9wZXJhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBwZW5kaW5nIG9wZXJhdGlvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydCBjb25uZWN0aXZpdHkgbW9uaXRvcmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRDb25uZWN0aXZpdHlNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgICAgICAvLyBDaGVjayBjb25uZWN0aXZpdHkgZXZlcnkgMzAgc2Vjb25kc1xuICAgICAgICBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvbmxpbmUgPSBhd2FpdCBpc09ubGluZSgpO1xuICAgICAgICAgICAgY29uc3Qgd2FzT25saW5lID0gdGhpcy5zeW5jU3RhdHVzLmlzT25saW5lO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBpc09ubGluZTogb25saW5lIH0pO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSBqdXN0IGNhbWUgYmFjayBvbmxpbmUsIHByb2Nlc3MgcGVuZGluZyBvcGVyYXRpb25zXG4gICAgICAgICAgICBpZiAob25saW5lICYmICF3YXNPbmxpbmUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3Rpb24gcmVzdG9yZWQsIHByb2Nlc3NpbmcgcGVuZGluZyBvcGVyYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDMwMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgc3luYyBlcnJvcnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGhhbmRsZVN5bmNFcnJvcihlcnJvcjogYW55KTogdm9pZCB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTeW5jIGVycm9yOlwiLCBlcnJvcik7XG5cbiAgICAgICAgLy8gVXBkYXRlIHN5bmMgc3RhdHVzIGJhc2VkIG9uIGVycm9yIHR5cGVcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwidW5hdmFpbGFibGVcIiB8fCBlcnJvci5tZXNzYWdlPy5pbmNsdWRlcyhcIm5ldHdvcmtcIikpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IGlzT25saW5lOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzeW5jIHN0YXR1cyBhbmQgbm90aWZ5IGxpc3RlbmVyc1xuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlU3luY1N0YXR1cyh1cGRhdGVzOiBQYXJ0aWFsPFN5bmNTdGF0dXM+KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3luY1N0YXR1cyA9IHsgLi4udGhpcy5zeW5jU3RhdHVzLCAuLi51cGRhdGVzIH07XG5cbiAgICAgICAgLy8gTm90aWZ5IGFsbCBzdGF0dXMgY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuc3RhdHVzQ2FsbGJhY2tzLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuc3luY1N0YXR1cyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBzeW5jIHN0YXR1cyBjYWxsYmFjazpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmUgdG8gc3luYyBzdGF0dXMgdXBkYXRlc1xuICAgICAqL1xuICAgIG9uU3luY1N0YXR1c0NoYW5nZShjYWxsYmFjazogKHN0YXR1czogU3luY1N0YXR1cykgPT4gdm9pZCk6ICgpID0+IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXR1c0NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuXG4gICAgICAgIC8vIENhbGwgaW1tZWRpYXRlbHkgd2l0aCBjdXJyZW50IHN0YXR1c1xuICAgICAgICBjYWxsYmFjayh0aGlzLnN5bmNTdGF0dXMpO1xuXG4gICAgICAgIC8vIFJldHVybiB1bnN1YnNjcmliZSBmdW5jdGlvblxuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNDYWxsYmFja3MuZGVsZXRlKGNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBzeW5jIHN0YXR1c1xuICAgICAqL1xuICAgIGdldFN5bmNTdGF0dXMoKTogU3luY1N0YXR1cyB7XG4gICAgICAgIHJldHVybiB7IC4uLnRoaXMuc3luY1N0YXR1cyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcmNlIHN5bmMgYWxsIGRhdGEgZm9yIGEgdXNlclxuICAgICAqIFJlcXVpcmVtZW50czogMTAuMSwgMTAuM1xuICAgICAqL1xuICAgIGFzeW5jIGZvcmNlU3luY1VzZXJEYXRhKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5zeW5jU3RhdHVzLmlzT25saW5lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZm9yY2Ugc3luYyB3aGlsZSBvZmZsaW5lXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiB0cnVlIH0pO1xuXG4gICAgICAgICAgICAvLyBTeW5jIGFsbCBzdHJlYWsgZGF0YVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zeW5jVXNlclN0cmVha3ModXNlcklkKTtcblxuICAgICAgICAgICAgLy8gU3luYyBhbGwgY29tcGxldGlvbiBkYXRhXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN5bmNVc2VyQ29tcGxldGlvbnModXNlcklkKTtcblxuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgbGFzdFN5bmM6IFRpbWVzdGFtcC5ub3coKSB9KTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN5bmMgdXNlciBzdHJlYWtzIGZyb20gc2VydmVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzeW5jVXNlclN0cmVha3ModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVha3NDb2xsZWN0aW9uID0gZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbigpO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFrc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICAgICAgICAgICAgc3RyZWFrc0NvbGxlY3Rpb24sXG4gICAgICAgICAgICAgICAgd2hlcmUoXCJ1c2VySWRcIiwgXCI9PVwiLCB1c2VySWQpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhzdHJlYWtzUXVlcnkpO1xuXG4gICAgICAgICAgICBjb25zdCBzdHJlYWtFbnRyaWVzID0gc25hcHNob3QuZG9jcy5tYXAoKGRvY1NuYXApID0+ICh7XG4gICAgICAgICAgICAgICAgaWQ6IGRvY1NuYXAuaWQsXG4gICAgICAgICAgICAgICAgc3RyZWFrOiB0cmFuc2Zvcm1GaXJlc3RvcmVUb1N0cmVhayhkb2NTbmFwLmRhdGEoKSksXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGFnZ3JlZ2F0ZVJlY29yZDogUmVjb3JkPHN0cmluZywgSGFiaXRTdHJlYWs+ID0ge307XG5cbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgICAgICAgIHN0cmVha0VudHJpZXMubWFwKGFzeW5jICh7IGlkLCBzdHJlYWsgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVSZWNvcmRbaWRdID0gc3RyZWFrO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShcbiAgICAgICAgICAgICAgICAgICAgICAgIGAke1N5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLU31fJHtpZH1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFrLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jYWNoZURhdGEoXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5TVFJFQUtTLFxuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZVJlY29yZCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYW51cENhY2hlUHJlZml4KFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLUyxcbiAgICAgICAgICAgICAgICBuZXcgU2V0KHN0cmVha0VudHJpZXMubWFwKChlbnRyeSkgPT4gZW50cnkuaWQpKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHN5bmMgc3RyZWFrczpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3luYyB1c2VyIGNvbXBsZXRpb25zIGZyb20gc2VydmVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzeW5jVXNlckNvbXBsZXRpb25zKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uc0NvbGxlY3Rpb24gPSBnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbigpO1xuICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbnNRdWVyeSA9IHF1ZXJ5KFxuICAgICAgICAgICAgICAgIGNvbXBsZXRpb25zQ29sbGVjdGlvbixcbiAgICAgICAgICAgICAgICB3aGVyZShcInVzZXJJZFwiLCBcIj09XCIsIHVzZXJJZCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGNvbXBsZXRpb25zUXVlcnkpO1xuXG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uRW50cmllcyA9IHNuYXBzaG90LmRvY3MubWFwKChkb2NTbmFwKSA9PiAoe1xuICAgICAgICAgICAgICAgIGlkOiBkb2NTbmFwLmlkLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRpb246IHRyYW5zZm9ybUZpcmVzdG9yZVRvQ29tcGxldGlvbihkb2NTbmFwLmlkLCBkb2NTbmFwLmRhdGEoKSksXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGFnZ3JlZ2F0ZVJlY29yZDogUmVjb3JkPHN0cmluZywgSGFiaXRDb21wbGV0aW9uPiA9IHt9O1xuXG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgICAgICBjb21wbGV0aW9uRW50cmllcy5tYXAoYXN5bmMgKHsgaWQsIGNvbXBsZXRpb24gfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVSZWNvcmRbaWRdID0gY29tcGxldGlvbjtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jYWNoZURhdGEoXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TfV8ke2lkfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jYWNoZURhdGEoXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OUyxcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGVSZWNvcmQsXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFudXBDYWNoZVByZWZpeChcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TLFxuICAgICAgICAgICAgICAgIG5ldyBTZXQoY29tcGxldGlvbkVudHJpZXMubWFwKChlbnRyeSkgPT4gZW50cnkuaWQpKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHN5bmMgY29tcGxldGlvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGFsbCBjYWNoZWQgZGF0YVxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ2FjaGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2UubXVsdGlSZW1vdmUoW1xuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLUyxcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TLFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuUEVORElOR19PUFMsXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5MQVNUX1NZTkMsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYW51cENhY2hlUHJlZml4KFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLUyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFudXBDYWNoZVByZWZpeChTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TKTtcblxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHtcbiAgICAgICAgICAgICAgICBwZW5kaW5nT3BlcmF0aW9uczogMCxcbiAgICAgICAgICAgICAgICBsYXN0U3luYzogbnVsbCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjbGVhciBjYWNoZTpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQg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