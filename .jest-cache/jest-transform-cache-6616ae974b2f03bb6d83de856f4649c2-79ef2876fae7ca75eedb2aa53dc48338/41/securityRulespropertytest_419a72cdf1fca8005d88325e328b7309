b28c16fc8fc3cfd19bf90097511ba00a
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var fc = _interopRequireWildcard(require("fast-check"));
var userIdArb = fc.oneof(fc.constant("user-1"), fc.constant("user-2"), fc.constant("user-3"), fc.constant("user-4"), fc.constant("user-5"));
var goalIdArb = fc.oneof(fc.constant("goal-1"), fc.constant("goal-2"), fc.constant("goal-3"), fc.constant("goal-4"));
var nudgeIdArb = fc.oneof(fc.constant("nudge-1"), fc.constant("nudge-2"), fc.constant("nudge-3"));
var testUserArb = fc.record({
  userId: userIdArb,
  friends: fc.array(userIdArb, {
    maxLength: 3
  }),
  displayName: fc.constant("Test User"),
  email: fc.constant("test@example.com")
});
var testGoalArb = fc.record({
  goalId: goalIdArb,
  ownerId: userIdArb,
  description: fc.constant("Test goal"),
  isShared: fc.boolean()
});
var testNudgeArb = fc.record({
  nudgeId: nudgeIdArb,
  senderId: userIdArb,
  receiverId: userIdArb,
  goalId: goalIdArb,
  goalDescription: fc.constant("Test goal description")
});
var authContextArb = fc.record({
  uid: fc.option(userIdArb, {
    nil: null
  }),
  isAuthenticated: fc.boolean()
});
function canReadGoal(authContext, goal, users) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  if (goal.ownerId === authContext.uid) {
    return true;
  }
  var goalOwner = users.find(function (u) {
    return u.userId === goal.ownerId;
  });
  if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
    return true;
  }
  return false;
}
function canReadNudge(authContext, nudge) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  return nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid;
}
function canCreateNudge(authContext, nudge, users) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  if (nudge.senderId !== authContext.uid) {
    return false;
  }
  var sender = users.find(function (u) {
    return u.userId === authContext.uid;
  });
  if (!sender || !sender.friends.includes(nudge.receiverId)) {
    return false;
  }
  return true;
}
function canAccessNudgeHistory(authContext, nudges, userId) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return [];
  }
  return nudges.filter(function (nudge) {
    return nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid;
  });
}
describe("Security Rules Property-Based Tests", function () {
  describe("Property 29: Feed access authorization", function () {
    it("should only allow reading goals belonging to friends or self", function () {
      fc.assert(fc.property(authContextArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, goal, users) {
        var canRead = canReadGoal(authContext, goal, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canRead).toBe(false);
          return;
        }
        if (goal.ownerId === authContext.uid) {
          expect(canRead).toBe(true);
          return;
        }
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
          expect(canRead).toBe(true);
        } else {
          expect(canRead).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
    it("should deny access to goals of non-friends", function () {
      fc.assert(fc.property(userIdArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (currentUserId, goal, users) {
        fc.pre(goal.ownerId !== currentUserId);
        var authContext = {
          uid: currentUserId,
          isAuthenticated: true
        };
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        fc.pre(!!goalOwner && !goalOwner.friends.includes(currentUserId));
        var canRead = canReadGoal(authContext, goal, users);
        expect(canRead).toBe(false);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 30: Nudge authorization", function () {
    it("should only allow creating nudges to friends", function () {
      fc.assert(fc.property(authContextArb, testNudgeArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, nudge, users) {
        var canCreate = canCreateNudge(authContext, nudge, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canCreate).toBe(false);
          return;
        }
        if (nudge.senderId !== authContext.uid) {
          expect(canCreate).toBe(false);
          return;
        }
        var sender = users.find(function (u) {
          return u.userId === authContext.uid;
        });
        if (sender && sender.friends.includes(nudge.receiverId)) {
          expect(canCreate).toBe(true);
        } else {
          expect(canCreate).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
    it("should deny nudge creation to non-friends", function () {
      fc.assert(fc.property(userIdArb, userIdArb, goalIdArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (senderId, receiverId, goalId, users) {
        fc.pre(senderId !== receiverId);
        var sender = users.find(function (u) {
          return u.userId === senderId;
        });
        fc.pre(!!sender && !sender.friends.includes(receiverId));
        var authContext = {
          uid: senderId,
          isAuthenticated: true
        };
        var nudge = {
          nudgeId: "test-nudge",
          senderId: senderId,
          receiverId: receiverId,
          goalId: goalId,
          goalDescription: "Test goal"
        };
        var canCreate = canCreateNudge(authContext, nudge, users);
        expect(canCreate).toBe(false);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 31: Goal detail access authorization", function () {
    it("should allow goal detail access only to owner or friends", function () {
      fc.assert(fc.property(authContextArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, goal, users) {
        var canAccess = canReadGoal(authContext, goal, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canAccess).toBe(false);
          return;
        }
        if (goal.ownerId === authContext.uid) {
          expect(canAccess).toBe(true);
          return;
        }
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
          expect(canAccess).toBe(true);
        } else {
          expect(canAccess).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 32: Nudge history authorization", function () {
    it("should only return nudges where user is sender or receiver", function () {
      fc.assert(fc.property(authContextArb, fc.array(testNudgeArb, {
        minLength: 0,
        maxLength: 10
      }), userIdArb, function (authContext, allNudges, queryUserId) {
        var accessibleNudges = canAccessNudgeHistory(authContext, allNudges, queryUserId);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(accessibleNudges).toEqual([]);
          return;
        }
        for (var nudge of accessibleNudges) {
          expect(nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid).toBe(true);
        }
      }), {
        numRuns: 20
      });
    });
    it("should exclude nudges where user is neither sender nor receiver", function () {
      fc.assert(fc.property(userIdArb, fc.array(testNudgeArb, {
        minLength: 1,
        maxLength: 10
      }), function (currentUserId, allNudges) {
        var unrelatedNudges = allNudges.filter(function (nudge) {
          return nudge.senderId !== currentUserId && nudge.receiverId !== currentUserId;
        });
        fc.pre(unrelatedNudges.length > 0);
        var authContext = {
          uid: currentUserId,
          isAuthenticated: true
        };
        var accessibleNudges = canAccessNudgeHistory(authContext, unrelatedNudges, currentUserId);
        expect(accessibleNudges).toEqual([]);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 33: Unauthenticated access denial", function () {
    it("should deny all goal access for unauthenticated users", function () {
      fc.assert(fc.property(testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (goal, users) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var canRead = canReadGoal(unauthenticatedContext, goal, users);
        expect(canRead).toBe(false);
      }), {
        numRuns: 20
      });
    });
    it("should deny all nudge access for unauthenticated users", function () {
      fc.assert(fc.property(testNudgeArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (nudge, users) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var canRead = canReadNudge(unauthenticatedContext, nudge);
        expect(canRead).toBe(false);
        var canCreate = canCreateNudge(unauthenticatedContext, nudge, users);
        expect(canCreate).toBe(false);
      }), {
        numRuns: 20
      });
    });
    it("should deny nudge history access for unauthenticated users", function () {
      fc.assert(fc.property(fc.array(testNudgeArb, {
        minLength: 0,
        maxLength: 10
      }), userIdArb, function (allNudges, queryUserId) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var accessibleNudges = canAccessNudgeHistory(unauthenticatedContext, allNudges, queryUserId);
        expect(accessibleNudges).toEqual([]);
      }), {
        numRuns: 20
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmYyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsInVzZXJJZEFyYiIsIm9uZW9mIiwiY29uc3RhbnQiLCJnb2FsSWRBcmIiLCJudWRnZUlkQXJiIiwidGVzdFVzZXJBcmIiLCJyZWNvcmQiLCJ1c2VySWQiLCJmcmllbmRzIiwiYXJyYXkiLCJtYXhMZW5ndGgiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwidGVzdEdvYWxBcmIiLCJnb2FsSWQiLCJvd25lcklkIiwiZGVzY3JpcHRpb24iLCJpc1NoYXJlZCIsImJvb2xlYW4iLCJ0ZXN0TnVkZ2VBcmIiLCJudWRnZUlkIiwic2VuZGVySWQiLCJyZWNlaXZlcklkIiwiZ29hbERlc2NyaXB0aW9uIiwiYXV0aENvbnRleHRBcmIiLCJ1aWQiLCJvcHRpb24iLCJuaWwiLCJpc0F1dGhlbnRpY2F0ZWQiLCJjYW5SZWFkR29hbCIsImF1dGhDb250ZXh0IiwiZ29hbCIsInVzZXJzIiwiZ29hbE93bmVyIiwiZmluZCIsInUiLCJpbmNsdWRlcyIsImNhblJlYWROdWRnZSIsIm51ZGdlIiwiY2FuQ3JlYXRlTnVkZ2UiLCJzZW5kZXIiLCJjYW5BY2Nlc3NOdWRnZUhpc3RvcnkiLCJudWRnZXMiLCJmaWx0ZXIiLCJkZXNjcmliZSIsIml0IiwiYXNzZXJ0IiwicHJvcGVydHkiLCJtaW5MZW5ndGgiLCJjYW5SZWFkIiwiZXhwZWN0IiwidG9CZSIsIm51bVJ1bnMiLCJjdXJyZW50VXNlcklkIiwicHJlIiwiY2FuQ3JlYXRlIiwiY2FuQWNjZXNzIiwiYWxsTnVkZ2VzIiwicXVlcnlVc2VySWQiLCJhY2Nlc3NpYmxlTnVkZ2VzIiwidG9FcXVhbCIsInVucmVsYXRlZE51ZGdlcyIsImxlbmd0aCIsInVuYXV0aGVudGljYXRlZENvbnRleHQiXSwic291cmNlcyI6WyJzZWN1cml0eVJ1bGVzLnByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQcm9wZXJ0eS1CYXNlZCBUZXN0cyBmb3IgRmlyZXN0b3JlIFNlY3VyaXR5IFJ1bGVzXG4gKiBGZWF0dXJlOiBzb2NpYWwtbnVkZ2luZy1mZWVkXG4gKi9cblxuaW1wb3J0ICogYXMgZmMgZnJvbSBcImZhc3QtY2hlY2tcIjtcblxuLyoqXG4gKiBUZXN0IGludGVyZmFjZXMgZm9yIHNlY3VyaXR5IHJ1bGUgdmFsaWRhdGlvblxuICovXG5pbnRlcmZhY2UgVGVzdFVzZXIge1xuICAgIHVzZXJJZDogc3RyaW5nO1xuICAgIGZyaWVuZHM6IHN0cmluZ1tdO1xuICAgIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG4gICAgZW1haWw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFRlc3RHb2FsIHtcbiAgICBnb2FsSWQ6IHN0cmluZztcbiAgICBvd25lcklkOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBpc1NoYXJlZDogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIFRlc3ROdWRnZSB7XG4gICAgbnVkZ2VJZDogc3RyaW5nO1xuICAgIHNlbmRlcklkOiBzdHJpbmc7XG4gICAgcmVjZWl2ZXJJZDogc3RyaW5nO1xuICAgIGdvYWxJZDogc3RyaW5nO1xuICAgIGdvYWxEZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQXV0aENvbnRleHQge1xuICAgIHVpZDogc3RyaW5nIHwgbnVsbDtcbiAgICBpc0F1dGhlbnRpY2F0ZWQ6IGJvb2xlYW47XG59XG5cbi8vIE9wdGltaXplZCBnZW5lcmF0b3JzIGZvciBmYXN0ZXIgdGVzdCBleGVjdXRpb25cbmNvbnN0IHVzZXJJZEFyYiA9IGZjLm9uZW9mKFxuICAgIGZjLmNvbnN0YW50KFwidXNlci0xXCIpLFxuICAgIGZjLmNvbnN0YW50KFwidXNlci0yXCIpLFxuICAgIGZjLmNvbnN0YW50KFwidXNlci0zXCIpLFxuICAgIGZjLmNvbnN0YW50KFwidXNlci00XCIpLFxuICAgIGZjLmNvbnN0YW50KFwidXNlci01XCIpLFxuKTtcblxuY29uc3QgZ29hbElkQXJiID0gZmMub25lb2YoXG4gICAgZmMuY29uc3RhbnQoXCJnb2FsLTFcIiksXG4gICAgZmMuY29uc3RhbnQoXCJnb2FsLTJcIiksXG4gICAgZmMuY29uc3RhbnQoXCJnb2FsLTNcIiksXG4gICAgZmMuY29uc3RhbnQoXCJnb2FsLTRcIiksXG4pO1xuXG5jb25zdCBudWRnZUlkQXJiID0gZmMub25lb2YoXG4gICAgZmMuY29uc3RhbnQoXCJudWRnZS0xXCIpLFxuICAgIGZjLmNvbnN0YW50KFwibnVkZ2UtMlwiKSxcbiAgICBmYy5jb25zdGFudChcIm51ZGdlLTNcIiksXG4pO1xuXG5jb25zdCB0ZXN0VXNlckFyYiA9IGZjLnJlY29yZCh7XG4gICAgdXNlcklkOiB1c2VySWRBcmIsXG4gICAgZnJpZW5kczogZmMuYXJyYXkodXNlcklkQXJiLCB7IG1heExlbmd0aDogMyB9KSxcbiAgICBkaXNwbGF5TmFtZTogZmMuY29uc3RhbnQoXCJUZXN0IFVzZXJcIiksXG4gICAgZW1haWw6IGZjLmNvbnN0YW50KFwidGVzdEBleGFtcGxlLmNvbVwiKSxcbn0pO1xuXG5jb25zdCB0ZXN0R29hbEFyYiA9IGZjLnJlY29yZCh7XG4gICAgZ29hbElkOiBnb2FsSWRBcmIsXG4gICAgb3duZXJJZDogdXNlcklkQXJiLFxuICAgIGRlc2NyaXB0aW9uOiBmYy5jb25zdGFudChcIlRlc3QgZ29hbFwiKSxcbiAgICBpc1NoYXJlZDogZmMuYm9vbGVhbigpLFxufSk7XG5cbmNvbnN0IHRlc3ROdWRnZUFyYiA9IGZjLnJlY29yZCh7XG4gICAgbnVkZ2VJZDogbnVkZ2VJZEFyYixcbiAgICBzZW5kZXJJZDogdXNlcklkQXJiLFxuICAgIHJlY2VpdmVySWQ6IHVzZXJJZEFyYixcbiAgICBnb2FsSWQ6IGdvYWxJZEFyYixcbiAgICBnb2FsRGVzY3JpcHRpb246IGZjLmNvbnN0YW50KFwiVGVzdCBnb2FsIGRlc2NyaXB0aW9uXCIpLFxufSk7XG5cbmNvbnN0IGF1dGhDb250ZXh0QXJiID0gZmMucmVjb3JkKHtcbiAgICB1aWQ6IGZjLm9wdGlvbih1c2VySWRBcmIsIHsgbmlsOiBudWxsIH0pLFxuICAgIGlzQXV0aGVudGljYXRlZDogZmMuYm9vbGVhbigpLFxufSk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgdGhhdCBzaW11bGF0ZSBGaXJlc3RvcmUgc2VjdXJpdHkgcnVsZSBsb2dpY1xuZnVuY3Rpb24gY2FuUmVhZEdvYWwoXG4gICAgYXV0aENvbnRleHQ6IEF1dGhDb250ZXh0LFxuICAgIGdvYWw6IFRlc3RHb2FsLFxuICAgIHVzZXJzOiBUZXN0VXNlcltdLFxuKTogYm9vbGVhbiB7XG4gICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gVXNlciBjYW4gcmVhZCB0aGVpciBvd24gZ29hbHNcbiAgICBpZiAoZ29hbC5vd25lcklkID09PSBhdXRoQ29udGV4dC51aWQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gVXNlciBjYW4gcmVhZCBnb2FscyBvZiBmcmllbmRzXG4gICAgY29uc3QgZ29hbE93bmVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IGdvYWwub3duZXJJZCk7XG4gICAgaWYgKGdvYWxPd25lciAmJiBnb2FsT3duZXIuZnJpZW5kcy5pbmNsdWRlcyhhdXRoQ29udGV4dC51aWQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY2FuUmVhZE51ZGdlKGF1dGhDb250ZXh0OiBBdXRoQ29udGV4dCwgbnVkZ2U6IFRlc3ROdWRnZSk6IGJvb2xlYW4ge1xuICAgIGlmICghYXV0aENvbnRleHQuaXNBdXRoZW50aWNhdGVkIHx8ICFhdXRoQ29udGV4dC51aWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFVzZXIgY2FuIHJlYWQgbnVkZ2VzIHdoZXJlIHRoZXkgYXJlIHNlbmRlciBvciByZWNlaXZlclxuICAgIHJldHVybiAoXG4gICAgICAgIG51ZGdlLnNlbmRlcklkID09PSBhdXRoQ29udGV4dC51aWQgfHwgbnVkZ2UucmVjZWl2ZXJJZCA9PT0gYXV0aENvbnRleHQudWlkXG4gICAgKTtcbn1cblxuZnVuY3Rpb24gY2FuQ3JlYXRlTnVkZ2UoXG4gICAgYXV0aENvbnRleHQ6IEF1dGhDb250ZXh0LFxuICAgIG51ZGdlOiBUZXN0TnVkZ2UsXG4gICAgdXNlcnM6IFRlc3RVc2VyW10sXG4pOiBib29sZWFuIHtcbiAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBVc2VyIG11c3QgYmUgdGhlIHNlbmRlclxuICAgIGlmIChudWRnZS5zZW5kZXJJZCAhPT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBSZWNlaXZlciBtdXN0IGJlIGluIHNlbmRlcidzIGZyaWVuZHMgbGlzdFxuICAgIGNvbnN0IHNlbmRlciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBhdXRoQ29udGV4dC51aWQpO1xuICAgIGlmICghc2VuZGVyIHx8ICFzZW5kZXIuZnJpZW5kcy5pbmNsdWRlcyhudWRnZS5yZWNlaXZlcklkKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGNhbkFjY2Vzc051ZGdlSGlzdG9yeShcbiAgICBhdXRoQ29udGV4dDogQXV0aENvbnRleHQsXG4gICAgbnVkZ2VzOiBUZXN0TnVkZ2VbXSxcbiAgICB1c2VySWQ6IHN0cmluZyxcbik6IFRlc3ROdWRnZVtdIHtcbiAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLyBVc2VyIGNhbiBvbmx5IHNlZSBudWRnZXMgd2hlcmUgdGhleSBhcmUgc2VuZGVyIG9yIHJlY2VpdmVyXG4gICAgcmV0dXJuIG51ZGdlcy5maWx0ZXIoXG4gICAgICAgIChudWRnZSkgPT5cbiAgICAgICAgICAgIG51ZGdlLnNlbmRlcklkID09PSBhdXRoQ29udGV4dC51aWQgfHxcbiAgICAgICAgICAgIG51ZGdlLnJlY2VpdmVySWQgPT09IGF1dGhDb250ZXh0LnVpZCxcbiAgICApO1xufVxuXG5kZXNjcmliZShcIlNlY3VyaXR5IFJ1bGVzIFByb3BlcnR5LUJhc2VkIFRlc3RzXCIsICgpID0+IHtcbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDI5OiBGZWVkIGFjY2VzcyBhdXRob3JpemF0aW9uKipcbiAgICAgKiAqKlZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDEwLjEqKlxuICAgICAqL1xuICAgIGRlc2NyaWJlKFwiUHJvcGVydHkgMjk6IEZlZWQgYWNjZXNzIGF1dGhvcml6YXRpb25cIiwgKCkgPT4ge1xuICAgICAgICBpdChcInNob3VsZCBvbmx5IGFsbG93IHJlYWRpbmcgZ29hbHMgYmVsb25naW5nIHRvIGZyaWVuZHMgb3Igc2VsZlwiLCAoKSA9PiB7XG4gICAgICAgICAgICBmYy5hc3NlcnQoXG4gICAgICAgICAgICAgICAgZmMucHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgIGF1dGhDb250ZXh0QXJiLFxuICAgICAgICAgICAgICAgICAgICB0ZXN0R29hbEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChhdXRoQ29udGV4dCwgZ29hbCwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhblJlYWQgPSBjYW5SZWFkR29hbChhdXRoQ29udGV4dCwgZ29hbCwgdXNlcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWwub3duZXJJZCA9PT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnb2FsT3duZXIgPSB1c2Vycy5maW5kKCh1KSA9PiB1LnVzZXJJZCA9PT0gZ29hbC5vd25lcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnb2FsT3duZXIgJiYgZ29hbE93bmVyLmZyaWVuZHMuaW5jbHVkZXMoYXV0aENvbnRleHQudWlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5SZWFkKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IGFjY2VzcyB0byBnb2FscyBvZiBub24tZnJpZW5kc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBmYy5hc3NlcnQoXG4gICAgICAgICAgICAgICAgZmMucHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdEdvYWxBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAoY3VycmVudFVzZXJJZCwgZ29hbCwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZjLnByZShnb2FsLm93bmVySWQgIT09IGN1cnJlbnRVc2VySWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoQ29udGV4dCA9IHsgdWlkOiBjdXJyZW50VXNlcklkLCBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdvYWxPd25lciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBnb2FsLm93bmVySWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmYy5wcmUoISFnb2FsT3duZXIgJiYgIWdvYWxPd25lci5mcmllbmRzLmluY2x1ZGVzKGN1cnJlbnRVc2VySWQpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuUmVhZCA9IGNhblJlYWRHb2FsKGF1dGhDb250ZXh0LCBnb2FsLCB1c2Vycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqICoqRmVhdHVyZTogc29jaWFsLW51ZGdpbmctZmVlZCwgUHJvcGVydHkgMzA6IE51ZGdlIGF1dGhvcml6YXRpb24qKlxuICAgICAqICoqVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMTAuMioqXG4gICAgICovXG4gICAgZGVzY3JpYmUoXCJQcm9wZXJ0eSAzMDogTnVkZ2UgYXV0aG9yaXphdGlvblwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIG9ubHkgYWxsb3cgY3JlYXRpbmcgbnVkZ2VzIHRvIGZyaWVuZHNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdE51ZGdlQXJiLFxuICAgICAgICAgICAgICAgICAgICBmYy5hcnJheSh0ZXN0VXNlckFyYiwgeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogNSB9KSxcbiAgICAgICAgICAgICAgICAgICAgKGF1dGhDb250ZXh0LCBudWRnZSwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbkNyZWF0ZSA9IGNhbkNyZWF0ZU51ZGdlKGF1dGhDb250ZXh0LCBudWRnZSwgdXNlcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVkZ2Uuc2VuZGVySWQgIT09IGF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5DcmVhdGUpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IGF1dGhDb250ZXh0LnVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZGVyICYmIHNlbmRlci5mcmllbmRzLmluY2x1ZGVzKG51ZGdlLnJlY2VpdmVySWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IG51ZGdlIGNyZWF0aW9uIHRvIG5vbi1mcmllbmRzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGZjLmFzc2VydChcbiAgICAgICAgICAgICAgICBmYy5wcm9wZXJ0eShcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkQXJiLFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIGdvYWxJZEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChzZW5kZXJJZCwgcmVjZWl2ZXJJZCwgZ29hbElkLCB1c2VycykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmMucHJlKHNlbmRlcklkICE9PSByZWNlaXZlcklkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IHNlbmRlcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZjLnByZSghIXNlbmRlciAmJiAhc2VuZGVyLmZyaWVuZHMuaW5jbHVkZXMocmVjZWl2ZXJJZCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoQ29udGV4dCA9IHsgdWlkOiBzZW5kZXJJZCwgaXNBdXRoZW50aWNhdGVkOiB0cnVlIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudWRnZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZUlkOiBcInRlc3QtbnVkZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsRGVzY3JpcHRpb246IFwiVGVzdCBnb2FsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5DcmVhdGUgPSBjYW5DcmVhdGVOdWRnZShhdXRoQ29udGV4dCwgbnVkZ2UsIHVzZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5DcmVhdGUpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDMxOiBHb2FsIGRldGFpbCBhY2Nlc3MgYXV0aG9yaXphdGlvbioqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC4zKipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMxOiBHb2FsIGRldGFpbCBhY2Nlc3MgYXV0aG9yaXphdGlvblwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIGFsbG93IGdvYWwgZGV0YWlsIGFjY2VzcyBvbmx5IHRvIG93bmVyIG9yIGZyaWVuZHNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdEdvYWxBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAoYXV0aENvbnRleHQsIGdvYWwsIHVzZXJzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHb2FsIGRldGFpbCBhY2Nlc3MgdXNlcyB0aGUgc2FtZSBsb2dpYyBhcyBmZWVkIGFjY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuQWNjZXNzID0gY2FuUmVhZEdvYWwoYXV0aENvbnRleHQsIGdvYWwsIHVzZXJzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5BY2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWwub3duZXJJZCA9PT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdvYWxPd25lciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBnb2FsLm93bmVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWxPd25lciAmJiBnb2FsT3duZXIuZnJpZW5kcy5pbmNsdWRlcyhhdXRoQ29udGV4dC51aWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqICoqRmVhdHVyZTogc29jaWFsLW51ZGdpbmctZmVlZCwgUHJvcGVydHkgMzI6IE51ZGdlIGhpc3RvcnkgYXV0aG9yaXphdGlvbioqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC40KipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMyOiBOdWRnZSBoaXN0b3J5IGF1dGhvcml6YXRpb25cIiwgKCkgPT4ge1xuICAgICAgICBpdChcInNob3VsZCBvbmx5IHJldHVybiBudWRnZXMgd2hlcmUgdXNlciBpcyBzZW5kZXIgb3IgcmVjZWl2ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdE51ZGdlQXJiLCB7IG1pbkxlbmd0aDogMCwgbWF4TGVuZ3RoOiAxMCB9KSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkQXJiLFxuICAgICAgICAgICAgICAgICAgICAoYXV0aENvbnRleHQsIGFsbE51ZGdlcywgcXVlcnlVc2VySWQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjY2Vzc2libGVOdWRnZXMgPSBjYW5BY2Nlc3NOdWRnZUhpc3RvcnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsTnVkZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChhY2Nlc3NpYmxlTnVkZ2VzKS50b0VxdWFsKFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbnVkZ2Ugb2YgYWNjZXNzaWJsZU51ZGdlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVkZ2Uuc2VuZGVySWQgPT09IGF1dGhDb250ZXh0LnVpZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5yZWNlaXZlcklkID09PSBhdXRoQ29udGV4dC51aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgZXhjbHVkZSBudWRnZXMgd2hlcmUgdXNlciBpcyBuZWl0aGVyIHNlbmRlciBub3IgcmVjZWl2ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3ROdWRnZUFyYiwgeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogMTAgfSksXG4gICAgICAgICAgICAgICAgICAgIChjdXJyZW50VXNlcklkLCBhbGxOdWRnZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciB0byBudWRnZXMgd2hlcmUgdXNlciBpcyBub3QgaW52b2x2ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVucmVsYXRlZE51ZGdlcyA9IGFsbE51ZGdlcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG51ZGdlKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5zZW5kZXJJZCAhPT0gY3VycmVudFVzZXJJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5yZWNlaXZlcklkICE9PSBjdXJyZW50VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZmMucHJlKHVucmVsYXRlZE51ZGdlcy5sZW5ndGggPiAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aENvbnRleHQgPSB7IHVpZDogY3VycmVudFVzZXJJZCwgaXNBdXRoZW50aWNhdGVkOiB0cnVlIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY2Nlc3NpYmxlTnVkZ2VzID0gY2FuQWNjZXNzTnVkZ2VIaXN0b3J5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVucmVsYXRlZE51ZGdlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGFjY2Vzc2libGVOdWRnZXMpLnRvRXF1YWwoW10pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDMzOiBVbmF1dGhlbnRpY2F0ZWQgYWNjZXNzIGRlbmlhbCoqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC41KipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMzOiBVbmF1dGhlbnRpY2F0ZWQgYWNjZXNzIGRlbmlhbFwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIGRlbnkgYWxsIGdvYWwgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB0ZXN0R29hbEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChnb2FsLCB1c2VycykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5hdXRoZW50aWNhdGVkQ29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5SZWFkID0gY2FuUmVhZEdvYWwodW5hdXRoZW50aWNhdGVkQ29udGV4dCwgZ29hbCwgdXNlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgZGVueSBhbGwgbnVkZ2UgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB0ZXN0TnVkZ2VBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAobnVkZ2UsIHVzZXJzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmF1dGhlbnRpY2F0ZWRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuUmVhZCA9IGNhblJlYWROdWRnZSh1bmF1dGhlbnRpY2F0ZWRDb250ZXh0LCBudWRnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbkNyZWF0ZSA9IGNhbkNyZWF0ZU51ZGdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuYXV0aGVudGljYXRlZENvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVkZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IG51ZGdlIGhpc3RvcnkgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBmYy5hcnJheSh0ZXN0TnVkZ2VBcmIsIHsgbWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDEwIH0pLFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIChhbGxOdWRnZXMsIHF1ZXJ5VXNlcklkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmF1dGhlbnRpY2F0ZWRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjY2Vzc2libGVOdWRnZXMgPSBjYW5BY2Nlc3NOdWRnZUhpc3RvcnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5hdXRoZW50aWNhdGVkQ29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxOdWRnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlVc2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGFjY2Vzc2libGVOdWRnZXMpLnRvRXF1YWwoW10pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IjtBQUtBLElBQUFBLEVBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQWlDQSxJQUFNQyxTQUFTLEdBQUdILEVBQUUsQ0FBQ0ksS0FBSyxDQUN0QkosRUFBRSxDQUFDSyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQ3JCTCxFQUFFLENBQUNL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