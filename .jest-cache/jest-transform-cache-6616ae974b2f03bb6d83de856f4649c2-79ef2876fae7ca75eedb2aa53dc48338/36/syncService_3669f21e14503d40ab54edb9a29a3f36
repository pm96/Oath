bc29e7ccbcfdf4e38bbb0701886a4727
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.syncService = exports.SyncService = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _firebaseConfig = require("../../firebaseConfig");
var _errorHandling = require("../../utils/errorHandling");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _firestore = require("firebase/firestore");
var _collections = require("./collections");
var _habitStreakSchemas = require("./habitStreakSchemas");
var SyncService = exports.SyncService = function () {
  function SyncService() {
    (0, _classCallCheck2.default)(this, SyncService);
    this.syncListeners = new Map();
    this.pendingOperations = new Map();
    this.syncStatus = {
      isOnline: true,
      lastSync: null,
      pendingOperations: 0,
      syncInProgress: false
    };
    this.statusCallbacks = new Set();
    this.initializeSync();
  }
  return (0, _createClass2.default)(SyncService, [{
    key: "initializeSync",
    value: (function () {
      var _initializeSync = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield this.loadPendingOperations();
          var online = yield (0, _errorHandling.isOnline)();
          this.updateSyncStatus({
            isOnline: online
          });
          if (online) {
            yield this.processPendingOperations();
          }
          this.startConnectivityMonitoring();
        } catch (error) {
          console.error("Failed to initialize sync service:", error);
        }
      });
      function initializeSync() {
        return _initializeSync.apply(this, arguments);
      }
      return initializeSync;
    }())
  }, {
    key: "startRealtimeSync",
    value: (function () {
      var _startRealtimeSync = (0, _asyncToGenerator2.default)(function* (userId) {
        var _this = this;
        if (!userId) {
          throw new Error("User ID is required for sync");
        }
        this.stopRealtimeSync(userId);
        try {
          var streaksCollection = (0, _collections.getHabitStreaksCollection)();
          var streakListener = onSnapshot(streaksCollection, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref = (0, _asyncToGenerator2.default)(function* (change) {
                var streakData = change.doc.data();
                if (streakData.userId === userId) {
                  yield _this.handleRealtimeStreakUpdate(change.doc.id, streakData, change.type);
                }
              });
              return function (_x2) {
                return _ref.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Streak sync error:", error);
            _this.handleSyncError(error);
          });
          var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
          var completionListener = onSnapshot(completionsCollection, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref2 = (0, _asyncToGenerator2.default)(function* (change) {
                var completionData = change.doc.data();
                if (completionData.userId === userId) {
                  yield _this.handleRealtimeCompletionUpdate(change.doc.id, completionData, change.type);
                }
              });
              return function (_x3) {
                return _ref2.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Completion sync error:", error);
            _this.handleSyncError(error);
          });
          this.syncListeners.set(`streaks_${userId}`, streakListener);
          this.syncListeners.set(`completions_${userId}`, completionListener);
        } catch (error) {
          console.error("Failed to start realtime sync:", error);
          throw error;
        }
      });
      function startRealtimeSync(_x) {
        return _startRealtimeSync.apply(this, arguments);
      }
      return startRealtimeSync;
    }())
  }, {
    key: "stopRealtimeSync",
    value: function stopRealtimeSync(userId) {
      var streakKey = `streaks_${userId}`;
      var completionKey = `completions_${userId}`;
      var streakListener = this.syncListeners.get(streakKey);
      if (streakListener) {
        streakListener();
        this.syncListeners.delete(streakKey);
      }
      var completionListener = this.syncListeners.get(completionKey);
      if (completionListener) {
        completionListener();
        this.syncListeners.delete(completionKey);
      }
    }
  }, {
    key: "cacheData",
    value: (function () {
      var _cacheData = (0, _asyncToGenerator2.default)(function* (key, data) {
        var version = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
        try {
          var checksum = this.generateChecksum(data);
          var cachedData = {
            data: data,
            timestamp: _firestore.Timestamp.now(),
            version: version,
            checksum: checksum
          };
          yield _asyncStorage.default.setItem(key, JSON.stringify(cachedData));
        } catch (error) {
          console.error("Failed to cache data:", error);
        }
      });
      function cacheData(_x4, _x5) {
        return _cacheData.apply(this, arguments);
      }
      return cacheData;
    }())
  }, {
    key: "getCachedData",
    value: (function () {
      var _getCachedData = (0, _asyncToGenerator2.default)(function* (key) {
        try {
          var cachedString = yield _asyncStorage.default.getItem(key);
          if (!cachedString) {
            return null;
          }
          var cachedData = JSON.parse(cachedString);
          var expectedChecksum = this.generateChecksum(cachedData.data);
          if (cachedData.checksum !== expectedChecksum) {
            console.warn("Cache integrity check failed, removing corrupted data");
            yield _asyncStorage.default.removeItem(key);
            return null;
          }
          return cachedData.data;
        } catch (error) {
          console.error("Failed to retrieve cached data:", error);
          return null;
        }
      });
      function getCachedData(_x6) {
        return _getCachedData.apply(this, arguments);
      }
      return getCachedData;
    }())
  }, {
    key: "queueOperation",
    value: (function () {
      var _queueOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var syncOp = Object.assign({}, operation, {
          id: this.generateOperationId(),
          timestamp: _firestore.Timestamp.now(),
          retryCount: 0
        });
        this.pendingOperations.set(syncOp.id, syncOp);
        yield this.savePendingOperations();
        this.updateSyncStatus({
          pendingOperations: this.pendingOperations.size
        });
        if (this.syncStatus.isOnline) {
          yield this.processPendingOperations();
        }
      });
      function queueOperation(_x7) {
        return _queueOperation.apply(this, arguments);
      }
      return queueOperation;
    }())
  }, {
    key: "processPendingOperations",
    value: (function () {
      var _processPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        if (this.syncStatus.syncInProgress || this.pendingOperations.size === 0) {
          return;
        }
        this.updateSyncStatus({
          syncInProgress: true
        });
        try {
          var operations = Array.from(this.pendingOperations.values()).sort(function (a, b) {
            return a.timestamp.toMillis() - b.timestamp.toMillis();
          });
          for (var operation of operations) {
            try {
              yield this.executeOperation(operation);
              this.pendingOperations.delete(operation.id);
            } catch (error) {
              console.error("Failed to execute operation:", error);
              operation.retryCount++;
              operation.lastAttempt = _firestore.Timestamp.now();
              if (operation.retryCount >= 3) {
                console.warn("Max retries exceeded, removing operation:", operation.id);
                this.pendingOperations.delete(operation.id);
              }
            }
          }
          yield this.savePendingOperations();
          this.updateSyncStatus({
            pendingOperations: this.pendingOperations.size,
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function processPendingOperations() {
        return _processPendingOperations.apply(this, arguments);
      }
      return processPendingOperations;
    }())
  }, {
    key: "executeOperation",
    value: (function () {
      var _executeOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var _this2 = this;
        return yield (0, _errorHandling.retryWithBackoff)((0, _asyncToGenerator2.default)(function* () {
          return yield runTransaction(_firebaseConfig.db, function () {
            var _ref4 = (0, _asyncToGenerator2.default)(function* (transaction) {
              switch (operation.type) {
                case "completion":
                  yield _this2.executeCompletionOperation(operation, transaction);
                  break;
                case "streak":
                  yield _this2.executeStreakOperation(operation, transaction);
                  break;
                case "milestone":
                  yield _this2.executeMilestoneOperation(operation, transaction);
                  break;
                default:
                  throw new Error(`Unknown operation type: ${operation.type}`);
              }
            });
            return function (_x9) {
              return _ref4.apply(this, arguments);
            };
          }());
        }));
      });
      function executeOperation(_x8) {
        return _executeOperation.apply(this, arguments);
      }
      return executeOperation;
    }())
  }, {
    key: "handleRealtimeStreakUpdate",
    value: (function () {
      var _handleRealtimeStreakUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            return;
          }
          var streak = (0, _habitStreakSchemas.transformFirestoreToStreak)(data);
          var cacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
          var cachedStreak = yield this.getCachedData(cacheKey);
          if (cachedStreak && this.hasConflict(cachedStreak, streak)) {
            var resolvedStreak = yield this.resolveStreakConflict(cachedStreak, streak);
            yield this.cacheData(cacheKey, resolvedStreak);
          } else {
            yield this.cacheData(cacheKey, streak);
          }
        } catch (error) {
          console.error("Error handling realtime streak update:", error);
        }
      });
      function handleRealtimeStreakUpdate(_x0, _x1, _x10) {
        return _handleRealtimeStreakUpdate.apply(this, arguments);
      }
      return handleRealtimeStreakUpdate;
    }())
  }, {
    key: "handleRealtimeCompletionUpdate",
    value: (function () {
      var _handleRealtimeCompletionUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            return;
          }
          var completion = (0, _habitStreakSchemas.transformFirestoreToCompletion)(docId, data);
          var cacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
          yield this.cacheData(cacheKey, completion);
        } catch (error) {
          console.error("Error handling realtime completion update:", error);
        }
      });
      function handleRealtimeCompletionUpdate(_x11, _x12, _x13) {
        return _handleRealtimeCompletionUpdate.apply(this, arguments);
      }
      return handleRealtimeCompletionUpdate;
    }())
  }, {
    key: "resolveStreakConflict",
    value: (function () {
      var _resolveStreakConflict = (0, _asyncToGenerator2.default)(function* (localStreak, remoteStreak) {
        if (!localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          return remoteStreak;
        }
        if (localStreak.lastCompletionDate && !remoteStreak.lastCompletionDate) {
          return localStreak;
        }
        if (localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          if (localStreak.lastCompletionDate > remoteStreak.lastCompletionDate) {
            return localStreak;
          } else if (localStreak.lastCompletionDate < remoteStreak.lastCompletionDate) {
            return remoteStreak;
          } else {
            return localStreak.currentStreak >= remoteStreak.currentStreak ? localStreak : remoteStreak;
          }
        }
        return remoteStreak;
      });
      function resolveStreakConflict(_x14, _x15) {
        return _resolveStreakConflict.apply(this, arguments);
      }
      return resolveStreakConflict;
    }())
  }, {
    key: "hasConflict",
    value: function hasConflict(local, remote) {
      return local.currentStreak !== remote.currentStreak || local.bestStreak !== remote.bestStreak || local.lastCompletionDate !== remote.lastCompletionDate || local.freezesAvailable !== remote.freezesAvailable || local.freezesUsed !== remote.freezesUsed;
    }
  }, {
    key: "executeCompletionOperation",
    value: (function () {
      var _executeCompletionOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
        switch (operation.action) {
          case "create":
            var completionRef = doc(completionsCollection);
            transaction.set(completionRef, Object.assign({}, operation.data, {
              createdAt: serverTimestamp()
            }));
            break;
          case "update":
            var updateRef = doc(completionsCollection, operation.data.id);
            transaction.update(updateRef, Object.assign({}, operation.data, {
              updatedAt: serverTimestamp()
            }));
            break;
          case "delete":
            var deleteRef = doc(completionsCollection, operation.data.id);
            transaction.delete(deleteRef);
            break;
        }
      });
      function executeCompletionOperation(_x16, _x17) {
        return _executeCompletionOperation.apply(this, arguments);
      }
      return executeCompletionOperation;
    }())
  }, {
    key: "executeStreakOperation",
    value: (function () {
      var _executeStreakOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var streaksCollection = (0, _collections.getHabitStreaksCollection)();
        var streakId = (0, _habitStreakSchemas.generateStreakId)(operation.userId, operation.habitId);
        var streakRef = doc(streaksCollection, streakId);
        switch (operation.action) {
          case "create":
          case "update":
            var streakData = (0, _habitStreakSchemas.transformStreakToFirestore)(operation.data);
            transaction.set(streakRef, streakData);
            break;
          case "delete":
            transaction.delete(streakRef);
            break;
        }
      });
      function executeStreakOperation(_x18, _x19) {
        return _executeStreakOperation.apply(this, arguments);
      }
      return executeStreakOperation;
    }())
  }, {
    key: "executeMilestoneOperation",
    value: (function () {
      var _executeMilestoneOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        console.log("Executing milestone operation:", operation);
      });
      function executeMilestoneOperation(_x20, _x21) {
        return _executeMilestoneOperation.apply(this, arguments);
      }
      return executeMilestoneOperation;
    }())
  }, {
    key: "generateChecksum",
    value: function generateChecksum(data) {
      var str = JSON.stringify(data);
      var hash = 0;
      for (var i = 0; i < str.length; i++) {
        var char = str.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash = hash & hash;
      }
      return hash.toString();
    }
  }, {
    key: "generateOperationId",
    value: function generateOperationId() {
      return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
  }, {
    key: "savePendingOperations",
    value: (function () {
      var _savePendingOperations = (0, _asyncToGenerator2.default)(function* () {
        try {
          var operations = Array.from(this.pendingOperations.values());
          var serialized = operations.map(function (op) {
            var _op$lastAttempt;
            return Object.assign({}, op, {
              timestamp: op.timestamp.toMillis(),
              lastAttempt: (_op$lastAttempt = op.lastAttempt) == null ? void 0 : _op$lastAttempt.toMillis()
            });
          });
          yield _asyncStorage.default.setItem(SyncService.CACHE_KEYS.PENDING_OPS, JSON.stringify(serialized));
        } catch (error) {
          console.error("Failed to save pending operations:", error);
        }
      });
      function savePendingOperations() {
        return _savePendingOperations.apply(this, arguments);
      }
      return savePendingOperations;
    }())
  }, {
    key: "loadPendingOperations",
    value: (function () {
      var _loadPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        var _this3 = this;
        try {
          var stored = yield _asyncStorage.default.getItem(SyncService.CACHE_KEYS.PENDING_OPS);
          if (!stored) return;
          var operations = JSON.parse(stored);
          this.pendingOperations.clear();
          operations.forEach(function (op) {
            var operation = Object.assign({}, op, {
              timestamp: _firestore.Timestamp.fromMillis(op.timestamp),
              lastAttempt: op.lastAttempt ? _firestore.Timestamp.fromMillis(op.lastAttempt) : undefined
            });
            _this3.pendingOperations.set(operation.id, operation);
          });
        } catch (error) {
          console.error("Failed to load pending operations:", error);
        }
      });
      function loadPendingOperations() {
        return _loadPendingOperations.apply(this, arguments);
      }
      return loadPendingOperations;
    }())
  }, {
    key: "startConnectivityMonitoring",
    value: function startConnectivityMonitoring() {
      var _this4 = this;
      setInterval((0, _asyncToGenerator2.default)(function* () {
        var online = yield (0, _errorHandling.isOnline)();
        var wasOnline = _this4.syncStatus.isOnline;
        _this4.updateSyncStatus({
          isOnline: online
        });
        if (online && !wasOnline) {
          console.log("Connection restored, processing pending operations");
          yield _this4.processPendingOperations();
        }
      }), 30000);
    }
  }, {
    key: "handleSyncError",
    value: function handleSyncError(error) {
      var _error$message;
      console.error("Sync error:", error);
      if (error.code === "unavailable" || (_error$message = error.message) != null && _error$message.includes("network")) {
        this.updateSyncStatus({
          isOnline: false
        });
      }
    }
  }, {
    key: "updateSyncStatus",
    value: function updateSyncStatus(updates) {
      var _this5 = this;
      this.syncStatus = Object.assign({}, this.syncStatus, updates);
      this.statusCallbacks.forEach(function (callback) {
        try {
          callback(_this5.syncStatus);
        } catch (error) {
          console.error("Error in sync status callback:", error);
        }
      });
    }
  }, {
    key: "onSyncStatusChange",
    value: function onSyncStatusChange(callback) {
      var _this6 = this;
      this.statusCallbacks.add(callback);
      callback(this.syncStatus);
      return function () {
        _this6.statusCallbacks.delete(callback);
      };
    }
  }, {
    key: "getSyncStatus",
    value: function getSyncStatus() {
      return Object.assign({}, this.syncStatus);
    }
  }, {
    key: "forceSyncUserData",
    value: (function () {
      var _forceSyncUserData = (0, _asyncToGenerator2.default)(function* (userId) {
        if (!this.syncStatus.isOnline) {
          throw new Error("Cannot force sync while offline");
        }
        try {
          this.updateSyncStatus({
            syncInProgress: true
          });
          yield this.syncUserStreaks(userId);
          yield this.syncUserCompletions(userId);
          this.updateSyncStatus({
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function forceSyncUserData(_x22) {
        return _forceSyncUserData.apply(this, arguments);
      }
      return forceSyncUserData;
    }())
  }, {
    key: "syncUserStreaks",
    value: (function () {
      var _syncUserStreaks = (0, _asyncToGenerator2.default)(function* (userId) {
        var streaksCollection = (0, _collections.getHabitStreaksCollection)();
        console.log("Syncing streaks for user:", userId);
      });
      function syncUserStreaks(_x23) {
        return _syncUserStreaks.apply(this, arguments);
      }
      return syncUserStreaks;
    }())
  }, {
    key: "syncUserCompletions",
    value: (function () {
      var _syncUserCompletions = (0, _asyncToGenerator2.default)(function* (userId) {
        var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
        console.log("Syncing completions for user:", userId);
      });
      function syncUserCompletions(_x24) {
        return _syncUserCompletions.apply(this, arguments);
      }
      return syncUserCompletions;
    }())
  }, {
    key: "clearCache",
    value: (function () {
      var _clearCache = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield _asyncStorage.default.multiRemove([SyncService.CACHE_KEYS.STREAKS, SyncService.CACHE_KEYS.COMPLETIONS, SyncService.CACHE_KEYS.PENDING_OPS, SyncService.CACHE_KEYS.LAST_SYNC]);
          this.pendingOperations.clear();
          this.updateSyncStatus({
            pendingOperations: 0,
            lastSync: null
          });
        } catch (error) {
          console.error("Failed to clear cache:", error);
        }
      });
      function clearCache() {
        return _clearCache.apply(this, arguments);
      }
      return clearCache;
    }())
  }], [{
    key: "getInstance",
    value: function getInstance() {
      if (!SyncService.instance) {
        SyncService.instance = new SyncService();
      }
      return SyncService.instance;
    }
  }]);
}();
SyncService.CACHE_KEYS = {
  STREAKS: "@habit_streaks_cache",
  COMPLETIONS: "@habit_completions_cache",
  PENDING_OPS: "@pending_sync_operations",
  LAST_SYNC: "@last_sync_timestamp"
};
var syncService = exports.syncService = SyncService.getInstance();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZmlyZWJhc2VDb25maWciLCJyZXF1aXJlIiwiX2Vycm9ySGFuZGxpbmciLCJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9maXJlc3RvcmUiLCJfY29sbGVjdGlvbnMiLCJfaGFiaXRTdHJlYWtTY2hlbWFzIiwiU3luY1NlcnZpY2UiLCJleHBvcnRzIiwiX2NsYXNzQ2FsbENoZWNrMiIsImRlZmF1bHQiLCJzeW5jTGlzdGVuZXJzIiwiTWFwIiwicGVuZGluZ09wZXJhdGlvbnMiLCJzeW5jU3RhdHVzIiwiaXNPbmxpbmUiLCJsYXN0U3luYyIsInN5bmNJblByb2dyZXNzIiwic3RhdHVzQ2FsbGJhY2tzIiwiU2V0IiwiaW5pdGlhbGl6ZVN5bmMiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJfaW5pdGlhbGl6ZVN5bmMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJsb2FkUGVuZGluZ09wZXJhdGlvbnMiLCJvbmxpbmUiLCJ1cGRhdGVTeW5jU3RhdHVzIiwicHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zIiwic3RhcnRDb25uZWN0aXZpdHlNb25pdG9yaW5nIiwiZXJyb3IiLCJjb25zb2xlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfc3RhcnRSZWFsdGltZVN5bmMiLCJ1c2VySWQiLCJfdGhpcyIsIkVycm9yIiwic3RvcFJlYWx0aW1lU3luYyIsInN0cmVha3NDb2xsZWN0aW9uIiwiZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbiIsInN0cmVha0xpc3RlbmVyIiwib25TbmFwc2hvdCIsInNuYXBzaG90IiwiZG9jQ2hhbmdlcyIsImZvckVhY2giLCJfcmVmIiwiY2hhbmdlIiwic3RyZWFrRGF0YSIsImRvYyIsImRhdGEiLCJoYW5kbGVSZWFsdGltZVN0cmVha1VwZGF0ZSIsImlkIiwidHlwZSIsIl94MiIsImhhbmRsZVN5bmNFcnJvciIsImNvbXBsZXRpb25zQ29sbGVjdGlvbiIsImdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uIiwiY29tcGxldGlvbkxpc3RlbmVyIiwiX3JlZjIiLCJjb21wbGV0aW9uRGF0YSIsImhhbmRsZVJlYWx0aW1lQ29tcGxldGlvblVwZGF0ZSIsIl94MyIsInNldCIsInN0YXJ0UmVhbHRpbWVTeW5jIiwiX3giLCJzdHJlYWtLZXkiLCJjb21wbGV0aW9uS2V5IiwiZ2V0IiwiZGVsZXRlIiwiX2NhY2hlRGF0YSIsInZlcnNpb24iLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjaGVja3N1bSIsImdlbmVyYXRlQ2hlY2tzdW0iLCJjYWNoZWREYXRhIiwidGltZXN0YW1wIiwiVGltZXN0YW1wIiwibm93IiwiQXN5bmNTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYWNoZURhdGEiLCJfeDQiLCJfeDUiLCJfZ2V0Q2FjaGVkRGF0YSIsImNhY2hlZFN0cmluZyIsImdldEl0ZW0iLCJwYXJzZSIsImV4cGVjdGVkQ2hlY2tzdW0iLCJ3YXJuIiwicmVtb3ZlSXRlbSIsImdldENhY2hlZERhdGEiLCJfeDYiLCJfcXVldWVPcGVyYXRpb24iLCJvcGVyYXRpb24iLCJzeW5jT3AiLCJPYmplY3QiLCJhc3NpZ24iLCJnZW5lcmF0ZU9wZXJhdGlvbklkIiwicmV0cnlDb3VudCIsInNhdmVQZW5kaW5nT3BlcmF0aW9ucyIsInNpemUiLCJxdWV1ZU9wZXJhdGlvbiIsIl94NyIsIl9wcm9jZXNzUGVuZGluZ09wZXJhdGlvbnMiLCJvcGVyYXRpb25zIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwic29ydCIsImEiLCJiIiwidG9NaWxsaXMiLCJleGVjdXRlT3BlcmF0aW9uIiwibGFzdEF0dGVtcHQiLCJfZXhlY3V0ZU9wZXJhdGlvbiIsIl90aGlzMiIsInJldHJ5V2l0aEJhY2tvZmYiLCJydW5UcmFuc2FjdGlvbiIsImRiIiwiX3JlZjQiLCJ0cmFuc2FjdGlvbiIsImV4ZWN1dGVDb21wbGV0aW9uT3BlcmF0aW9uIiwiZXhlY3V0ZVN0cmVha09wZXJhdGlvbiIsImV4ZWN1dGVNaWxlc3RvbmVPcGVyYXRpb24iLCJfeDkiLCJfeDgiLCJfaGFuZGxlUmVhbHRpbWVTdHJlYWtVcGRhdGUiLCJkb2NJZCIsImNoYW5nZVR5cGUiLCJyZW1vdmVDYWNoZUtleSIsIkNBQ0hFX0tFWVMiLCJTVFJFQUtTIiwic3RyZWFrIiwidHJhbnNmb3JtRmlyZXN0b3JlVG9TdHJlYWsiLCJjYWNoZUtleSIsImNhY2hlZFN0cmVhayIsImhhc0NvbmZsaWN0IiwicmVzb2x2ZWRTdHJlYWsiLCJyZXNvbHZlU3RyZWFrQ29uZmxpY3QiLCJfeDAiLCJfeDEiLCJfeDEwIiwiX2hhbmRsZVJlYWx0aW1lQ29tcGxldGlvblVwZGF0ZSIsIkNPTVBMRVRJT05TIiwiY29tcGxldGlvbiIsInRyYW5zZm9ybUZpcmVzdG9yZVRvQ29tcGxldGlvbiIsIl94MTEiLCJfeDEyIiwiX3gxMyIsIl9yZXNvbHZlU3RyZWFrQ29uZmxpY3QiLCJsb2NhbFN0cmVhayIsInJlbW90ZVN0cmVhayIsImxhc3RDb21wbGV0aW9uRGF0ZSIsImN1cnJlbnRTdHJlYWsiLCJfeDE0IiwiX3gxNSIsImxvY2FsIiwicmVtb3RlIiwiYmVzdFN0cmVhayIsImZyZWV6ZXNBdmFpbGFibGUiLCJmcmVlemVzVXNlZCIsIl9leGVjdXRlQ29tcGxldGlvbk9wZXJhdGlvbiIsImFjdGlvbiIsImNvbXBsZXRpb25SZWYiLCJjcmVhdGVkQXQiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJ1cGRhdGVSZWYiLCJ1cGRhdGUiLCJ1cGRhdGVkQXQiLCJkZWxldGVSZWYiLCJfeDE2IiwiX3gxNyIsIl9leGVjdXRlU3RyZWFrT3BlcmF0aW9uIiwic3RyZWFrSWQiLCJnZW5lcmF0ZVN0cmVha0lkIiwiaGFiaXRJZCIsInN0cmVha1JlZiIsInRyYW5zZm9ybVN0cmVha1RvRmlyZXN0b3JlIiwiX3gxOCIsIl94MTkiLCJfZXhlY3V0ZU1pbGVzdG9uZU9wZXJhdGlvbiIsImxvZyIsIl94MjAiLCJfeDIxIiwic3RyIiwiaGFzaCIsImkiLCJjaGFyIiwiY2hhckNvZGVBdCIsInRvU3RyaW5nIiwiRGF0ZSIsIk1hdGgiLCJyYW5kb20iLCJzdWJzdHIiLCJfc2F2ZVBlbmRpbmdPcGVyYXRpb25zIiwic2VyaWFsaXplZCIsIm1hcCIsIm9wIiwiX29wJGxhc3RBdHRlbXB0IiwiUEVORElOR19PUFMiLCJfbG9hZFBlbmRpbmdPcGVyYXRpb25zIiwiX3RoaXMzIiwic3RvcmVkIiwiY2xlYXIiLCJmcm9tTWlsbGlzIiwiX3RoaXM0Iiwic2V0SW50ZXJ2YWwiLCJ3YXNPbmxpbmUiLCJfZXJyb3IkbWVzc2FnZSIsImNvZGUiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJ1cGRhdGVzIiwiX3RoaXM1IiwiY2FsbGJhY2siLCJvblN5bmNTdGF0dXNDaGFuZ2UiLCJfdGhpczYiLCJhZGQiLCJnZXRTeW5jU3RhdHVzIiwiX2ZvcmNlU3luY1VzZXJEYXRhIiwic3luY1VzZXJTdHJlYWtzIiwic3luY1VzZXJDb21wbGV0aW9ucyIsImZvcmNlU3luY1VzZXJEYXRhIiwiX3gyMiIsIl9zeW5jVXNlclN0cmVha3MiLCJfeDIzIiwiX3N5bmNVc2VyQ29tcGxldGlvbnMiLCJfeDI0IiwiX2NsZWFyQ2FjaGUiLCJtdWx0aVJlbW92ZSIsIkxBU1RfU1lOQyIsImNsZWFyQ2FjaGUiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwic3luY1NlcnZpY2UiXSwic291cmNlcyI6WyJzeW5jU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERhdGEgU3luY2hyb25pemF0aW9uIFNlcnZpY2VcbiAqXG4gKiBIYW5kbGVzIGNyb3NzLWRldmljZSBkYXRhIHN5bmNocm9uaXphdGlvbiwgb2ZmbGluZSBjYWNoaW5nLCBhbmQgY29uZmxpY3QgcmVzb2x1dGlvblxuICogUmVxdWlyZW1lbnRzOiAxMC4xLCAxMC4yLCAxMC4zLCAxMC40LCAxMC41XG4gKi9cblxuaW1wb3J0IHsgZGIgfSBmcm9tIFwiQC9maXJlYmFzZUNvbmZpZ1wiO1xuaW1wb3J0IHsgSGFiaXRTdHJlYWsgfSBmcm9tIFwiQC90eXBlc1wiO1xuaW1wb3J0IHsgaXNPbmxpbmUsIHJldHJ5V2l0aEJhY2tvZmYgfSBmcm9tIFwiQC91dGlscy9lcnJvckhhbmRsaW5nXCI7XG5pbXBvcnQgQXN5bmNTdG9yYWdlIGZyb20gXCJAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZVwiO1xuaW1wb3J0IHsgVW5zdWJzY3JpYmUgfSBmcm9tIFwiZmlyZWJhc2UvYXV0aFwiO1xuaW1wb3J0IHsgVGltZXN0YW1wIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuaW1wb3J0IHsgZ2V0SGFiaXRDb21wbGV0aW9uc0NvbGxlY3Rpb24sIGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24gfSBmcm9tIFwiLi9jb2xsZWN0aW9uc1wiO1xuaW1wb3J0IHsgZ2VuZXJhdGVTdHJlYWtJZCwgdHJhbnNmb3JtRmlyZXN0b3JlVG9Db21wbGV0aW9uLCB0cmFuc2Zvcm1GaXJlc3RvcmVUb1N0cmVhaywgdHJhbnNmb3JtU3RyZWFrVG9GaXJlc3RvcmUgfSBmcm9tIFwiLi9oYWJpdFN0cmVha1NjaGVtYXNcIjtcblxuLyoqXG4gKiBTeW5jIG9wZXJhdGlvbiB0eXBlc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNPcGVyYXRpb24ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdHlwZTogXCJjb21wbGV0aW9uXCIgfCBcInN0cmVha1wiIHwgXCJtaWxlc3RvbmVcIjtcbiAgICBhY3Rpb246IFwiY3JlYXRlXCIgfCBcInVwZGF0ZVwiIHwgXCJkZWxldGVcIjtcbiAgICBkYXRhOiBhbnk7XG4gICAgdGltZXN0YW1wOiBUaW1lc3RhbXA7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgaGFiaXRJZD86IHN0cmluZztcbiAgICByZXRyeUNvdW50OiBudW1iZXI7XG4gICAgbGFzdEF0dGVtcHQ/OiBUaW1lc3RhbXA7XG59XG5cbi8qKlxuICogQ2FjaGVkIGRhdGEgc3RydWN0dXJlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVkRGF0YTxUPiB7XG4gICAgZGF0YTogVDtcbiAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcDtcbiAgICB2ZXJzaW9uOiBudW1iZXI7XG4gICAgY2hlY2tzdW06IHN0cmluZztcbn1cblxuLyoqXG4gKiBTeW5jIHN0YXR1c1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNTdGF0dXMge1xuICAgIGlzT25saW5lOiBib29sZWFuO1xuICAgIGxhc3RTeW5jOiBUaW1lc3RhbXAgfCBudWxsO1xuICAgIHBlbmRpbmdPcGVyYXRpb25zOiBudW1iZXI7XG4gICAgc3luY0luUHJvZ3Jlc3M6IGJvb2xlYW47XG59XG4vKipcbiAqIERhdGEgU3luY2hyb25pemF0aW9uIFNlcnZpY2UgSW1wbGVtZW50YXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFN5bmNTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU3luY1NlcnZpY2U7XG4gICAgcHJpdmF0ZSBzeW5jTGlzdGVuZXJzOiBNYXA8c3RyaW5nLCBVbnN1YnNjcmliZT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBwZW5kaW5nT3BlcmF0aW9uczogTWFwPHN0cmluZywgU3luY09wZXJhdGlvbj4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBzeW5jU3RhdHVzOiBTeW5jU3RhdHVzID0ge1xuICAgICAgICBpc09ubGluZTogdHJ1ZSxcbiAgICAgICAgbGFzdFN5bmM6IG51bGwsXG4gICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiAwLFxuICAgICAgICBzeW5jSW5Qcm9ncmVzczogZmFsc2UsXG4gICAgfTtcbiAgICBwcml2YXRlIHN0YXR1c0NhbGxiYWNrczogU2V0PChzdGF0dXM6IFN5bmNTdGF0dXMpID0+IHZvaWQ+ID0gbmV3IFNldCgpO1xuXG4gICAgLy8gQ2FjaGUga2V5c1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENBQ0hFX0tFWVMgPSB7XG4gICAgICAgIFNUUkVBS1M6IFwiQGhhYml0X3N0cmVha3NfY2FjaGVcIixcbiAgICAgICAgQ09NUExFVElPTlM6IFwiQGhhYml0X2NvbXBsZXRpb25zX2NhY2hlXCIsXG4gICAgICAgIFBFTkRJTkdfT1BTOiBcIkBwZW5kaW5nX3N5bmNfb3BlcmF0aW9uc1wiLFxuICAgICAgICBMQVNUX1NZTkM6IFwiQGxhc3Rfc3luY190aW1lc3RhbXBcIixcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplU3luYygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU3luY1NlcnZpY2Uge1xuICAgICAgICBpZiAoIVN5bmNTZXJ2aWNlLmluc3RhbmNlKSB7XG4gICAgICAgICAgICBTeW5jU2VydmljZS5pbnN0YW5jZSA9IG5ldyBTeW5jU2VydmljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBTeW5jU2VydmljZS5pbnN0YW5jZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHN5bmNocm9uaXphdGlvbiBzeXN0ZW1cbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVTeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gTG9hZCBwZW5kaW5nIG9wZXJhdGlvbnMgZnJvbSBzdG9yYWdlXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRQZW5kaW5nT3BlcmF0aW9ucygpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBjb25uZWN0aXZpdHkgYW5kIHN0YXJ0IHN5bmMgaWYgb25saW5lXG4gICAgICAgICAgICBjb25zdCBvbmxpbmUgPSBhd2FpdCBpc09ubGluZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgaXNPbmxpbmU6IG9ubGluZSB9KTtcblxuICAgICAgICAgICAgaWYgKG9ubGluZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCB1cCBjb25uZWN0aXZpdHkgbW9uaXRvcmluZ1xuICAgICAgICAgICAgdGhpcy5zdGFydENvbm5lY3Rpdml0eU1vbml0b3JpbmcoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBzeW5jIHNlcnZpY2U6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHJlYWwtdGltZSBzeW5jaHJvbml6YXRpb24gZm9yIGEgdXNlcidzIGhhYml0IGRhdGFcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjFcbiAgICAgKi9cbiAgICBhc3luYyBzdGFydFJlYWx0aW1lU3luYyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBJRCBpcyByZXF1aXJlZCBmb3Igc3luY1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0b3AgZXhpc3RpbmcgbGlzdGVuZXJzIGZvciB0aGlzIHVzZXJcbiAgICAgICAgdGhpcy5zdG9wUmVhbHRpbWVTeW5jKHVzZXJJZCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNldCB1cCBzdHJlYWsgZGF0YSBsaXN0ZW5lclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFrc0NvbGxlY3Rpb24gPSBnZXRIYWJpdFN0cmVha3NDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBzdHJlYWtMaXN0ZW5lciA9IG9uU25hcHNob3QoXG4gICAgICAgICAgICAgICAgc3RyZWFrc0NvbGxlY3Rpb24sXG4gICAgICAgICAgICAgICAgKHNuYXBzaG90KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKGFzeW5jIChjaGFuZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha0RhdGEgPSBjaGFuZ2UuZG9jLmRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJlYWtEYXRhLnVzZXJJZCA9PT0gdXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVSZWFsdGltZVN0cmVha1VwZGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLmRvYy5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFrRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlN0cmVhayBzeW5jIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU3luY0Vycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gU2V0IHVwIGNvbXBsZXRpb24gZGF0YSBsaXN0ZW5lclxuICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbnNDb2xsZWN0aW9uID0gZ2V0SGFiaXRDb21wbGV0aW9uc0NvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25MaXN0ZW5lciA9IG9uU25hcHNob3QoXG4gICAgICAgICAgICAgICAgY29tcGxldGlvbnNDb2xsZWN0aW9uLFxuICAgICAgICAgICAgICAgIChzbmFwc2hvdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdC5kb2NDaGFuZ2VzKCkuZm9yRWFjaChhc3luYyAoY2hhbmdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uRGF0YSA9IGNoYW5nZS5kb2MuZGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRpb25EYXRhLnVzZXJJZCA9PT0gdXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVSZWFsdGltZUNvbXBsZXRpb25VcGRhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZS5kb2MuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25EYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQ29tcGxldGlvbiBzeW5jIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU3luY0Vycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gU3RvcmUgbGlzdGVuZXJzXG4gICAgICAgICAgICB0aGlzLnN5bmNMaXN0ZW5lcnMuc2V0KGBzdHJlYWtzXyR7dXNlcklkfWAsIHN0cmVha0xpc3RlbmVyKTtcbiAgICAgICAgICAgIHRoaXMuc3luY0xpc3RlbmVycy5zZXQoYGNvbXBsZXRpb25zXyR7dXNlcklkfWAsIGNvbXBsZXRpb25MaXN0ZW5lcik7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHN0YXJ0IHJlYWx0aW1lIHN5bmM6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3AgcmVhbC10aW1lIHN5bmNocm9uaXphdGlvbiBmb3IgYSB1c2VyXG4gICAgICovXG4gICAgc3RvcFJlYWx0aW1lU3luYyh1c2VySWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBzdHJlYWtLZXkgPSBgc3RyZWFrc18ke3VzZXJJZH1gO1xuICAgICAgICBjb25zdCBjb21wbGV0aW9uS2V5ID0gYGNvbXBsZXRpb25zXyR7dXNlcklkfWA7XG5cbiAgICAgICAgY29uc3Qgc3RyZWFrTGlzdGVuZXIgPSB0aGlzLnN5bmNMaXN0ZW5lcnMuZ2V0KHN0cmVha0tleSk7XG4gICAgICAgIGlmIChzdHJlYWtMaXN0ZW5lcikge1xuICAgICAgICAgICAgc3RyZWFrTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc3luY0xpc3RlbmVycy5kZWxldGUoc3RyZWFrS2V5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25MaXN0ZW5lciA9IHRoaXMuc3luY0xpc3RlbmVycy5nZXQoY29tcGxldGlvbktleSk7XG4gICAgICAgIGlmIChjb21wbGV0aW9uTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGNvbXBsZXRpb25MaXN0ZW5lcigpO1xuICAgICAgICAgICAgdGhpcy5zeW5jTGlzdGVuZXJzLmRlbGV0ZShjb21wbGV0aW9uS2V5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhY2hlIGRhdGEgbG9jYWxseSB3aXRoIGludGVncml0eSB2ZXJpZmljYXRpb25cbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjRcbiAgICAgKi9cbiAgICBhc3luYyBjYWNoZURhdGE8VD4oa2V5OiBzdHJpbmcsIGRhdGE6IFQsIHZlcnNpb246IG51bWJlciA9IDEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrc3VtID0gdGhpcy5nZW5lcmF0ZUNoZWNrc3VtKGRhdGEpO1xuICAgICAgICAgICAgY29uc3QgY2FjaGVkRGF0YTogQ2FjaGVkRGF0YTxUPiA9IHtcbiAgICAgICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogVGltZXN0YW1wLm5vdygpLFxuICAgICAgICAgICAgICAgIHZlcnNpb24sXG4gICAgICAgICAgICAgICAgY2hlY2tzdW0sXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KGNhY2hlZERhdGEpKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2FjaGUgZGF0YTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgLy8gRG9uJ3QgdGhyb3cgLSBjYWNoaW5nIGZhaWx1cmUgc2hvdWxkbid0IGJyZWFrIHRoZSBhcHBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGNhY2hlZCBkYXRhIHdpdGggaW50ZWdyaXR5IHZlcmlmaWNhdGlvblxuICAgICAqIFJlcXVpcmVtZW50czogMTAuNCwgMTIuNVxuICAgICAqL1xuICAgIGFzeW5jIGdldENhY2hlZERhdGE8VD4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZWRTdHJpbmcgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICAgICAgaWYgKCFjYWNoZWRTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2FjaGVkRGF0YTogQ2FjaGVkRGF0YTxUPiA9IEpTT04ucGFyc2UoY2FjaGVkU3RyaW5nKTtcblxuICAgICAgICAgICAgLy8gVmVyaWZ5IGRhdGEgaW50ZWdyaXR5XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZENoZWNrc3VtID0gdGhpcy5nZW5lcmF0ZUNoZWNrc3VtKGNhY2hlZERhdGEuZGF0YSk7XG4gICAgICAgICAgICBpZiAoY2FjaGVkRGF0YS5jaGVja3N1bSAhPT0gZXhwZWN0ZWRDaGVja3N1bSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhY2hlIGludGVncml0eSBjaGVjayBmYWlsZWQsIHJlbW92aW5nIGNvcnJ1cHRlZCBkYXRhXCIpO1xuICAgICAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjYWNoZWREYXRhLmRhdGE7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIGNhY2hlZCBkYXRhOlwiLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1ZXVlIG9wZXJhdGlvbiBmb3Igb2ZmbGluZSBzeW5jXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC40XG4gICAgICovXG4gICAgYXN5bmMgcXVldWVPcGVyYXRpb24oXG4gICAgICAgIG9wZXJhdGlvbjogT21pdDxTeW5jT3BlcmF0aW9uLCBcImlkXCIgfCBcInJldHJ5Q291bnRcIiB8IFwidGltZXN0YW1wXCI+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzeW5jT3A6IFN5bmNPcGVyYXRpb24gPSB7XG4gICAgICAgICAgICAuLi5vcGVyYXRpb24sXG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU9wZXJhdGlvbklkKCksXG4gICAgICAgICAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcC5ub3coKSxcbiAgICAgICAgICAgIHJldHJ5Q291bnQ6IDAsXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5zZXQoc3luY09wLmlkLCBzeW5jT3ApO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVQZW5kaW5nT3BlcmF0aW9ucygpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7XG4gICAgICAgICAgICBwZW5kaW5nT3BlcmF0aW9uczogdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5zaXplLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUcnkgdG8gcHJvY2VzcyBpbW1lZGlhdGVseSBpZiBvbmxpbmVcbiAgICAgICAgaWYgKHRoaXMuc3luY1N0YXR1cy5pc09ubGluZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzUGVuZGluZ09wZXJhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcGVuZGluZyBvcGVyYXRpb25zIHdoZW4gY29ubmVjdGlvbiBpcyByZXN0b3JlZFxuICAgICAqIFJlcXVpcmVtZW50czogMTAuNCwgMTAuNVxuICAgICAqL1xuICAgIGFzeW5jIHByb2Nlc3NQZW5kaW5nT3BlcmF0aW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuc3luY1N0YXR1cy5zeW5jSW5Qcm9ncmVzcyB8fCB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiB0cnVlIH0pO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBvcGVyYXRpb25zID0gQXJyYXkuZnJvbSh0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnZhbHVlcygpKS5zb3J0KFxuICAgICAgICAgICAgICAgIChhLCBiKSA9PiBhLnRpbWVzdGFtcC50b01pbGxpcygpIC0gYi50aW1lc3RhbXAudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3Qgb3BlcmF0aW9uIG9mIG9wZXJhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVPcGVyYXRpb24ob3BlcmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5kZWxldGUob3BlcmF0aW9uLmlkKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGV4ZWN1dGUgb3BlcmF0aW9uOlwiLCBlcnJvcik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSW5jcmVtZW50IHJldHJ5IGNvdW50XG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbi5yZXRyeUNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbi5sYXN0QXR0ZW1wdCA9IFRpbWVzdGFtcC5ub3coKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgb3BlcmF0aW9uIGlmIG1heCByZXRyaWVzIGV4Y2VlZGVkXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24ucmV0cnlDb3VudCA+PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJNYXggcmV0cmllcyBleGNlZWRlZCwgcmVtb3Zpbmcgb3BlcmF0aW9uOlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLmRlbGV0ZShvcGVyYXRpb24uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVQZW5kaW5nT3BlcmF0aW9ucygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHtcbiAgICAgICAgICAgICAgICBwZW5kaW5nT3BlcmF0aW9uczogdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5zaXplLFxuICAgICAgICAgICAgICAgIGxhc3RTeW5jOiBUaW1lc3RhbXAubm93KCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzeW5jIG9wZXJhdGlvbiB3aXRoIGF0b21pYyB1cGRhdGVzXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC4yXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlT3BlcmF0aW9uKG9wZXJhdGlvbjogU3luY09wZXJhdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgcmV0cnlXaXRoQmFja29mZihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgcnVuVHJhbnNhY3Rpb24oZGIsIGFzeW5jICh0cmFuc2FjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbXBsZXRpb25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZUNvbXBsZXRpb25PcGVyYXRpb24ob3BlcmF0aW9uLCB0cmFuc2FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cmVha1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU3RyZWFrT3BlcmF0aW9uKG9wZXJhdGlvbiwgdHJhbnNhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJtaWxlc3RvbmVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZU1pbGVzdG9uZU9wZXJhdGlvbihvcGVyYXRpb24sIHRyYW5zYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIG9wZXJhdGlvbiB0eXBlOiAke29wZXJhdGlvbi50eXBlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgcmVhbC10aW1lIHN0cmVhayB1cGRhdGVzIHdpdGggY29uZmxpY3QgcmVzb2x1dGlvblxuICAgICAqIFJlcXVpcmVtZW50czogMTAuMSwgMTAuNVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlUmVhbHRpbWVTdHJlYWtVcGRhdGUoXG4gICAgICAgIGRvY0lkOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IGFueSxcbiAgICAgICAgY2hhbmdlVHlwZTogXCJhZGRlZFwiIHwgXCJtb2RpZmllZFwiIHwgXCJyZW1vdmVkXCIsXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlVHlwZSA9PT0gXCJyZW1vdmVkXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZnJvbSBjYWNoZVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZUNhY2hlS2V5ID0gYCR7U3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5TVFJFQUtTfV8ke2RvY0lkfWA7XG4gICAgICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0ocmVtb3ZlQ2FjaGVLZXkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc3RyZWFrID0gdHJhbnNmb3JtRmlyZXN0b3JlVG9TdHJlYWsoZGF0YSk7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjb25mbGljdHMgd2l0aCBsb2NhbCBkYXRhXG4gICAgICAgICAgICBjb25zdCBjYWNoZUtleSA9IGAke1N5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLU31fJHtkb2NJZH1gO1xuICAgICAgICAgICAgY29uc3QgY2FjaGVkU3RyZWFrID0gYXdhaXQgdGhpcy5nZXRDYWNoZWREYXRhPEhhYml0U3RyZWFrPihjYWNoZUtleSk7XG5cbiAgICAgICAgICAgIGlmIChjYWNoZWRTdHJlYWsgJiYgdGhpcy5oYXNDb25mbGljdChjYWNoZWRTdHJlYWssIHN0cmVhaykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNvbHZlZFN0cmVhayA9IGF3YWl0IHRoaXMucmVzb2x2ZVN0cmVha0NvbmZsaWN0KFxuICAgICAgICAgICAgICAgICAgICBjYWNoZWRTdHJlYWssXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhayxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY2FjaGVEYXRhKGNhY2hlS2V5LCByZXNvbHZlZFN0cmVhayk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY2FjaGVEYXRhKGNhY2hlS2V5LCBzdHJlYWspO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGhhbmRsaW5nIHJlYWx0aW1lIHN0cmVhayB1cGRhdGU6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSByZWFsLXRpbWUgY29tcGxldGlvbiB1cGRhdGVzXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC4xXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVSZWFsdGltZUNvbXBsZXRpb25VcGRhdGUoXG4gICAgICAgIGRvY0lkOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IGFueSxcbiAgICAgICAgY2hhbmdlVHlwZTogXCJhZGRlZFwiIHwgXCJtb2RpZmllZFwiIHwgXCJyZW1vdmVkXCIsXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlVHlwZSA9PT0gXCJyZW1vdmVkXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVDYWNoZUtleSA9IGAke1N5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuQ09NUExFVElPTlN9XyR7ZG9jSWR9YDtcbiAgICAgICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShyZW1vdmVDYWNoZUtleSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uID0gdHJhbnNmb3JtRmlyZXN0b3JlVG9Db21wbGV0aW9uKGRvY0lkLCBkYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gYCR7U3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OU31fJHtkb2NJZH1gO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jYWNoZURhdGEoY2FjaGVLZXksIGNvbXBsZXRpb24pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGhhbmRsaW5nIHJlYWx0aW1lIGNvbXBsZXRpb24gdXBkYXRlOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNvbHZlIGNvbmZsaWN0cyB1c2luZyB0aW1lc3RhbXAgcHJpb3JpdHlcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJlc29sdmVTdHJlYWtDb25mbGljdChcbiAgICAgICAgbG9jYWxTdHJlYWs6IEhhYml0U3RyZWFrLFxuICAgICAgICByZW1vdGVTdHJlYWs6IEhhYml0U3RyZWFrLFxuICAgICk6IFByb21pc2U8SGFiaXRTdHJlYWs+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBzdHJlYWsgd2l0aCB0aGUgbW9zdCByZWNlbnQgbGFzdENvbXBsZXRpb25EYXRlXG4gICAgICAgIC8vIElmIGRhdGVzIGFyZSBlcXVhbCwgcHJlZmVyIHRoZSBvbmUgd2l0aCBoaWdoZXIgY3VycmVudFN0cmVha1xuXG4gICAgICAgIGlmICghbG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmIHJlbW90ZVN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGVTdHJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmICFyZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxTdHJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlICYmIHJlbW90ZVN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUpIHtcbiAgICAgICAgICAgIGlmIChsb2NhbFN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUgPiByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICBsb2NhbFN0cmVhay5sYXN0Q29tcGxldGlvbkRhdGUgPCByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlU3RyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBTYW1lIGRhdGUsIHVzZSBoaWdoZXIgc3RyZWFrXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RyZWFrLmN1cnJlbnRTdHJlYWsgPj0gcmVtb3RlU3RyZWFrLmN1cnJlbnRTdHJlYWtcbiAgICAgICAgICAgICAgICAgICAgPyBsb2NhbFN0cmVha1xuICAgICAgICAgICAgICAgICAgICA6IHJlbW90ZVN0cmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIHJlbW90ZSBpZiBubyBjbGVhciB3aW5uZXJcbiAgICAgICAgcmV0dXJuIHJlbW90ZVN0cmVhaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGVyZSdzIGEgY29uZmxpY3QgYmV0d2VlbiBsb2NhbCBhbmQgcmVtb3RlIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGhhc0NvbmZsaWN0KGxvY2FsOiBIYWJpdFN0cmVhaywgcmVtb3RlOiBIYWJpdFN0cmVhayk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgbG9jYWwuY3VycmVudFN0cmVhayAhPT0gcmVtb3RlLmN1cnJlbnRTdHJlYWsgfHxcbiAgICAgICAgICAgIGxvY2FsLmJlc3RTdHJlYWsgIT09IHJlbW90ZS5iZXN0U3RyZWFrIHx8XG4gICAgICAgICAgICBsb2NhbC5sYXN0Q29tcGxldGlvbkRhdGUgIT09IHJlbW90ZS5sYXN0Q29tcGxldGlvbkRhdGUgfHxcbiAgICAgICAgICAgIGxvY2FsLmZyZWV6ZXNBdmFpbGFibGUgIT09IHJlbW90ZS5mcmVlemVzQXZhaWxhYmxlIHx8XG4gICAgICAgICAgICBsb2NhbC5mcmVlemVzVXNlZCAhPT0gcmVtb3RlLmZyZWV6ZXNVc2VkXG4gICAgICAgICk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgY29tcGxldGlvbiBvcGVyYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21wbGV0aW9uT3BlcmF0aW9uKFxuICAgICAgICBvcGVyYXRpb246IFN5bmNPcGVyYXRpb24sXG4gICAgICAgIHRyYW5zYWN0aW9uOiBhbnksXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25zQ29sbGVjdGlvbiA9IGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uKCk7XG5cbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24uYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiY3JlYXRlXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGxldGlvblJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24pO1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnNldChjb21wbGV0aW9uUmVmLCB7XG4gICAgICAgICAgICAgICAgICAgIC4uLm9wZXJhdGlvbi5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVwZGF0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24sIG9wZXJhdGlvbi5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi51cGRhdGUodXBkYXRlUmVmLCB7XG4gICAgICAgICAgICAgICAgICAgIC4uLm9wZXJhdGlvbi5kYXRhLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImRlbGV0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGRlbGV0ZVJlZiA9IGRvYyhjb21wbGV0aW9uc0NvbGxlY3Rpb24sIG9wZXJhdGlvbi5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5kZWxldGUoZGVsZXRlUmVmKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgc3RyZWFrIG9wZXJhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVN0cmVha09wZXJhdGlvbihcbiAgICAgICAgb3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLFxuICAgICAgICB0cmFuc2FjdGlvbjogYW55LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzdHJlYWtzQ29sbGVjdGlvbiA9IGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24oKTtcbiAgICAgICAgY29uc3Qgc3RyZWFrSWQgPSBnZW5lcmF0ZVN0cmVha0lkKG9wZXJhdGlvbi51c2VySWQsIG9wZXJhdGlvbi5oYWJpdElkISk7XG4gICAgICAgIGNvbnN0IHN0cmVha1JlZiA9IGRvYyhzdHJlYWtzQ29sbGVjdGlvbiwgc3RyZWFrSWQpO1xuXG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiOlxuICAgICAgICAgICAgY2FzZSBcInVwZGF0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha0RhdGEgPSB0cmFuc2Zvcm1TdHJlYWtUb0ZpcmVzdG9yZShvcGVyYXRpb24uZGF0YSk7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uc2V0KHN0cmVha1JlZiwgc3RyZWFrRGF0YSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZGVsZXRlXCI6XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uZGVsZXRlKHN0cmVha1JlZik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIG1pbGVzdG9uZSBvcGVyYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVNaWxlc3RvbmVPcGVyYXRpb24oXG4gICAgICAgIG9wZXJhdGlvbjogU3luY09wZXJhdGlvbixcbiAgICAgICAgdHJhbnNhY3Rpb246IGFueSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gTWlsZXN0b25lIG9wZXJhdGlvbnMgYXJlIHR5cGljYWxseSBwYXJ0IG9mIHN0cmVhayB1cGRhdGVzXG4gICAgICAgIC8vIFRoaXMgaXMgYSBwbGFjZWhvbGRlciBmb3IgZnV0dXJlIG1pbGVzdG9uZS1zcGVjaWZpYyBvcGVyYXRpb25zXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRXhlY3V0aW5nIG1pbGVzdG9uZSBvcGVyYXRpb246XCIsIG9wZXJhdGlvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgY2hlY2tzdW0gZm9yIGRhdGEgaW50ZWdyaXR5XG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZUNoZWNrc3VtKGRhdGE6IGFueSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBsZXQgaGFzaCA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgICAgICBoYXNoID0gKGhhc2ggPDwgNSkgLSBoYXNoICsgY2hhcjtcbiAgICAgICAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDsgLy8gQ29udmVydCB0byAzMi1iaXQgaW50ZWdlclxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoYXNoLnRvU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG9wZXJhdGlvbiBJRFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVPcGVyYXRpb25JZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG9wXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIHBlbmRpbmcgb3BlcmF0aW9ucyB0byBzdG9yYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlUGVuZGluZ09wZXJhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBvcGVyYXRpb25zID0gQXJyYXkuZnJvbSh0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnZhbHVlcygpKTtcbiAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBvcGVyYXRpb25zLm1hcCgob3ApID0+ICh7XG4gICAgICAgICAgICAgICAgLi4ub3AsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBvcC50aW1lc3RhbXAudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICAgICBsYXN0QXR0ZW1wdDogb3AubGFzdEF0dGVtcHQ/LnRvTWlsbGlzKCksXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuUEVORElOR19PUFMsXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoc2VyaWFsaXplZCksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBzYXZlIHBlbmRpbmcgb3BlcmF0aW9uczpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBwZW5kaW5nIG9wZXJhdGlvbnMgZnJvbSBzdG9yYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkUGVuZGluZ09wZXJhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdG9yZWQgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlBFTkRJTkdfT1BTLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghc3RvcmVkKSByZXR1cm47XG5cbiAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBKU09OLnBhcnNlKHN0b3JlZCk7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLmNsZWFyKCk7XG5cbiAgICAgICAgICAgIG9wZXJhdGlvbnMuZm9yRWFjaCgob3A6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbjogU3luY09wZXJhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ub3AsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogVGltZXN0YW1wLmZyb21NaWxsaXMob3AudGltZXN0YW1wKSxcbiAgICAgICAgICAgICAgICAgICAgbGFzdEF0dGVtcHQ6IG9wLmxhc3RBdHRlbXB0XG4gICAgICAgICAgICAgICAgICAgICAgICA/IFRpbWVzdGFtcC5mcm9tTWlsbGlzKG9wLmxhc3RBdHRlbXB0KVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLnNldChvcGVyYXRpb24uaWQsIG9wZXJhdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBwZW5kaW5nIG9wZXJhdGlvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydCBjb25uZWN0aXZpdHkgbW9uaXRvcmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRDb25uZWN0aXZpdHlNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgICAgICAvLyBDaGVjayBjb25uZWN0aXZpdHkgZXZlcnkgMzAgc2Vjb25kc1xuICAgICAgICBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvbmxpbmUgPSBhd2FpdCBpc09ubGluZSgpO1xuICAgICAgICAgICAgY29uc3Qgd2FzT25saW5lID0gdGhpcy5zeW5jU3RhdHVzLmlzT25saW5lO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBpc09ubGluZTogb25saW5lIH0pO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSBqdXN0IGNhbWUgYmFjayBvbmxpbmUsIHByb2Nlc3MgcGVuZGluZyBvcGVyYXRpb25zXG4gICAgICAgICAgICBpZiAob25saW5lICYmICF3YXNPbmxpbmUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3Rpb24gcmVzdG9yZWQsIHByb2Nlc3NpbmcgcGVuZGluZyBvcGVyYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDMwMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgc3luYyBlcnJvcnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGhhbmRsZVN5bmNFcnJvcihlcnJvcjogYW55KTogdm9pZCB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTeW5jIGVycm9yOlwiLCBlcnJvcik7XG5cbiAgICAgICAgLy8gVXBkYXRlIHN5bmMgc3RhdHVzIGJhc2VkIG9uIGVycm9yIHR5cGVcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwidW5hdmFpbGFibGVcIiB8fCBlcnJvci5tZXNzYWdlPy5pbmNsdWRlcyhcIm5ldHdvcmtcIikpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IGlzT25saW5lOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzeW5jIHN0YXR1cyBhbmQgbm90aWZ5IGxpc3RlbmVyc1xuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlU3luY1N0YXR1cyh1cGRhdGVzOiBQYXJ0aWFsPFN5bmNTdGF0dXM+KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3luY1N0YXR1cyA9IHsgLi4udGhpcy5zeW5jU3RhdHVzLCAuLi51cGRhdGVzIH07XG5cbiAgICAgICAgLy8gTm90aWZ5IGFsbCBzdGF0dXMgY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuc3RhdHVzQ2FsbGJhY2tzLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuc3luY1N0YXR1cyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBzeW5jIHN0YXR1cyBjYWxsYmFjazpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmUgdG8gc3luYyBzdGF0dXMgdXBkYXRlc1xuICAgICAqL1xuICAgIG9uU3luY1N0YXR1c0NoYW5nZShjYWxsYmFjazogKHN0YXR1czogU3luY1N0YXR1cykgPT4gdm9pZCk6ICgpID0+IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXR1c0NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuXG4gICAgICAgIC8vIENhbGwgaW1tZWRpYXRlbHkgd2l0aCBjdXJyZW50IHN0YXR1c1xuICAgICAgICBjYWxsYmFjayh0aGlzLnN5bmNTdGF0dXMpO1xuXG4gICAgICAgIC8vIFJldHVybiB1bnN1YnNjcmliZSBmdW5jdGlvblxuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNDYWxsYmFja3MuZGVsZXRlKGNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBzeW5jIHN0YXR1c1xuICAgICAqL1xuICAgIGdldFN5bmNTdGF0dXMoKTogU3luY1N0YXR1cyB7XG4gICAgICAgIHJldHVybiB7IC4uLnRoaXMuc3luY1N0YXR1cyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcmNlIHN5bmMgYWxsIGRhdGEgZm9yIGEgdXNlclxuICAgICAqIFJlcXVpcmVtZW50czogMTAuMSwgMTAuM1xuICAgICAqL1xuICAgIGFzeW5jIGZvcmNlU3luY1VzZXJEYXRhKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5zeW5jU3RhdHVzLmlzT25saW5lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZm9yY2Ugc3luYyB3aGlsZSBvZmZsaW5lXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiB0cnVlIH0pO1xuXG4gICAgICAgICAgICAvLyBTeW5jIGFsbCBzdHJlYWsgZGF0YVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zeW5jVXNlclN0cmVha3ModXNlcklkKTtcblxuICAgICAgICAgICAgLy8gU3luYyBhbGwgY29tcGxldGlvbiBkYXRhXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN5bmNVc2VyQ29tcGxldGlvbnModXNlcklkKTtcblxuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgbGFzdFN5bmM6IFRpbWVzdGFtcC5ub3coKSB9KTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IHN5bmNJblByb2dyZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN5bmMgdXNlciBzdHJlYWtzIGZyb20gc2VydmVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzeW5jVXNlclN0cmVha3ModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc3RyZWFrc0NvbGxlY3Rpb24gPSBnZXRIYWJpdFN0cmVha3NDb2xsZWN0aW9uKCk7XG4gICAgICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIGZldGNoIGFsbCB1c2VyIHN0cmVha3MgYW5kIGNhY2hlIHRoZW1cbiAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiAtIGZ1bGwgaW1wbGVtZW50YXRpb24gd291bGQgaGFuZGxlIHBhZ2luYXRpb25cbiAgICAgICAgY29uc29sZS5sb2coXCJTeW5jaW5nIHN0cmVha3MgZm9yIHVzZXI6XCIsIHVzZXJJZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3luYyB1c2VyIGNvbXBsZXRpb25zIGZyb20gc2VydmVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzeW5jVXNlckNvbXBsZXRpb25zKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25zQ29sbGVjdGlvbiA9IGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uKCk7XG4gICAgICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIGZldGNoIGFsbCB1c2VyIGNvbXBsZXRpb25zIGFuZCBjYWNoZSB0aGVtXG4gICAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gLSBmdWxsIGltcGxlbWVudGF0aW9uIHdvdWxkIGhhbmRsZSBwYWdpbmF0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3luY2luZyBjb21wbGV0aW9ucyBmb3IgdXNlcjpcIiwgdXNlcklkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgY2FjaGVkIGRhdGFcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNhY2hlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLm11bHRpUmVtb3ZlKFtcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlNUUkVBS1MsXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5DT01QTEVUSU9OUyxcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlBFTkRJTkdfT1BTLFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuTEFTVF9TWU5DLFxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIHRoaXMucGVuZGluZ09wZXJhdGlvbnMuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7XG4gICAgICAgICAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IDAsXG4gICAgICAgICAgICAgICAgbGFzdFN5bmM6IG51bGwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2xlYXIgY2FjaGU6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHN5bmNTZXJ2aWNlID0gU3luY1NlcnZpY2UuZ2V0SW5zdGFuY2UoKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFPQSxJQUFBQSxlQUFBLEdBQUFDLE9BQUE7QUFFQSxJQUFBQyxjQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxhQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUFFQSxJQUFBSSxVQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxZQUFBLEdBQUFMLE9BQUE7QUFDQSxJQUFBTSxtQkFBQSxHQUFBTixPQUFBO0FBQWdKLElBdUNuSU8sV0FBVyxHQUFBQyxPQUFBLENBQUFELFdBQUE7RUFvQnBCLFNBQUFBLFlBQUEsRUFBc0I7SUFBQSxJQUFBRSxnQkFBQSxDQUFBQyxPQUFBLFFBQUFILFdBQUE7SUFBQSxLQWxCZEksYUFBYSxHQUE2QixJQUFJQyxHQUFHLENBQUMsQ0FBQztJQUFBLEtBQ25EQyxpQkFBaUIsR0FBK0IsSUFBSUQsR0FBRyxDQUFDLENBQUM7SUFBQSxLQUN6REUsVUFBVSxHQUFlO01BQzdCQyxRQUFRLEVBQUUsSUFBSTtNQUNkQyxRQUFRLEVBQUUsSUFBSTtNQUNkSCxpQkFBaUIsRUFBRSxDQUFDO01BQ3BCSSxjQUFjLEVBQUU7SUFDcEIsQ0FBQztJQUFBLEtBQ09DLGVBQWUsR0FBc0MsSUFBSUMsR0FBRyxDQUFDLENBQUM7SUFXbEUsSUFBSSxDQUFDQyxjQUFjLENBQUMsQ0FBQztFQUN6QjtFQUFDLFdBQUFDLGFBQUEsQ0FBQVgsT0FBQSxFQUFBSCxXQUFBO0lBQUFlLEdBQUE7SUFBQUMsS0FBQTtNQUFBLElBQUFDLGVBQUEsT0FBQUMsa0JBQUEsQ0FBQWYsT0FBQSxFQWFELGFBQThDO1FBQzFDLElBQUk7VUFFQSxNQUFNLElBQUksQ0FBQ2dCLHFCQUFxQixDQUFDLENBQUM7VUFHbEMsSUFBTUMsTUFBTSxTQUFTLElBQUFaLHVCQUFRLEVBQUMsQ0FBQztVQUMvQixJQUFJLENBQUNhLGdCQUFnQixDQUFD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