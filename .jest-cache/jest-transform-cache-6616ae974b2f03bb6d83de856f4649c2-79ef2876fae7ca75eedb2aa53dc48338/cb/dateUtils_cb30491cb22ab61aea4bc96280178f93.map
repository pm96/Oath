{"version":3,"names":["_firestore","require","getCurrentDateString","exports","timezone","arguments","length","undefined","now","Date","formatDateToString","date","formatter","Intl","DateTimeFormat","timeZone","year","month","day","format","parseDateString","dateString","_dateString$split$map","split","map","Number","_dateString$split$map2","_slicedToArray2","default","getUserTimezone","resolvedOptions","isTimestampInCurrentDay","timestamp","timestampDate","toDate","currentDateString","timestampDateString","areConsecutiveDays","date1","date2","d1","d2","diffTime","Math","abs","getTime","diffDays","ceil","getDaysDifference","startDate","endDate","start","end","generateDateRange","dates","current","push","setDate","getDate","getDateNDaysAgo","days","getDateNDaysFromNow","isToday","today","getDayOfWeek","getDay","getDayName","toLocaleDateString","weekday","isValidDateString","regex","test","isNaN","getCalendarDateRange","timestampToDateString","createTimestampFromDateTime","timeString","_dateString$split$map3","_dateString$split$map4","_timeString$split$map","_timeString$split$map2","hours","minutes","setFullYear","setHours","Timestamp","fromDate","getHoursUntilEndOfDay","endOfDay","hour12","hour","minute","diffMs","max"],"sources":["dateUtils.ts"],"sourcesContent":["import { Timestamp } from \"firebase/firestore\";\n\n/**\n * Date utility functions for habit tracking with timezone awareness\n */\n\n/**\n * Get the current date in YYYY-MM-DD format for a specific timezone\n */\nexport const getCurrentDateString = (timezone: string = \"UTC\"): string => {\n    const now = new Date();\n    return formatDateToString(now, timezone);\n};\n\n/**\n * Format a Date object to YYYY-MM-DD string in a specific timezone\n */\nexport const formatDateToString = (\n    date: Date,\n    timezone: string = \"UTC\",\n): string => {\n    const formatter = new Intl.DateTimeFormat(\"en-CA\", {\n        timeZone: timezone,\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\",\n    });\n\n    return formatter.format(date);\n};\n\n/**\n * Parse a YYYY-MM-DD string to a Date object\n */\nexport const parseDateString = (dateString: string): Date => {\n    const [year, month, day] = dateString.split(\"-\").map(Number);\n    return new Date(year, month - 1, day);\n};\n\n/**\n * Get the user's current timezone\n */\nexport const getUserTimezone = (): string => {\n    return Intl.DateTimeFormat().resolvedOptions().timeZone;\n};\n\n/**\n * Check if a timestamp is within the current day in a specific timezone\n */\nexport const isTimestampInCurrentDay = (\n    timestamp: Timestamp,\n    timezone: string,\n): boolean => {\n    const timestampDate = timestamp.toDate();\n    const currentDateString = getCurrentDateString(timezone);\n    const timestampDateString = formatDateToString(timestampDate, timezone);\n\n    return currentDateString === timestampDateString;\n};\n\n/**\n * Check if two dates are consecutive days\n */\nexport const areConsecutiveDays = (date1: string, date2: string): boolean => {\n    const d1 = parseDateString(date1);\n    const d2 = parseDateString(date2);\n\n    const diffTime = Math.abs(d2.getTime() - d1.getTime());\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n    return diffDays === 1;\n};\n\n/**\n * Get the difference in days between two date strings\n */\nexport const getDaysDifference = (\n    startDate: string,\n    endDate: string,\n): number => {\n    const start = parseDateString(startDate);\n    const end = parseDateString(endDate);\n\n    const diffTime = end.getTime() - start.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n};\n\n/**\n * Generate an array of date strings for a given range\n */\nexport const generateDateRange = (\n    startDate: string,\n    endDate: string,\n): string[] => {\n    const dates: string[] = [];\n    const start = parseDateString(startDate);\n    const end = parseDateString(endDate);\n\n    const current = new Date(start);\n    while (current <= end) {\n        dates.push(formatDateToString(current));\n        current.setDate(current.getDate() + 1);\n    }\n\n    return dates;\n};\n\n/**\n * Get the date string for N days ago from today\n */\nexport const getDateNDaysAgo = (\n    days: number,\n    timezone: string = \"UTC\",\n): string => {\n    const date = new Date();\n    date.setDate(date.getDate() - days);\n    return formatDateToString(date, timezone);\n};\n\n/**\n * Get the date string for N days from today\n */\nexport const getDateNDaysFromNow = (\n    days: number,\n    timezone: string = \"UTC\",\n): string => {\n    const date = new Date();\n    date.setDate(date.getDate() + days);\n    return formatDateToString(date, timezone);\n};\n\n/**\n * Check if a date string represents today in a specific timezone\n */\nexport const isToday = (dateString: string, timezone: string): boolean => {\n    const today = getCurrentDateString(timezone);\n    return dateString === today;\n};\n\n/**\n * Get the day of the week for a date string (0 = Sunday, 6 = Saturday)\n */\nexport const getDayOfWeek = (dateString: string): number => {\n    const date = parseDateString(dateString);\n    return date.getDay();\n};\n\n/**\n * Get the day name for a date string\n */\nexport const getDayName = (dateString: string): string => {\n    const date = parseDateString(dateString);\n    return date.toLocaleDateString(\"en-US\", { weekday: \"long\" });\n};\n\n/**\n * Validate if a string is in YYYY-MM-DD format\n */\nexport const isValidDateString = (dateString: string): boolean => {\n    const regex = /^\\d{4}-\\d{2}-\\d{2}$/;\n    if (!regex.test(dateString)) {\n        return false;\n    }\n\n    const date = parseDateString(dateString);\n    return !isNaN(date.getTime());\n};\n\n/**\n * Get the start and end dates for a calendar view (90 days)\n */\nexport const getCalendarDateRange = (\n    timezone: string = \"UTC\",\n): { start: string; end: string } => {\n    const end = getCurrentDateString(timezone);\n    const start = getDateNDaysAgo(89, timezone); // 90 days total including today\n\n    return { start, end };\n};\n\n/**\n * Convert Firestore Timestamp to date string in timezone\n */\nexport const timestampToDateString = (\n    timestamp: Timestamp,\n    timezone: string,\n): string => {\n    return formatDateToString(timestamp.toDate(), timezone);\n};\n\n/**\n * Create a Firestore Timestamp from a date string and time\n */\nexport const createTimestampFromDateTime = (\n    dateString: string,\n    timeString: string,\n    timezone: string,\n): Timestamp => {\n    const [year, month, day] = dateString.split(\"-\").map(Number);\n    const [hours, minutes] = timeString.split(\":\").map(Number);\n\n    // Create date in the specified timezone\n    const date = new Date();\n    date.setFullYear(year, month - 1, day);\n    date.setHours(hours, minutes, 0, 0);\n\n    return Timestamp.fromDate(date);\n};\n\n/**\n * Get the time remaining until end of day in a timezone (in hours)\n */\nexport const getHoursUntilEndOfDay = (timezone: string): number => {\n    const now = new Date();\n    const endOfDay = new Date();\n\n    // Set to end of day in the specified timezone\n    const formatter = new Intl.DateTimeFormat(\"en-US\", {\n        timeZone: timezone,\n        hour12: false,\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n    });\n\n    endOfDay.setHours(23, 59, 59, 999);\n\n    const diffMs = endOfDay.getTime() - now.getTime();\n    return Math.max(0, diffMs / (1000 * 60 * 60));\n};\n"],"mappings":"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","ignoreList":[]}