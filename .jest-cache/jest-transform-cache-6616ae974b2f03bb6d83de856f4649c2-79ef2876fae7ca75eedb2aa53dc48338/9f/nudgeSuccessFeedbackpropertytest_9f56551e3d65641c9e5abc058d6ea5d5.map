{"version":3,"names":["_getJestObj","mock","showSuccessToast","mockShowSuccessToast","showErrorToast","mockShowErrorToast","sendNudge","mockSendNudge","_interopRequireWildcard","require","default","_interopRequireDefault","_asyncToGenerator2","fc","_require","jest","fn","describe","beforeEach","clearAllMocks","it","assert","asyncProperty","record","goalId","string","minLength","maxLength","friendId","friendName","_ref3","_ref2","mockClear","mockResolvedValue","undefined","sortedGoals","id","ownerName","goal","find","g","foundFriendName","expect","toHaveBeenCalledTimes","toHaveBeenCalledWith","_x","apply","arguments","numRuns","differentGoalId","_ref6","_ref5","pre","_x2","errorMessage","_ref9","_ref8","mockRejectedValue","Error","error","message","not","toHaveBeenCalled","_x3"],"sources":["nudgeSuccessFeedback.property.test.ts"],"sourcesContent":["/**\n * Property-Based Tests for Nudge Success Feedback\n * Feature: social-nudging-feed\n */\n\nimport * as fc from \"fast-check\";\n\n// Mock the toast utility\nconst mockShowSuccessToast = jest.fn();\nconst mockShowErrorToast = jest.fn();\njest.mock(\"@/utils/toast\", () => ({\n  showSuccessToast: mockShowSuccessToast,\n  showErrorToast: mockShowErrorToast,\n}));\n\n// Mock the nudge service\nconst mockSendNudge = jest.fn();\njest.mock(\"@/services/firebase/nudgeService\", () => ({\n  sendNudge: mockSendNudge,\n}));\n\ndescribe(\"Nudge Success Feedback Property-Based Tests\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  /**\n   * **Feature: social-nudging-feed, Property 11: Nudge success feedback**\n   * **Validates: Requirements 3.5**\n   */\n  describe(\"Property 11: Nudge success feedback\", () => {\n    it(\"should display success toast with friend name for any successful nudge\", async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.record({\n            goalId: fc.string({ minLength: 1, maxLength: 50 }),\n            friendId: fc.string({ minLength: 1, maxLength: 50 }),\n            friendName: fc.string({ minLength: 1, maxLength: 100 }),\n          }),\n          async ({ goalId, friendId, friendName }) => {\n            // Clear mocks for each property test run\n            mockShowSuccessToast.mockClear();\n            mockSendNudge.mockClear();\n\n            // Mock successful nudge sending\n            mockSendNudge.mockResolvedValue(undefined);\n\n            // Simulate the handleNudge function logic from FriendsFeed\n            const sortedGoals = [{ id: goalId, ownerName: friendName }];\n\n            // Execute nudge logic\n            await mockSendNudge(goalId, friendId);\n            const goal = sortedGoals.find((g) => g.id === goalId);\n            const foundFriendName = goal?.ownerName || \"friend\";\n            mockShowSuccessToast(`Nudge sent to ${foundFriendName}! ðŸ‘Š`);\n\n            // Property: For any successful nudge send, a success toast should display\n            // with the message \"Nudge sent to [Friend Name]!\"\n            expect(mockShowSuccessToast).toHaveBeenCalledTimes(1);\n            expect(mockShowSuccessToast).toHaveBeenCalledWith(\n              `Nudge sent to ${friendName}! ðŸ‘Š`,\n            );\n\n            // Verify the nudge service was called\n            expect(mockSendNudge).toHaveBeenCalledWith(goalId, friendId);\n          },\n        ),\n        { numRuns: 20 },\n      );\n    });\n\n    it(\"should display success toast with fallback name when friend name is not found\", async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.record({\n            goalId: fc.string({ minLength: 1, maxLength: 50 }),\n            friendId: fc.string({ minLength: 1, maxLength: 50 }),\n            differentGoalId: fc.string({ minLength: 1, maxLength: 50 }),\n          }),\n          async ({ goalId, friendId, differentGoalId }) => {\n            // Ensure the goal IDs are different\n            fc.pre(goalId !== differentGoalId);\n\n            // Clear mocks for each property test run\n            mockShowSuccessToast.mockClear();\n            mockSendNudge.mockClear();\n\n            // Mock successful nudge sending\n            mockSendNudge.mockResolvedValue(undefined);\n\n            // Mock sorted goals that don't contain the target goal\n            const sortedGoals = [\n              { id: differentGoalId, ownerName: \"Some Other Friend\" },\n            ];\n\n            // Execute nudge logic\n            await mockSendNudge(goalId, friendId);\n            const goal = sortedGoals.find((g) => g.id === goalId);\n            const foundFriendName = goal?.ownerName || \"friend\";\n            mockShowSuccessToast(`Nudge sent to ${foundFriendName}! ðŸ‘Š`);\n\n            // Property: When friend name is not found, should use fallback \"friend\"\n            expect(mockShowSuccessToast).toHaveBeenCalledTimes(1);\n            expect(mockShowSuccessToast).toHaveBeenCalledWith(\n              \"Nudge sent to friend! ðŸ‘Š\",\n            );\n\n            // Verify the nudge service was called\n            expect(mockSendNudge).toHaveBeenCalledWith(goalId, friendId);\n          },\n        ),\n        { numRuns: 20 },\n      );\n    });\n\n    it(\"should not display success toast when nudge sending fails\", async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.record({\n            goalId: fc.string({ minLength: 1, maxLength: 50 }),\n            friendId: fc.string({ minLength: 1, maxLength: 50 }),\n            errorMessage: fc.string({ minLength: 1, maxLength: 200 }),\n          }),\n          async ({ goalId, friendId, errorMessage }) => {\n            // Clear mocks for each property test run\n            mockShowSuccessToast.mockClear();\n            mockShowErrorToast.mockClear();\n            mockSendNudge.mockClear();\n\n            // Mock failed nudge sending\n            mockSendNudge.mockRejectedValue(new Error(errorMessage));\n\n            // Execute nudge logic with error handling\n            try {\n              await mockSendNudge(goalId, friendId);\n              mockShowSuccessToast(\"This should not be called\");\n            } catch (error) {\n              mockShowErrorToast(\n                error instanceof Error ? error.message : \"Failed to send nudge\",\n              );\n            }\n\n            // Property: Success toast should NOT be displayed when nudge fails\n            expect(mockShowSuccessToast).not.toHaveBeenCalled();\n\n            // Error toast should be displayed instead\n            expect(mockShowErrorToast).toHaveBeenCalledTimes(1);\n            expect(mockShowErrorToast).toHaveBeenCalledWith(errorMessage);\n          },\n        ),\n        { numRuns: 20 },\n      );\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}