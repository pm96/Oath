{"version":3,"names":["_asyncStorage","_interopRequireDefault","require","_firestore","_firebaseConfig","SecurityAuditService","exports","_classCallCheck2","default","_createClass2","key","value","_createAuditEntry","_asyncToGenerator2","userId","eventType","entityType","entityId","details","riskLevel","calculateRiskLevel","auditId","Date","now","Math","random","toString","substr","sanitizedDetails","sanitizeAuditDetails","auditEntry","id","timestamp","Timestamp","resolved","storeAuditEntryRemote","storeAuditEntryLocal","analyzeSuspiciousPatterns","console","log","toUpperCase","action","alertHighRiskEvent","error","createAuditEntry","_x","_x2","_x3","_x4","_x5","apply","arguments","_detectSuspiciousActivity","recentCompletions","recentStreaks","patterns","riskScore","recentCount","filter","c","completedAt","toMillis","length","push","timestamps","map","uniqueTimestamps","Set","size","unrealisticStreaks","s","currentStreak","milestones","sortedByCreation","_toConsumableArray2","sort","a","b","retroactiveCount","completion","index","prevCompletion","timezones","timezone","recommendedAction","suspiciousFlags","metadata","completionsAnalyzed","streaksAnalyzed","updateSuspiciousPattern","isSuspicious","detectSuspiciousActivity","_x6","_x7","_x8","_getSecurityMetrics","_this","timeRange","undefined","auditLogs","getLocalAuditLogs","cutoffTime","getCutoffTime","recentLogs","suspiciousActivities","highRiskEvents","unresolvedIncidents","userRiskMap","Map","forEach","current","get","incidentCount","riskPoints","getRiskPoints","set","topRiskUsers","Array","from","entries","_ref","_ref2","_slicedToArray2","data","Object","assign","slice","violationMap","violation","commonViolations","_ref3","_ref4","type","count","totalAuditEntries","getSecurityMetrics","_getUserAuditLogs","limit","getUserAuditLogs","_x9","_clearAuditLogs","AsyncStorage","removeItem","LOCAL_AUDIT_KEY","clearAuditLogs","_storeAuditEntryRemote","entry","auditRef","doc","db","AUDIT_COLLECTION","setDoc","serverTimestamp","_x0","_storeAuditEntryLocal","existingLogs","MAX_LOCAL_ENTRIES","splice","setItem","JSON","stringify","_x1","_getLocalAuditLogs","logsData","getItem","parse","_analyzeSuspiciousPatterns","_x10","_x11","_x12","_alertHighRiskEvent","warn","_x13","sanitizeValue","isArray","sanitizedArray","item","keys","reduce","acc","_ref5","_ref6","val","sanitized","_updateSuspiciousPattern","_x14","_x15","_x16","SUSPICIOUS_PATTERNS_COLLECTION","securityAuditService"],"sources":["securityAuditService.ts"],"sourcesContent":["/**\n * Security Audit Service\n *\n * Handles audit logging, suspicious activity detection, and security monitoring\n * Requirements: 12.5\n */\n\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { doc, serverTimestamp, setDoc, Timestamp } from \"firebase/firestore\";\nimport { db } from \"../../firebaseConfig\";\nimport { HabitCompletion, HabitStreak } from \"../../types/habit-streaks\";\n\n/**\n * Audit event types\n */\nexport type AuditEventType =\n    | \"completion_recorded\"\n    | \"completion_validation_failed\"\n    | \"streak_calculated\"\n    | \"streak_validation_failed\"\n    | \"streak_integrity_check_failed\"\n    | \"friend_accessed_streak\"\n    | \"friend_display_validation_failed\"\n    | \"streak_freeze_used\"\n    | \"suspicious_activity_detected\"\n    | \"data_integrity_violation\"\n    | \"unauthorized_access_attempt\";\n\n/**\n * Security risk levels\n */\nexport type SecurityRiskLevel = \"low\" | \"medium\" | \"high\" | \"critical\";\n\n/**\n * Audit log entry interface\n */\nexport interface SecurityAuditEntry {\n    id: string;\n    timestamp: Timestamp;\n    userId: string;\n    eventType: AuditEventType;\n    entityType: \"completion\" | \"streak\" | \"analytics\" | \"user\";\n    entityId: string;\n    riskLevel: SecurityRiskLevel;\n    details: {\n        action: string;\n        oldData?: any;\n        newData?: any;\n        validationErrors?: string[];\n        suspiciousFlags?: string[];\n        ipAddress?: string;\n        userAgent?: string;\n        friendId?: string;\n        metadata?: Record<string, any>;\n    };\n    resolved: boolean;\n    reviewedBy?: string;\n    reviewedAt?: Timestamp;\n    notes?: string;\n}\n\n/**\n * Suspicious activity pattern interface\n */\nexport interface SuspiciousActivityPattern {\n    userId: string;\n    patternType: string;\n    occurrences: number;\n    firstDetected: Timestamp;\n    lastDetected: Timestamp;\n    riskScore: number;\n    flags: string[];\n    autoBlocked: boolean;\n}\n\n/**\n * Security metrics interface\n */\nexport interface SecurityMetrics {\n    totalAuditEntries: number;\n    suspiciousActivities: number;\n    highRiskEvents: number;\n    unresolvedIncidents: number;\n    topRiskUsers: {\n        userId: string;\n        riskScore: number;\n        incidentCount: number;\n    }[];\n    commonViolations: {\n        type: string;\n        count: number;\n    }[];\n}\n\n/**\n * Security Audit Service Implementation\n */\nexport class SecurityAuditService {\n    private static readonly AUDIT_COLLECTION = \"securityAuditLogs\";\n    private static readonly SUSPICIOUS_PATTERNS_COLLECTION = \"suspiciousPatterns\";\n    private static readonly LOCAL_AUDIT_KEY = \"@security_audit_logs\";\n    private static readonly MAX_LOCAL_ENTRIES = 500;\n\n    /**\n     * Create a security audit log entry\n     * Requirements: 12.5\n     */\n    async createAuditEntry(\n        userId: string,\n        eventType: AuditEventType,\n        entityType: \"completion\" | \"streak\" | \"analytics\" | \"user\",\n        entityId: string,\n        details: {\n            action: string;\n            oldData?: any;\n            newData?: any;\n            validationErrors?: string[];\n            suspiciousFlags?: string[];\n            ipAddress?: string;\n            userAgent?: string;\n            friendId?: string;\n            metadata?: Record<string, any>;\n        },\n    ): Promise<void> {\n        try {\n            const riskLevel = this.calculateRiskLevel(eventType, details);\n            const auditId = `${userId}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\n            const sanitizedDetails = this.sanitizeAuditDetails(details);\n\n            const auditEntry: SecurityAuditEntry = {\n                id: auditId,\n                timestamp: Timestamp.now(),\n                userId,\n                eventType,\n                entityType,\n                entityId,\n                riskLevel,\n                details: sanitizedDetails,\n                resolved: riskLevel === \"low\",\n            };\n\n            // Store in Firestore for server-side analysis\n            await this.storeAuditEntryRemote(auditEntry);\n\n            // Store locally for immediate access\n            await this.storeAuditEntryLocal(auditEntry);\n\n            // Check for suspicious patterns\n            if (riskLevel !== \"low\") {\n                await this.analyzeSuspiciousPatterns(userId, eventType, details);\n            }\n\n            // Log to console for development\n            console.log(`SECURITY AUDIT [${riskLevel.toUpperCase()}]:`, {\n                userId,\n                eventType,\n                entityId,\n                action: details.action,\n            });\n\n            // Alert on high-risk events\n            if (riskLevel === \"high\" || riskLevel === \"critical\") {\n                await this.alertHighRiskEvent(auditEntry);\n            }\n        } catch (error) {\n            console.error(\"Failed to create audit entry:\", error);\n            // Don't throw - audit logging failure shouldn't block operations\n        }\n    }\n\n    /**\n     * Detect and log suspicious activity patterns\n     * Requirements: 12.5\n     */\n    async detectSuspiciousActivity(\n        userId: string,\n        recentCompletions: HabitCompletion[],\n        recentStreaks: HabitStreak[],\n    ): Promise<{\n        isSuspicious: boolean;\n        patterns: string[];\n        riskScore: number;\n        recommendedAction: \"monitor\" | \"warn\" | \"restrict\" | \"block\";\n    }> {\n        try {\n            const patterns: string[] = [];\n            let riskScore = 0;\n\n            // Pattern 1: Excessive completion frequency\n            const now = Date.now();\n            const recentCount = recentCompletions.filter(\n                (c) => now - c.completedAt.toMillis() < 60 * 60 * 1000, // Last hour\n            ).length;\n\n            if (recentCount > 15) {\n                patterns.push(\"Excessive completions in short timeframe\");\n                riskScore += 30;\n            } else if (recentCount > 8) {\n                patterns.push(\"High completion frequency\");\n                riskScore += 15;\n            }\n\n            // Pattern 2: Identical timestamps\n            const timestamps = recentCompletions.map((c) => c.completedAt.toMillis());\n            const uniqueTimestamps = new Set(timestamps);\n            if (uniqueTimestamps.size < timestamps.length * 0.8) {\n                patterns.push(\"Multiple completions with identical timestamps\");\n                riskScore += 25;\n            }\n\n            // Pattern 3: Unrealistic streak growth\n            const unrealisticStreaks = recentStreaks.filter(\n                (s) => s.currentStreak > 100 && s.milestones.length < 3,\n            );\n            if (unrealisticStreaks.length > 0) {\n                patterns.push(\"Unrealistic streak growth without milestones\");\n                riskScore += 40;\n            }\n\n            // Pattern 4: Retroactive completion pattern\n            const sortedByCreation = [...recentCompletions].sort(\n                (a, b) => a.completedAt.toMillis() - b.completedAt.toMillis(),\n            );\n            const retroactiveCount = sortedByCreation.filter((completion, index) => {\n                if (index === 0) return false;\n                const prevCompletion = sortedByCreation[index - 1];\n                return (\n                    completion.completedAt.toMillis() <\n                    prevCompletion.completedAt.toMillis()\n                );\n            }).length;\n\n            if (retroactiveCount > recentCompletions.length * 0.3) {\n                patterns.push(\"High percentage of retroactive completions\");\n                riskScore += 20;\n            }\n\n            // Pattern 5: Multiple timezone usage\n            const timezones = new Set(recentCompletions.map((c) => c.timezone));\n            if (timezones.size > 3) {\n                patterns.push(\"Completions from multiple timezones\");\n                riskScore += 15;\n            }\n\n            // Determine recommended action based on risk score\n            let recommendedAction: \"monitor\" | \"warn\" | \"restrict\" | \"block\";\n            if (riskScore >= 60) {\n                recommendedAction = \"block\";\n            } else if (riskScore >= 40) {\n                recommendedAction = \"restrict\";\n            } else if (riskScore >= 20) {\n                recommendedAction = \"warn\";\n            } else {\n                recommendedAction = \"monitor\";\n            }\n\n            // Log suspicious activity if detected\n            if (patterns.length > 0) {\n                await this.createAuditEntry(\n                    userId,\n                    \"suspicious_activity_detected\",\n                    \"user\",\n                    userId,\n                    {\n                        action: \"suspicious_pattern_analysis\",\n                        suspiciousFlags: patterns,\n                        metadata: {\n                            riskScore,\n                            recommendedAction,\n                            completionsAnalyzed: recentCompletions.length,\n                            streaksAnalyzed: recentStreaks.length,\n                        },\n                    },\n                );\n\n                // Update suspicious pattern tracking\n                await this.updateSuspiciousPattern(userId, patterns, riskScore);\n            }\n\n            return {\n                isSuspicious: patterns.length > 0,\n                patterns,\n                riskScore,\n                recommendedAction,\n            };\n        } catch (error) {\n            console.error(\"Error detecting suspicious activity:\", error);\n            return {\n                isSuspicious: false,\n                patterns: [],\n                riskScore: 0,\n                recommendedAction: \"monitor\",\n            };\n        }\n    }\n\n    /**\n     * Get security metrics for monitoring\n     */\n    async getSecurityMetrics(\n        timeRange: \"24h\" | \"7d\" | \"30d\" = \"24h\",\n    ): Promise<SecurityMetrics> {\n        try {\n            const auditLogs = await this.getLocalAuditLogs();\n            const cutoffTime = this.getCutoffTime(timeRange);\n\n            const recentLogs = auditLogs.filter(\n                (log) => log.timestamp.toMillis() >= cutoffTime,\n            );\n\n            const suspiciousActivities = recentLogs.filter(\n                (log) => log.eventType === \"suspicious_activity_detected\",\n            ).length;\n\n            const highRiskEvents = recentLogs.filter(\n                (log) => log.riskLevel === \"high\" || log.riskLevel === \"critical\",\n            ).length;\n\n            const unresolvedIncidents = recentLogs.filter(\n                (log) => !log.resolved && log.riskLevel !== \"low\",\n            ).length;\n\n            // Calculate top risk users\n            const userRiskMap = new Map<\n                string,\n                { riskScore: number; incidentCount: number }\n            >();\n            recentLogs.forEach((log) => {\n                if (log.riskLevel !== \"low\") {\n                    const current = userRiskMap.get(log.userId) || {\n                        riskScore: 0,\n                        incidentCount: 0,\n                    };\n                    const riskPoints = this.getRiskPoints(log.riskLevel);\n                    userRiskMap.set(log.userId, {\n                        riskScore: current.riskScore + riskPoints,\n                        incidentCount: current.incidentCount + 1,\n                    });\n                }\n            });\n\n            const topRiskUsers = Array.from(userRiskMap.entries())\n                .map(([userId, data]) => ({ userId, ...data }))\n                .sort((a, b) => b.riskScore - a.riskScore)\n                .slice(0, 10);\n\n            // Calculate common violations\n            const violationMap = new Map<string, number>();\n            recentLogs.forEach((log) => {\n                const violation = log.eventType;\n                violationMap.set(violation, (violationMap.get(violation) || 0) + 1);\n            });\n\n            const commonViolations = Array.from(violationMap.entries())\n                .map(([type, count]) => ({ type, count }))\n                .sort((a, b) => b.count - a.count)\n                .slice(0, 10);\n\n            return {\n                totalAuditEntries: recentLogs.length,\n                suspiciousActivities,\n                highRiskEvents,\n                unresolvedIncidents,\n                topRiskUsers,\n                commonViolations,\n            };\n        } catch (error) {\n            console.error(\"Error getting security metrics:\", error);\n            return {\n                totalAuditEntries: 0,\n                suspiciousActivities: 0,\n                highRiskEvents: 0,\n                unresolvedIncidents: 0,\n                topRiskUsers: [],\n                commonViolations: [],\n            };\n        }\n    }\n\n    /**\n     * Get audit logs for a specific user\n     */\n    async getUserAuditLogs(\n        userId: string,\n        limit: number = 50,\n    ): Promise<SecurityAuditEntry[]> {\n        try {\n            const auditLogs = await this.getLocalAuditLogs();\n            return auditLogs\n                .filter((log) => log.userId === userId)\n                .sort((a, b) => b.timestamp.toMillis() - a.timestamp.toMillis())\n                .slice(0, limit);\n        } catch (error) {\n            console.error(\"Error getting user audit logs:\", error);\n            return [];\n        }\n    }\n\n    /**\n     * Clear audit logs (for development/testing)\n     */\n    async clearAuditLogs(): Promise<void> {\n        try {\n            await AsyncStorage.removeItem(SecurityAuditService.LOCAL_AUDIT_KEY);\n            console.log(\"Audit logs cleared\");\n        } catch (error) {\n            console.error(\"Failed to clear audit logs:\", error);\n        }\n    }\n\n    // Private helper methods\n\n    /**\n     * Calculate risk level based on event type and details\n     */\n    private calculateRiskLevel(\n        eventType: AuditEventType,\n        details: any,\n    ): SecurityRiskLevel {\n        // Critical risk events\n        if (\n            eventType === \"unauthorized_access_attempt\" ||\n            eventType === \"data_integrity_violation\"\n        ) {\n            return \"critical\";\n        }\n\n        // High risk events\n        if (\n            eventType === \"suspicious_activity_detected\" ||\n            eventType === \"streak_validation_failed\" ||\n            eventType === \"completion_validation_failed\"\n        ) {\n            return \"high\";\n        }\n\n        // Medium risk events\n        if (\n            eventType === \"streak_integrity_check_failed\" ||\n            eventType === \"friend_display_validation_failed\" ||\n            (details.suspiciousFlags && details.suspiciousFlags.length > 0)\n        ) {\n            return \"medium\";\n        }\n\n        // Low risk (normal operations)\n        return \"low\";\n    }\n\n    /**\n     * Store audit entry in Firestore\n     */\n    private async storeAuditEntryRemote(\n        entry: SecurityAuditEntry,\n    ): Promise<void> {\n        try {\n            const auditRef = doc(\n                db,\n                `artifacts/oath-app/${SecurityAuditService.AUDIT_COLLECTION}`,\n                entry.id,\n            );\n            await setDoc(auditRef, {\n                ...entry,\n                timestamp: serverTimestamp(),\n            });\n        } catch (error) {\n            console.error(\"Failed to store audit entry remotely:\", error);\n        }\n    }\n\n    /**\n     * Store audit entry locally\n     */\n    private async storeAuditEntryLocal(entry: SecurityAuditEntry): Promise<void> {\n        try {\n            const existingLogs = await this.getLocalAuditLogs();\n            existingLogs.push(entry);\n\n            // Keep only recent entries\n            if (existingLogs.length > SecurityAuditService.MAX_LOCAL_ENTRIES) {\n                existingLogs.splice(\n                    0,\n                    existingLogs.length - SecurityAuditService.MAX_LOCAL_ENTRIES,\n                );\n            }\n\n            await AsyncStorage.setItem(\n                SecurityAuditService.LOCAL_AUDIT_KEY,\n                JSON.stringify(existingLogs),\n            );\n        } catch (error) {\n            console.error(\"Failed to store audit entry locally:\", error);\n        }\n    }\n\n    /**\n     * Get local audit logs\n     */\n    private async getLocalAuditLogs(): Promise<SecurityAuditEntry[]> {\n        try {\n            const logsData = await AsyncStorage.getItem(\n                SecurityAuditService.LOCAL_AUDIT_KEY,\n            );\n            return logsData ? JSON.parse(logsData) : [];\n        } catch (error) {\n            console.error(\"Failed to get local audit logs:\", error);\n            return [];\n        }\n    }\n\n    /**\n     * Analyze suspicious patterns for a user\n     */\n    private async analyzeSuspiciousPatterns(\n        userId: string,\n        eventType: AuditEventType,\n        details: any,\n    ): Promise<void> {\n        try {\n            // This would typically analyze patterns across multiple events\n            // For now, we'll just log the pattern detection\n            console.log(`Analyzing suspicious patterns for user ${userId}:`, {\n                eventType,\n                suspiciousFlags: details.suspiciousFlags,\n            });\n        } catch (error) {\n            console.error(\"Error analyzing suspicious patterns:\", error);\n        }\n    }\n\n    /**\n     * Alert on high-risk events\n     */\n    private async alertHighRiskEvent(entry: SecurityAuditEntry): Promise<void> {\n        try {\n            console.warn(`HIGH RISK SECURITY EVENT DETECTED:`, {\n                userId: entry.userId,\n                eventType: entry.eventType,\n                riskLevel: entry.riskLevel,\n                details: entry.details,\n            });\n\n            // In production, this would:\n            // 1. Send alert to security monitoring system\n            // 2. Notify security team\n            // 3. Potentially auto-restrict user actions\n            // 4. Create incident ticket\n        } catch (error) {\n            console.error(\"Error alerting high-risk event:\", error);\n        }\n    }\n\n    private sanitizeAuditDetails(\n        details: SecurityAuditEntry[\"details\"],\n    ): SecurityAuditEntry[\"details\"] {\n        const sanitizeValue = (value: any): any => {\n            if (Array.isArray(value)) {\n                const sanitizedArray = value\n                    .map((item) => sanitizeValue(item))\n                    .filter(\n                        (item) =>\n                            item !== undefined &&\n                            !(typeof item === \"object\" && Object.keys(item).length === 0),\n                    );\n                return sanitizedArray.length > 0 ? sanitizedArray : undefined;\n            }\n\n            if (value && typeof value === \"object\") {\n                const entries = Object.entries(value).reduce(\n                    (acc, [key, val]) => {\n                        const sanitized = sanitizeValue(val);\n                        if (sanitized !== undefined) {\n                            acc[key] = sanitized;\n                        }\n                        return acc;\n                    },\n                    {} as Record<string, any>,\n                );\n                return Object.keys(entries).length > 0 ? entries : undefined;\n            }\n\n            return value !== undefined ? value : undefined;\n        };\n\n        const sanitized = sanitizeValue(details);\n        return sanitized || { action: details.action };\n    }\n\n    /**\n     * Update suspicious pattern tracking\n     */\n    private async updateSuspiciousPattern(\n        userId: string,\n        patterns: string[],\n        riskScore: number,\n    ): Promise<void> {\n        try {\n            // This would update a tracking system for user risk patterns\n            console.log(`Updating suspicious pattern tracking for user ${userId}:`, {\n                patterns,\n                riskScore,\n            });\n        } catch (error) {\n            console.error(\"Error updating suspicious pattern:\", error);\n        }\n    }\n\n    /**\n     * Get cutoff time for metrics calculation\n     */\n    private getCutoffTime(timeRange: \"24h\" | \"7d\" | \"30d\"): number {\n        const now = Date.now();\n        switch (timeRange) {\n            case \"24h\":\n                return now - 24 * 60 * 60 * 1000;\n            case \"7d\":\n                return now - 7 * 24 * 60 * 60 * 1000;\n            case \"30d\":\n                return now - 30 * 24 * 60 * 60 * 1000;\n            default:\n                return now - 24 * 60 * 60 * 1000;\n        }\n    }\n\n    /**\n     * Get risk points for a risk level\n     */\n    private getRiskPoints(riskLevel: SecurityRiskLevel): number {\n        switch (riskLevel) {\n            case \"critical\":\n                return 50;\n            case \"high\":\n                return 25;\n            case \"medium\":\n                return 10;\n            case \"low\":\n                return 1;\n            default:\n                return 0;\n        }\n    }\n}\n\n// Export singleton instance\nexport const securityAuditService = new SecurityAuditService();\n"],"mappings":"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","ignoreList":[]}