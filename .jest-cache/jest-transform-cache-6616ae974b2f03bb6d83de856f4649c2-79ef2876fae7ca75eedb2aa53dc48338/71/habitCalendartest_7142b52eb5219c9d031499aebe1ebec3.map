{"version":3,"names":["_dateUtils","require","describe","timezone","getUserTimezone","createSampleCalendarDay","daysAgo","completed","arguments","length","undefined","date","Date","setDate","getDate","dateString","formatDateToString","isToday","isInStreak","completionTime","notes","it","today","expect","toBe","pastDay","toBeUndefined","streakDay","nonStreakDay","calendarData","i","push","Math","random","toHaveLength","prevDate","currDate","getTime","toBeGreaterThan","completedDays","filter","day","completionRate","round","currentStreak","completedDay","incompleteDay","dayWithDetails","toBeDefined"],"sources":["habitCalendar.test.ts"],"sourcesContent":["import { CalendarDay } from \"@/types/habit-streaks\";\nimport { formatDateToString, getUserTimezone } from \"@/utils/dateUtils\";\n\n/**\n * Unit tests for habit calendar functionality\n * Tests the core calendar data structures and utilities\n */\n\ndescribe(\"Habit Calendar\", () => {\n    const timezone = getUserTimezone();\n\n    const createSampleCalendarDay = (\n        daysAgo: number,\n        completed: boolean = false,\n    ): CalendarDay => {\n        const date = new Date();\n        date.setDate(date.getDate() - daysAgo);\n        const dateString = formatDateToString(date, timezone);\n\n        return {\n            date: dateString,\n            completed,\n            isToday: daysAgo === 0,\n            isInStreak: completed && daysAgo <= 3, // Last 3 days are in streak\n            completionTime: completed ? \"9:00 AM\" : undefined,\n            notes: completed ? \"Great workout!\" : undefined,\n        };\n    };\n\n    describe(\"CalendarDay data structure\", () => {\n        it(\"should create a valid calendar day for today\", () => {\n            const today = createSampleCalendarDay(0, true);\n\n            expect(today.isToday).toBe(true);\n            expect(today.completed).toBe(true);\n            expect(today.date).toBe(formatDateToString(new Date(), timezone));\n            expect(today.completionTime).toBe(\"9:00 AM\");\n            expect(today.notes).toBe(\"Great workout!\");\n        });\n\n        it(\"should create a valid calendar day for past date\", () => {\n            const pastDay = createSampleCalendarDay(5, false);\n\n            expect(pastDay.isToday).toBe(false);\n            expect(pastDay.completed).toBe(false);\n            expect(pastDay.completionTime).toBeUndefined();\n            expect(pastDay.notes).toBeUndefined();\n        });\n\n        it(\"should handle streak indicators correctly\", () => {\n            const streakDay = createSampleCalendarDay(2, true);\n            const nonStreakDay = createSampleCalendarDay(10, true);\n\n            expect(streakDay.isInStreak).toBe(true);\n            expect(nonStreakDay.isInStreak).toBe(false);\n        });\n    });\n\n    describe(\"Calendar data generation\", () => {\n        it(\"should generate 90 days of calendar data\", () => {\n            const calendarData: CalendarDay[] = [];\n\n            // Generate 90 days of sample data\n            for (let i = 89; i >= 0; i--) {\n                calendarData.push(createSampleCalendarDay(i, Math.random() > 0.5));\n            }\n\n            expect(calendarData).toHaveLength(90);\n            expect(calendarData[89].isToday).toBe(true); // Last item should be today\n        });\n\n        it(\"should maintain chronological order\", () => {\n            const calendarData: CalendarDay[] = [];\n\n            for (let i = 89; i >= 0; i--) {\n                calendarData.push(createSampleCalendarDay(i));\n            }\n\n            // Check that dates are in ascending order\n            for (let i = 1; i < calendarData.length; i++) {\n                const prevDate = new Date(calendarData[i - 1].date);\n                const currDate = new Date(calendarData[i].date);\n                expect(currDate.getTime()).toBeGreaterThan(prevDate.getTime());\n            }\n        });\n    });\n\n    describe(\"Calendar statistics\", () => {\n        it(\"should calculate completion rate correctly\", () => {\n            const calendarData: CalendarDay[] = [\n                createSampleCalendarDay(4, true),\n                createSampleCalendarDay(3, true),\n                createSampleCalendarDay(2, false),\n                createSampleCalendarDay(1, true),\n                createSampleCalendarDay(0, true),\n            ];\n\n            const completedDays = calendarData.filter((day) => day.completed).length;\n            const completionRate = Math.round(\n                (completedDays / calendarData.length) * 100,\n            );\n\n            expect(completedDays).toBe(4);\n            expect(completionRate).toBe(80);\n        });\n\n        it(\"should identify current streak correctly\", () => {\n            const calendarData: CalendarDay[] = [\n                createSampleCalendarDay(4, false),\n                createSampleCalendarDay(3, true),\n                createSampleCalendarDay(2, true),\n                createSampleCalendarDay(1, true),\n                createSampleCalendarDay(0, true),\n            ];\n\n            // Calculate current streak from the end\n            let currentStreak = 0;\n            for (let i = calendarData.length - 1; i >= 0; i--) {\n                if (calendarData[i].completed) {\n                    currentStreak++;\n                } else {\n                    break;\n                }\n            }\n\n            expect(currentStreak).toBe(4);\n        });\n    });\n\n    describe(\"Calendar display requirements\", () => {\n        it(\"should meet requirement 2.1 - display 90-day grid\", () => {\n            const calendarData: CalendarDay[] = [];\n            for (let i = 89; i >= 0; i--) {\n                calendarData.push(createSampleCalendarDay(i));\n            }\n\n            expect(calendarData).toHaveLength(90);\n        });\n\n        it(\"should meet requirement 2.2 - show completion indicators\", () => {\n            const completedDay = createSampleCalendarDay(1, true);\n            expect(completedDay.completed).toBe(true);\n        });\n\n        it(\"should meet requirement 2.3 - show incomplete indicators\", () => {\n            const incompleteDay = createSampleCalendarDay(1, false);\n            expect(incompleteDay.completed).toBe(false);\n        });\n\n        it(\"should meet requirement 2.4 - provide day interaction details\", () => {\n            const dayWithDetails = createSampleCalendarDay(1, true);\n            expect(dayWithDetails.completionTime).toBeDefined();\n            expect(dayWithDetails.notes).toBeDefined();\n        });\n\n        it(\"should meet requirement 2.5 - highlight streak periods\", () => {\n            const streakDay = createSampleCalendarDay(1, true);\n            expect(streakDay.isInStreak).toBe(true);\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}