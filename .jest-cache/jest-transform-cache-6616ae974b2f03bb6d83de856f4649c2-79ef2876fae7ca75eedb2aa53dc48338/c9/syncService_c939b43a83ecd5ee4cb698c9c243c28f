4cc3c563ced2d9871af2408c2b271729
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.syncService = exports.SyncService = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _firebaseConfig = require("../../firebaseConfig");
var _errorHandling = require("../../utils/errorHandling");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _firestore = require("firebase/firestore");
var _collections = require("./collections");
var _habitStreakSchemas = require("./habitStreakSchemas");
var SyncService = exports.SyncService = function () {
  function SyncService() {
    (0, _classCallCheck2.default)(this, SyncService);
    this.syncListeners = new Map();
    this.pendingOperations = new Map();
    this.syncStatus = {
      isOnline: true,
      lastSync: null,
      pendingOperations: 0,
      syncInProgress: false
    };
    this.statusCallbacks = new Set();
    this.initializeSync();
  }
  return (0, _createClass2.default)(SyncService, [{
    key: "initializeSync",
    value: (function () {
      var _initializeSync = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield this.loadPendingOperations();
          var online = yield (0, _errorHandling.isOnline)();
          this.updateSyncStatus({
            isOnline: online
          });
          if (online) {
            yield this.processPendingOperations();
          }
          this.startConnectivityMonitoring();
        } catch (error) {
          console.error("Failed to initialize sync service:", error);
        }
      });
      function initializeSync() {
        return _initializeSync.apply(this, arguments);
      }
      return initializeSync;
    }())
  }, {
    key: "startRealtimeSync",
    value: (function () {
      var _startRealtimeSync = (0, _asyncToGenerator2.default)(function* (userId) {
        var _this = this;
        if (!userId) {
          throw new Error("User ID is required for sync");
        }
        this.stopRealtimeSync(userId);
        try {
          var streaksCollection = (0, _collections.getHabitStreaksCollection)();
          var streaksQuery = (0, _firestore.query)(streaksCollection, (0, _firestore.where)("userId", "==", userId));
          var streakListener = (0, _firestore.onSnapshot)(streaksQuery, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref = (0, _asyncToGenerator2.default)(function* (change) {
                var streakData = change.doc.data();
                yield _this.handleRealtimeStreakUpdate(change.doc.id, streakData, change.type);
              });
              return function (_x2) {
                return _ref.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Streak sync error:", error);
            _this.handleSyncError(error);
          });
          var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
          var completionsQuery = (0, _firestore.query)(completionsCollection, (0, _firestore.where)("userId", "==", userId));
          var completionListener = (0, _firestore.onSnapshot)(completionsQuery, function (snapshot) {
            snapshot.docChanges().forEach(function () {
              var _ref2 = (0, _asyncToGenerator2.default)(function* (change) {
                var completionData = change.doc.data();
                yield _this.handleRealtimeCompletionUpdate(change.doc.id, completionData, change.type);
              });
              return function (_x3) {
                return _ref2.apply(this, arguments);
              };
            }());
          }, function (error) {
            console.error("Completion sync error:", error);
            _this.handleSyncError(error);
          });
          this.syncListeners.set(`streaks_${userId}`, streakListener);
          this.syncListeners.set(`completions_${userId}`, completionListener);
        } catch (error) {
          console.error("Failed to start realtime sync:", error);
          throw error;
        }
      });
      function startRealtimeSync(_x) {
        return _startRealtimeSync.apply(this, arguments);
      }
      return startRealtimeSync;
    }())
  }, {
    key: "stopRealtimeSync",
    value: function stopRealtimeSync(userId) {
      var streakKey = `streaks_${userId}`;
      var completionKey = `completions_${userId}`;
      var streakListener = this.syncListeners.get(streakKey);
      if (streakListener) {
        streakListener();
        this.syncListeners.delete(streakKey);
      }
      var completionListener = this.syncListeners.get(completionKey);
      if (completionListener) {
        completionListener();
        this.syncListeners.delete(completionKey);
      }
    }
  }, {
    key: "cacheData",
    value: (function () {
      var _cacheData = (0, _asyncToGenerator2.default)(function* (key, data) {
        var version = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
        try {
          var checksum = this.generateChecksum(data);
          var cachedData = {
            data: data,
            timestamp: _firestore.Timestamp.now(),
            version: version,
            checksum: checksum
          };
          yield _asyncStorage.default.setItem(key, JSON.stringify(cachedData));
        } catch (error) {
          console.error("Failed to cache data:", error);
        }
      });
      function cacheData(_x4, _x5) {
        return _cacheData.apply(this, arguments);
      }
      return cacheData;
    }())
  }, {
    key: "getCachedData",
    value: (function () {
      var _getCachedData = (0, _asyncToGenerator2.default)(function* (key) {
        try {
          var cachedString = yield _asyncStorage.default.getItem(key);
          if (!cachedString) {
            return null;
          }
          var cachedData = JSON.parse(cachedString);
          var expectedChecksum = this.generateChecksum(cachedData.data);
          if (cachedData.checksum !== expectedChecksum) {
            console.warn("Cache integrity check failed, removing corrupted data");
            yield _asyncStorage.default.removeItem(key);
            return null;
          }
          return cachedData.data;
        } catch (error) {
          console.error("Failed to retrieve cached data:", error);
          return null;
        }
      });
      function getCachedData(_x6) {
        return _getCachedData.apply(this, arguments);
      }
      return getCachedData;
    }())
  }, {
    key: "queueOperation",
    value: (function () {
      var _queueOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var syncOp = Object.assign({}, operation, {
          id: this.generateOperationId(),
          timestamp: _firestore.Timestamp.now(),
          retryCount: 0
        });
        this.pendingOperations.set(syncOp.id, syncOp);
        yield this.savePendingOperations();
        this.updateSyncStatus({
          pendingOperations: this.pendingOperations.size
        });
        if (this.syncStatus.isOnline) {
          yield this.processPendingOperations();
        }
      });
      function queueOperation(_x7) {
        return _queueOperation.apply(this, arguments);
      }
      return queueOperation;
    }())
  }, {
    key: "processPendingOperations",
    value: (function () {
      var _processPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        if (this.syncStatus.syncInProgress || this.pendingOperations.size === 0) {
          return;
        }
        this.updateSyncStatus({
          syncInProgress: true
        });
        try {
          var operations = Array.from(this.pendingOperations.values()).sort(function (a, b) {
            return a.timestamp.toMillis() - b.timestamp.toMillis();
          });
          for (var operation of operations) {
            try {
              yield this.executeOperation(operation);
              this.pendingOperations.delete(operation.id);
            } catch (error) {
              console.error("Failed to execute operation:", error);
              operation.retryCount++;
              operation.lastAttempt = _firestore.Timestamp.now();
              if (operation.retryCount >= 3) {
                console.warn("Max retries exceeded, removing operation:", operation.id);
                this.pendingOperations.delete(operation.id);
              }
            }
          }
          yield this.savePendingOperations();
          this.updateSyncStatus({
            pendingOperations: this.pendingOperations.size,
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function processPendingOperations() {
        return _processPendingOperations.apply(this, arguments);
      }
      return processPendingOperations;
    }())
  }, {
    key: "executeOperation",
    value: (function () {
      var _executeOperation = (0, _asyncToGenerator2.default)(function* (operation) {
        var _this2 = this;
        return yield (0, _errorHandling.retryWithBackoff)((0, _asyncToGenerator2.default)(function* () {
          return yield (0, _firestore.runTransaction)(_firebaseConfig.db, function () {
            var _ref4 = (0, _asyncToGenerator2.default)(function* (transaction) {
              switch (operation.type) {
                case "completion":
                  yield _this2.executeCompletionOperation(operation, transaction);
                  break;
                case "streak":
                  yield _this2.executeStreakOperation(operation, transaction);
                  break;
                case "milestone":
                  yield _this2.executeMilestoneOperation(operation, transaction);
                  break;
                default:
                  throw new Error(`Unknown operation type: ${operation.type}`);
              }
            });
            return function (_x9) {
              return _ref4.apply(this, arguments);
            };
          }());
        }));
      });
      function executeOperation(_x8) {
        return _executeOperation.apply(this, arguments);
      }
      return executeOperation;
    }())
  }, {
    key: "handleRealtimeStreakUpdate",
    value: (function () {
      var _handleRealtimeStreakUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            return;
          }
          var streak = (0, _habitStreakSchemas.transformFirestoreToStreak)(data);
          var cacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;
          var cachedStreak = yield this.getCachedData(cacheKey);
          if (cachedStreak && this.hasConflict(cachedStreak, streak)) {
            var resolvedStreak = yield this.resolveStreakConflict(cachedStreak, streak);
            yield this.cacheData(cacheKey, resolvedStreak);
          } else {
            yield this.cacheData(cacheKey, streak);
          }
        } catch (error) {
          console.error("Error handling realtime streak update:", error);
        }
      });
      function handleRealtimeStreakUpdate(_x0, _x1, _x10) {
        return _handleRealtimeStreakUpdate.apply(this, arguments);
      }
      return handleRealtimeStreakUpdate;
    }())
  }, {
    key: "handleRealtimeCompletionUpdate",
    value: (function () {
      var _handleRealtimeCompletionUpdate = (0, _asyncToGenerator2.default)(function* (docId, data, changeType) {
        try {
          if (changeType === "removed") {
            var removeCacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
            yield _asyncStorage.default.removeItem(removeCacheKey);
            return;
          }
          var completion = (0, _habitStreakSchemas.transformFirestoreToCompletion)(docId, data);
          var cacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;
          yield this.cacheData(cacheKey, completion);
        } catch (error) {
          console.error("Error handling realtime completion update:", error);
        }
      });
      function handleRealtimeCompletionUpdate(_x11, _x12, _x13) {
        return _handleRealtimeCompletionUpdate.apply(this, arguments);
      }
      return handleRealtimeCompletionUpdate;
    }())
  }, {
    key: "resolveStreakConflict",
    value: (function () {
      var _resolveStreakConflict = (0, _asyncToGenerator2.default)(function* (localStreak, remoteStreak) {
        if (!localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          return remoteStreak;
        }
        if (localStreak.lastCompletionDate && !remoteStreak.lastCompletionDate) {
          return localStreak;
        }
        if (localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {
          if (localStreak.lastCompletionDate > remoteStreak.lastCompletionDate) {
            return localStreak;
          } else if (localStreak.lastCompletionDate < remoteStreak.lastCompletionDate) {
            return remoteStreak;
          } else {
            return localStreak.currentStreak >= remoteStreak.currentStreak ? localStreak : remoteStreak;
          }
        }
        return remoteStreak;
      });
      function resolveStreakConflict(_x14, _x15) {
        return _resolveStreakConflict.apply(this, arguments);
      }
      return resolveStreakConflict;
    }())
  }, {
    key: "hasConflict",
    value: function hasConflict(local, remote) {
      return local.currentStreak !== remote.currentStreak || local.bestStreak !== remote.bestStreak || local.lastCompletionDate !== remote.lastCompletionDate || local.freezesAvailable !== remote.freezesAvailable || local.freezesUsed !== remote.freezesUsed;
    }
  }, {
    key: "executeCompletionOperation",
    value: (function () {
      var _executeCompletionOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
        switch (operation.action) {
          case "create":
            var completionRef = (0, _firestore.doc)(completionsCollection);
            transaction.set(completionRef, Object.assign({}, operation.data, {
              createdAt: (0, _firestore.serverTimestamp)()
            }));
            break;
          case "update":
            var updateRef = (0, _firestore.doc)(completionsCollection, operation.data.id);
            transaction.update(updateRef, Object.assign({}, operation.data, {
              updatedAt: (0, _firestore.serverTimestamp)()
            }));
            break;
          case "delete":
            var deleteRef = (0, _firestore.doc)(completionsCollection, operation.data.id);
            transaction.delete(deleteRef);
            break;
        }
      });
      function executeCompletionOperation(_x16, _x17) {
        return _executeCompletionOperation.apply(this, arguments);
      }
      return executeCompletionOperation;
    }())
  }, {
    key: "executeStreakOperation",
    value: (function () {
      var _executeStreakOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        var streaksCollection = (0, _collections.getHabitStreaksCollection)();
        var streakId = (0, _habitStreakSchemas.generateStreakId)(operation.userId, operation.habitId);
        var streakRef = (0, _firestore.doc)(streaksCollection, streakId);
        switch (operation.action) {
          case "create":
          case "update":
            var streakData = (0, _habitStreakSchemas.transformStreakToFirestore)(operation.data);
            transaction.set(streakRef, streakData);
            break;
          case "delete":
            transaction.delete(streakRef);
            break;
        }
      });
      function executeStreakOperation(_x18, _x19) {
        return _executeStreakOperation.apply(this, arguments);
      }
      return executeStreakOperation;
    }())
  }, {
    key: "executeMilestoneOperation",
    value: (function () {
      var _executeMilestoneOperation = (0, _asyncToGenerator2.default)(function* (operation, transaction) {
        console.log("Executing milestone operation:", operation);
      });
      function executeMilestoneOperation(_x20, _x21) {
        return _executeMilestoneOperation.apply(this, arguments);
      }
      return executeMilestoneOperation;
    }())
  }, {
    key: "generateChecksum",
    value: function generateChecksum(data) {
      var str = JSON.stringify(data);
      var hash = 0;
      for (var i = 0; i < str.length; i++) {
        var char = str.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash = hash & hash;
      }
      return hash.toString();
    }
  }, {
    key: "generateOperationId",
    value: function generateOperationId() {
      return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
  }, {
    key: "savePendingOperations",
    value: (function () {
      var _savePendingOperations = (0, _asyncToGenerator2.default)(function* () {
        try {
          var operations = Array.from(this.pendingOperations.values());
          var serialized = operations.map(function (op) {
            var _op$lastAttempt;
            return Object.assign({}, op, {
              timestamp: op.timestamp.toMillis(),
              lastAttempt: (_op$lastAttempt = op.lastAttempt) == null ? void 0 : _op$lastAttempt.toMillis()
            });
          });
          yield _asyncStorage.default.setItem(SyncService.CACHE_KEYS.PENDING_OPS, JSON.stringify(serialized));
        } catch (error) {
          console.error("Failed to save pending operations:", error);
        }
      });
      function savePendingOperations() {
        return _savePendingOperations.apply(this, arguments);
      }
      return savePendingOperations;
    }())
  }, {
    key: "loadPendingOperations",
    value: (function () {
      var _loadPendingOperations = (0, _asyncToGenerator2.default)(function* () {
        var _this3 = this;
        try {
          var stored = yield _asyncStorage.default.getItem(SyncService.CACHE_KEYS.PENDING_OPS);
          if (!stored) return;
          var operations = JSON.parse(stored);
          this.pendingOperations.clear();
          operations.forEach(function (op) {
            var operation = Object.assign({}, op, {
              timestamp: _firestore.Timestamp.fromMillis(op.timestamp),
              lastAttempt: op.lastAttempt ? _firestore.Timestamp.fromMillis(op.lastAttempt) : undefined
            });
            _this3.pendingOperations.set(operation.id, operation);
          });
        } catch (error) {
          console.error("Failed to load pending operations:", error);
        }
      });
      function loadPendingOperations() {
        return _loadPendingOperations.apply(this, arguments);
      }
      return loadPendingOperations;
    }())
  }, {
    key: "startConnectivityMonitoring",
    value: function startConnectivityMonitoring() {
      var _this4 = this;
      setInterval((0, _asyncToGenerator2.default)(function* () {
        var online = yield (0, _errorHandling.isOnline)();
        var wasOnline = _this4.syncStatus.isOnline;
        _this4.updateSyncStatus({
          isOnline: online
        });
        if (online && !wasOnline) {
          console.log("Connection restored, processing pending operations");
          yield _this4.processPendingOperations();
        }
      }), 30000);
    }
  }, {
    key: "handleSyncError",
    value: function handleSyncError(error) {
      var _error$message;
      console.error("Sync error:", error);
      if (error.code === "unavailable" || (_error$message = error.message) != null && _error$message.includes("network")) {
        this.updateSyncStatus({
          isOnline: false
        });
      }
    }
  }, {
    key: "updateSyncStatus",
    value: function updateSyncStatus(updates) {
      var _this5 = this;
      this.syncStatus = Object.assign({}, this.syncStatus, updates);
      this.statusCallbacks.forEach(function (callback) {
        try {
          callback(_this5.syncStatus);
        } catch (error) {
          console.error("Error in sync status callback:", error);
        }
      });
    }
  }, {
    key: "onSyncStatusChange",
    value: function onSyncStatusChange(callback) {
      var _this6 = this;
      this.statusCallbacks.add(callback);
      callback(this.syncStatus);
      return function () {
        _this6.statusCallbacks.delete(callback);
      };
    }
  }, {
    key: "getSyncStatus",
    value: function getSyncStatus() {
      return Object.assign({}, this.syncStatus);
    }
  }, {
    key: "forceSyncUserData",
    value: (function () {
      var _forceSyncUserData = (0, _asyncToGenerator2.default)(function* (userId) {
        if (!this.syncStatus.isOnline) {
          throw new Error("Cannot force sync while offline");
        }
        try {
          this.updateSyncStatus({
            syncInProgress: true
          });
          yield this.syncUserStreaks(userId);
          yield this.syncUserCompletions(userId);
          this.updateSyncStatus({
            lastSync: _firestore.Timestamp.now()
          });
        } finally {
          this.updateSyncStatus({
            syncInProgress: false
          });
        }
      });
      function forceSyncUserData(_x22) {
        return _forceSyncUserData.apply(this, arguments);
      }
      return forceSyncUserData;
    }())
  }, {
    key: "syncUserStreaks",
    value: (function () {
      var _syncUserStreaks = (0, _asyncToGenerator2.default)(function* (userId) {
        var streaksCollection = (0, _collections.getHabitStreaksCollection)();
        console.log("Syncing streaks for user:", userId);
      });
      function syncUserStreaks(_x23) {
        return _syncUserStreaks.apply(this, arguments);
      }
      return syncUserStreaks;
    }())
  }, {
    key: "syncUserCompletions",
    value: (function () {
      var _syncUserCompletions = (0, _asyncToGenerator2.default)(function* (userId) {
        var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
        console.log("Syncing completions for user:", userId);
      });
      function syncUserCompletions(_x24) {
        return _syncUserCompletions.apply(this, arguments);
      }
      return syncUserCompletions;
    }())
  }, {
    key: "clearCache",
    value: (function () {
      var _clearCache = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield _asyncStorage.default.multiRemove([SyncService.CACHE_KEYS.STREAKS, SyncService.CACHE_KEYS.COMPLETIONS, SyncService.CACHE_KEYS.PENDING_OPS, SyncService.CACHE_KEYS.LAST_SYNC]);
          this.pendingOperations.clear();
          this.updateSyncStatus({
            pendingOperations: 0,
            lastSync: null
          });
        } catch (error) {
          console.error("Failed to clear cache:", error);
        }
      });
      function clearCache() {
        return _clearCache.apply(this, arguments);
      }
      return clearCache;
    }())
  }], [{
    key: "getInstance",
    value: function getInstance() {
      if (!SyncService.instance) {
        SyncService.instance = new SyncService();
      }
      return SyncService.instance;
    }
  }]);
}();
SyncService.CACHE_KEYS = {
  STREAKS: "@habit_streaks_cache",
  COMPLETIONS: "@habit_completions_cache",
  PENDING_OPS: "@pending_sync_operations",
  LAST_SYNC: "@last_sync_timestamp"
};
var syncService = exports.syncService = SyncService.getInstance();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZmlyZWJhc2VDb25maWciLCJyZXF1aXJlIiwiX2Vycm9ySGFuZGxpbmciLCJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9maXJlc3RvcmUiLCJfY29sbGVjdGlvbnMiLCJfaGFiaXRTdHJlYWtTY2hlbWFzIiwiU3luY1NlcnZpY2UiLCJleHBvcnRzIiwiX2NsYXNzQ2FsbENoZWNrMiIsImRlZmF1bHQiLCJzeW5jTGlzdGVuZXJzIiwiTWFwIiwicGVuZGluZ09wZXJhdGlvbnMiLCJzeW5jU3RhdHVzIiwiaXNPbmxpbmUiLCJsYXN0U3luYyIsInN5bmNJblByb2dyZXNzIiwic3RhdHVzQ2FsbGJhY2tzIiwiU2V0IiwiaW5pdGlhbGl6ZVN5bmMiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJfaW5pdGlhbGl6ZVN5bmMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJsb2FkUGVuZGluZ09wZXJhdGlvbnMiLCJvbmxpbmUiLCJ1cGRhdGVTeW5jU3RhdHVzIiwicHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zIiwic3RhcnRDb25uZWN0aXZpdHlNb25pdG9yaW5nIiwiZXJyb3IiLCJjb25zb2xlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfc3RhcnRSZWFsdGltZVN5bmMiLCJ1c2VySWQiLCJfdGhpcyIsIkVycm9yIiwic3RvcFJlYWx0aW1lU3luYyIsInN0cmVha3NDb2xsZWN0aW9uIiwiZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbiIsInN0cmVha3NRdWVyeSIsInF1ZXJ5Iiwid2hlcmUiLCJzdHJlYWtMaXN0ZW5lciIsIm9uU25hcHNob3QiLCJzbmFwc2hvdCIsImRvY0NoYW5nZXMiLCJmb3JFYWNoIiwiX3JlZiIsImNoYW5nZSIsInN0cmVha0RhdGEiLCJkb2MiLCJkYXRhIiwiaGFuZGxlUmVhbHRpbWVTdHJlYWtVcGRhdGUiLCJpZCIsInR5cGUiLCJfeDIiLCJoYW5kbGVTeW5jRXJyb3IiLCJjb21wbGV0aW9uc0NvbGxlY3Rpb24iLCJnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbiIsImNvbXBsZXRpb25zUXVlcnkiLCJjb21wbGV0aW9uTGlzdGVuZXIiLCJfcmVmMiIsImNvbXBsZXRpb25EYXRhIiwiaGFuZGxlUmVhbHRpbWVDb21wbGV0aW9uVXBkYXRlIiwiX3gzIiwic2V0Iiwic3RhcnRSZWFsdGltZVN5bmMiLCJfeCIsInN0cmVha0tleSIsImNvbXBsZXRpb25LZXkiLCJnZXQiLCJkZWxldGUiLCJfY2FjaGVEYXRhIiwidmVyc2lvbiIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNoZWNrc3VtIiwiZ2VuZXJhdGVDaGVja3N1bSIsImNhY2hlZERhdGEiLCJ0aW1lc3RhbXAiLCJUaW1lc3RhbXAiLCJub3ciLCJBc3luY1N0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNhY2hlRGF0YSIsIl94NCIsIl94NSIsIl9nZXRDYWNoZWREYXRhIiwiY2FjaGVkU3RyaW5nIiwiZ2V0SXRlbSIsInBhcnNlIiwiZXhwZWN0ZWRDaGVja3N1bSIsIndhcm4iLCJyZW1vdmVJdGVtIiwiZ2V0Q2FjaGVkRGF0YSIsIl94NiIsIl9xdWV1ZU9wZXJhdGlvbiIsIm9wZXJhdGlvbiIsInN5bmNPcCIsIk9iamVjdCIsImFzc2lnbiIsImdlbmVyYXRlT3BlcmF0aW9uSWQiLCJyZXRyeUNvdW50Iiwic2F2ZVBlbmRpbmdPcGVyYXRpb25zIiwic2l6ZSIsInF1ZXVlT3BlcmF0aW9uIiwiX3g3IiwiX3Byb2Nlc3NQZW5kaW5nT3BlcmF0aW9ucyIsIm9wZXJhdGlvbnMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzb3J0IiwiYSIsImIiLCJ0b01pbGxpcyIsImV4ZWN1dGVPcGVyYXRpb24iLCJsYXN0QXR0ZW1wdCIsIl9leGVjdXRlT3BlcmF0aW9uIiwiX3RoaXMyIiwicmV0cnlXaXRoQmFja29mZiIsInJ1blRyYW5zYWN0aW9uIiwiZGIiLCJfcmVmNCIsInRyYW5zYWN0aW9uIiwiZXhlY3V0ZUNvbXBsZXRpb25PcGVyYXRpb24iLCJleGVjdXRlU3RyZWFrT3BlcmF0aW9uIiwiZXhlY3V0ZU1pbGVzdG9uZU9wZXJhdGlvbiIsIl94OSIsIl94OCIsIl9oYW5kbGVSZWFsdGltZVN0cmVha1VwZGF0ZSIsImRvY0lkIiwiY2hhbmdlVHlwZSIsInJlbW92ZUNhY2hlS2V5IiwiQ0FDSEVfS0VZUyIsIlNUUkVBS1MiLCJzdHJlYWsiLCJ0cmFuc2Zvcm1GaXJlc3RvcmVUb1N0cmVhayIsImNhY2hlS2V5IiwiY2FjaGVkU3RyZWFrIiwiaGFzQ29uZmxpY3QiLCJyZXNvbHZlZFN0cmVhayIsInJlc29sdmVTdHJlYWtDb25mbGljdCIsIl94MCIsIl94MSIsIl94MTAiLCJfaGFuZGxlUmVhbHRpbWVDb21wbGV0aW9uVXBkYXRlIiwiQ09NUExFVElPTlMiLCJjb21wbGV0aW9uIiwidHJhbnNmb3JtRmlyZXN0b3JlVG9Db21wbGV0aW9uIiwiX3gxMSIsIl94MTIiLCJfeDEzIiwiX3Jlc29sdmVTdHJlYWtDb25mbGljdCIsImxvY2FsU3RyZWFrIiwicmVtb3RlU3RyZWFrIiwibGFzdENvbXBsZXRpb25EYXRlIiwiY3VycmVudFN0cmVhayIsIl94MTQiLCJfeDE1IiwibG9jYWwiLCJyZW1vdGUiLCJiZXN0U3RyZWFrIiwiZnJlZXplc0F2YWlsYWJsZSIsImZyZWV6ZXNVc2VkIiwiX2V4ZWN1dGVDb21wbGV0aW9uT3BlcmF0aW9uIiwiYWN0aW9uIiwiY29tcGxldGlvblJlZiIsImNyZWF0ZWRBdCIsInNlcnZlclRpbWVzdGFtcCIsInVwZGF0ZVJlZiIsInVwZGF0ZSIsInVwZGF0ZWRBdCIsImRlbGV0ZVJlZiIsIl94MTYiLCJfeDE3IiwiX2V4ZWN1dGVTdHJlYWtPcGVyYXRpb24iLCJzdHJlYWtJZCIsImdlbmVyYXRlU3RyZWFrSWQiLCJoYWJpdElkIiwic3RyZWFrUmVmIiwidHJhbnNmb3JtU3RyZWFrVG9GaXJlc3RvcmUiLCJfeDE4IiwiX3gxOSIsIl9leGVjdXRlTWlsZXN0b25lT3BlcmF0aW9uIiwibG9nIiwiX3gyMCIsIl94MjEiLCJzdHIiLCJoYXNoIiwiaSIsImNoYXIiLCJjaGFyQ29kZUF0IiwidG9TdHJpbmciLCJEYXRlIiwiTWF0aCIsInJhbmRvbSIsInN1YnN0ciIsIl9zYXZlUGVuZGluZ09wZXJhdGlvbnMiLCJzZXJpYWxpemVkIiwibWFwIiwib3AiLCJfb3AkbGFzdEF0dGVtcHQiLCJQRU5ESU5HX09QUyIsIl9sb2FkUGVuZGluZ09wZXJhdGlvbnMiLCJfdGhpczMiLCJzdG9yZWQiLCJjbGVhciIsImZyb21NaWxsaXMiLCJfdGhpczQiLCJzZXRJbnRlcnZhbCIsIndhc09ubGluZSIsIl9lcnJvciRtZXNzYWdlIiwiY29kZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsInVwZGF0ZXMiLCJfdGhpczUiLCJjYWxsYmFjayIsIm9uU3luY1N0YXR1c0NoYW5nZSIsIl90aGlzNiIsImFkZCIsImdldFN5bmNTdGF0dXMiLCJfZm9yY2VTeW5jVXNlckRhdGEiLCJzeW5jVXNlclN0cmVha3MiLCJzeW5jVXNlckNvbXBsZXRpb25zIiwiZm9yY2VTeW5jVXNlckRhdGEiLCJfeDIyIiwiX3N5bmNVc2VyU3RyZWFrcyIsIl94MjMiLCJfc3luY1VzZXJDb21wbGV0aW9ucyIsIl94MjQiLCJfY2xlYXJDYWNoZSIsIm11bHRpUmVtb3ZlIiwiTEFTVF9TWU5DIiwiY2xlYXJDYWNoZSIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJzeW5jU2VydmljZSJdLCJzb3VyY2VzIjpbInN5bmNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGF0YSBTeW5jaHJvbml6YXRpb24gU2VydmljZVxuICpcbiAqIEhhbmRsZXMgY3Jvc3MtZGV2aWNlIGRhdGEgc3luY2hyb25pemF0aW9uLCBvZmZsaW5lIGNhY2hpbmcsIGFuZCBjb25mbGljdCByZXNvbHV0aW9uXG4gKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjIsIDEwLjMsIDEwLjQsIDEwLjVcbiAqL1xuXG5pbXBvcnQgeyBkYiB9IGZyb20gXCJAL2ZpcmViYXNlQ29uZmlnXCI7XG5pbXBvcnQgeyBIYWJpdFN0cmVhayB9IGZyb20gXCJAL3R5cGVzXCI7XG5pbXBvcnQgeyBpc09ubGluZSwgcmV0cnlXaXRoQmFja29mZiB9IGZyb20gXCJAL3V0aWxzL2Vycm9ySGFuZGxpbmdcIjtcbmltcG9ydCBBc3luY1N0b3JhZ2UgZnJvbSBcIkByZWFjdC1uYXRpdmUtYXN5bmMtc3RvcmFnZS9hc3luYy1zdG9yYWdlXCI7XG5pbXBvcnQgeyBVbnN1YnNjcmliZSB9IGZyb20gXCJmaXJlYmFzZS9hdXRoXCI7XG5pbXBvcnQge1xuICAgIFRpbWVzdGFtcCxcbiAgICBkb2MsXG4gICAgb25TbmFwc2hvdCxcbiAgICBxdWVyeSxcbiAgICBydW5UcmFuc2FjdGlvbixcbiAgICBzZXJ2ZXJUaW1lc3RhbXAsXG4gICAgd2hlcmUsXG59IGZyb20gXCJmaXJlYmFzZS9maXJlc3RvcmVcIjtcbmltcG9ydCB7XG4gICAgZ2V0SGFiaXRDb21wbGV0aW9uc0NvbGxlY3Rpb24sXG4gICAgZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbixcbn0gZnJvbSBcIi4vY29sbGVjdGlvbnNcIjtcbmltcG9ydCB7XG4gICAgZ2VuZXJhdGVTdHJlYWtJZCxcbiAgICB0cmFuc2Zvcm1GaXJlc3RvcmVUb0NvbXBsZXRpb24sXG4gICAgdHJhbnNmb3JtRmlyZXN0b3JlVG9TdHJlYWssXG4gICAgdHJhbnNmb3JtU3RyZWFrVG9GaXJlc3RvcmUsXG59IGZyb20gXCIuL2hhYml0U3RyZWFrU2NoZW1hc1wiO1xuXG4vKipcbiAqIFN5bmMgb3BlcmF0aW9uIHR5cGVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3luY09wZXJhdGlvbiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0eXBlOiBcImNvbXBsZXRpb25cIiB8IFwic3RyZWFrXCIgfCBcIm1pbGVzdG9uZVwiO1xuICAgIGFjdGlvbjogXCJjcmVhdGVcIiB8IFwidXBkYXRlXCIgfCBcImRlbGV0ZVwiO1xuICAgIGRhdGE6IGFueTtcbiAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcDtcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICBoYWJpdElkPzogc3RyaW5nO1xuICAgIHJldHJ5Q291bnQ6IG51bWJlcjtcbiAgICBsYXN0QXR0ZW1wdD86IFRpbWVzdGFtcDtcbn1cblxuLyoqXG4gKiBDYWNoZWQgZGF0YSBzdHJ1Y3R1cmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDYWNoZWREYXRhPFQ+IHtcbiAgICBkYXRhOiBUO1xuICAgIHRpbWVzdGFtcDogVGltZXN0YW1wO1xuICAgIHZlcnNpb246IG51bWJlcjtcbiAgICBjaGVja3N1bTogc3RyaW5nO1xufVxuXG4vKipcbiAqIFN5bmMgc3RhdHVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3luY1N0YXR1cyB7XG4gICAgaXNPbmxpbmU6IGJvb2xlYW47XG4gICAgbGFzdFN5bmM6IFRpbWVzdGFtcCB8IG51bGw7XG4gICAgcGVuZGluZ09wZXJhdGlvbnM6IG51bWJlcjtcbiAgICBzeW5jSW5Qcm9ncmVzczogYm9vbGVhbjtcbn1cbi8qKlxuICogRGF0YSBTeW5jaHJvbml6YXRpb24gU2VydmljZSBJbXBsZW1lbnRhdGlvblxuICovXG5leHBvcnQgY2xhc3MgU3luY1NlcnZpY2Uge1xuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTeW5jU2VydmljZTtcbiAgICBwcml2YXRlIHN5bmNMaXN0ZW5lcnM6IE1hcDxzdHJpbmcsIFVuc3Vic2NyaWJlPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIHBlbmRpbmdPcGVyYXRpb25zOiBNYXA8c3RyaW5nLCBTeW5jT3BlcmF0aW9uPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIHN5bmNTdGF0dXM6IFN5bmNTdGF0dXMgPSB7XG4gICAgICAgIGlzT25saW5lOiB0cnVlLFxuICAgICAgICBsYXN0U3luYzogbnVsbCxcbiAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IDAsXG4gICAgICAgIHN5bmNJblByb2dyZXNzOiBmYWxzZSxcbiAgICB9O1xuICAgIHByaXZhdGUgc3RhdHVzQ2FsbGJhY2tzOiBTZXQ8KHN0YXR1czogU3luY1N0YXR1cykgPT4gdm9pZD4gPSBuZXcgU2V0KCk7XG5cbiAgICAvLyBDYWNoZSBrZXlzXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ0FDSEVfS0VZUyA9IHtcbiAgICAgICAgU1RSRUFLUzogXCJAaGFiaXRfc3RyZWFrc19jYWNoZVwiLFxuICAgICAgICBDT01QTEVUSU9OUzogXCJAaGFiaXRfY29tcGxldGlvbnNfY2FjaGVcIixcbiAgICAgICAgUEVORElOR19PUFM6IFwiQHBlbmRpbmdfc3luY19vcGVyYXRpb25zXCIsXG4gICAgICAgIExBU1RfU1lOQzogXCJAbGFzdF9zeW5jX3RpbWVzdGFtcFwiLFxuICAgIH07XG5cbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVTeW5jKCk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTeW5jU2VydmljZSB7XG4gICAgICAgIGlmICghU3luY1NlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIFN5bmNTZXJ2aWNlLmluc3RhbmNlID0gbmV3IFN5bmNTZXJ2aWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN5bmNTZXJ2aWNlLmluc3RhbmNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgc3luY2hyb25pemF0aW9uIHN5c3RlbVxuICAgICAqIFJlcXVpcmVtZW50czogMTAuMSwgMTAuNFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZVN5bmMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBMb2FkIHBlbmRpbmcgb3BlcmF0aW9ucyBmcm9tIHN0b3JhZ2VcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFBlbmRpbmdPcGVyYXRpb25zKCk7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGNvbm5lY3Rpdml0eSBhbmQgc3RhcnQgc3luYyBpZiBvbmxpbmVcbiAgICAgICAgICAgIGNvbnN0IG9ubGluZSA9IGF3YWl0IGlzT25saW5lKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBpc09ubGluZTogb25saW5lIH0pO1xuXG4gICAgICAgICAgICBpZiAob25saW5lKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzUGVuZGluZ09wZXJhdGlvbnMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHVwIGNvbm5lY3Rpdml0eSBtb25pdG9yaW5nXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Q29ubmVjdGl2aXR5TW9uaXRvcmluZygpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIHN5bmMgc2VydmljZTpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcmVhbC10aW1lIHN5bmNocm9uaXphdGlvbiBmb3IgYSB1c2VyJ3MgaGFiaXQgZGF0YVxuICAgICAqIFJlcXVpcmVtZW50czogMTAuMVxuICAgICAqL1xuICAgIGFzeW5jIHN0YXJ0UmVhbHRpbWVTeW5jKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc2VyIElEIGlzIHJlcXVpcmVkIGZvciBzeW5jXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3RvcCBleGlzdGluZyBsaXN0ZW5lcnMgZm9yIHRoaXMgdXNlclxuICAgICAgICB0aGlzLnN0b3BSZWFsdGltZVN5bmModXNlcklkKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU2V0IHVwIHN0cmVhayBkYXRhIGxpc3RlbmVyXG4gICAgICAgICAgICBjb25zdCBzdHJlYWtzQ29sbGVjdGlvbiA9IGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVha3NRdWVyeSA9IHF1ZXJ5KFxuICAgICAgICAgICAgICAgIHN0cmVha3NDb2xsZWN0aW9uLFxuICAgICAgICAgICAgICAgIHdoZXJlKFwidXNlcklkXCIsIFwiPT1cIiwgdXNlcklkKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBzdHJlYWtMaXN0ZW5lciA9IG9uU25hcHNob3QoXG4gICAgICAgICAgICAgICAgc3RyZWFrc1F1ZXJ5LFxuICAgICAgICAgICAgICAgIChzbmFwc2hvdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdC5kb2NDaGFuZ2VzKCkuZm9yRWFjaChhc3luYyAoY2hhbmdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJlYWtEYXRhID0gY2hhbmdlLmRvYy5kYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVJlYWx0aW1lU3RyZWFrVXBkYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZS5kb2MuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFrRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTdHJlYWsgc3luYyBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVN5bmNFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFNldCB1cCBjb21wbGV0aW9uIGRhdGEgbGlzdGVuZXJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25zQ29sbGVjdGlvbiA9IGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICAgICAgICAgICAgY29tcGxldGlvbnNDb2xsZWN0aW9uLFxuICAgICAgICAgICAgICAgIHdoZXJlKFwidXNlcklkXCIsIFwiPT1cIiwgdXNlcklkKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0aW9uTGlzdGVuZXIgPSBvblNuYXBzaG90KFxuICAgICAgICAgICAgICAgIGNvbXBsZXRpb25zUXVlcnksXG4gICAgICAgICAgICAgICAgKHNuYXBzaG90KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKGFzeW5jIChjaGFuZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25EYXRhID0gY2hhbmdlLmRvYy5kYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVJlYWx0aW1lQ29tcGxldGlvblVwZGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UuZG9jLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25EYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZS50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkNvbXBsZXRpb24gc3luYyBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVN5bmNFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFN0b3JlIGxpc3RlbmVyc1xuICAgICAgICAgICAgdGhpcy5zeW5jTGlzdGVuZXJzLnNldChgc3RyZWFrc18ke3VzZXJJZH1gLCBzdHJlYWtMaXN0ZW5lcik7XG4gICAgICAgICAgICB0aGlzLnN5bmNMaXN0ZW5lcnMuc2V0KGBjb21wbGV0aW9uc18ke3VzZXJJZH1gLCBjb21wbGV0aW9uTGlzdGVuZXIpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBzdGFydCByZWFsdGltZSBzeW5jOlwiLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wIHJlYWwtdGltZSBzeW5jaHJvbml6YXRpb24gZm9yIGEgdXNlclxuICAgICAqL1xuICAgIHN0b3BSZWFsdGltZVN5bmModXNlcklkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc3RyZWFrS2V5ID0gYHN0cmVha3NfJHt1c2VySWR9YDtcbiAgICAgICAgY29uc3QgY29tcGxldGlvbktleSA9IGBjb21wbGV0aW9uc18ke3VzZXJJZH1gO1xuXG4gICAgICAgIGNvbnN0IHN0cmVha0xpc3RlbmVyID0gdGhpcy5zeW5jTGlzdGVuZXJzLmdldChzdHJlYWtLZXkpO1xuICAgICAgICBpZiAoc3RyZWFrTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHN0cmVha0xpc3RlbmVyKCk7XG4gICAgICAgICAgICB0aGlzLnN5bmNMaXN0ZW5lcnMuZGVsZXRlKHN0cmVha0tleSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb21wbGV0aW9uTGlzdGVuZXIgPSB0aGlzLnN5bmNMaXN0ZW5lcnMuZ2V0KGNvbXBsZXRpb25LZXkpO1xuICAgICAgICBpZiAoY29tcGxldGlvbkxpc3RlbmVyKSB7XG4gICAgICAgICAgICBjb21wbGV0aW9uTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc3luY0xpc3RlbmVycy5kZWxldGUoY29tcGxldGlvbktleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWNoZSBkYXRhIGxvY2FsbHkgd2l0aCBpbnRlZ3JpdHkgdmVyaWZpY2F0aW9uXG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC40XG4gICAgICovXG4gICAgYXN5bmMgY2FjaGVEYXRhPFQ+KGtleTogc3RyaW5nLCBkYXRhOiBULCB2ZXJzaW9uOiBudW1iZXIgPSAxKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjaGVja3N1bSA9IHRoaXMuZ2VuZXJhdGVDaGVja3N1bShkYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZERhdGE6IENhY2hlZERhdGE8VD4gPSB7XG4gICAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcC5ub3coKSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgIGNoZWNrc3VtLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShjYWNoZWREYXRhKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNhY2hlIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIC8vIERvbid0IHRocm93IC0gY2FjaGluZyBmYWlsdXJlIHNob3VsZG4ndCBicmVhayB0aGUgYXBwXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBjYWNoZWQgZGF0YSB3aXRoIGludGVncml0eSB2ZXJpZmljYXRpb25cbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjQsIDEyLjVcbiAgICAgKi9cbiAgICBhc3luYyBnZXRDYWNoZWREYXRhPFQ+KGtleTogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY2FjaGVkU3RyaW5nID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICAgICAgICAgIGlmICghY2FjaGVkU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZERhdGE6IENhY2hlZERhdGE8VD4gPSBKU09OLnBhcnNlKGNhY2hlZFN0cmluZyk7XG5cbiAgICAgICAgICAgIC8vIFZlcmlmeSBkYXRhIGludGVncml0eVxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRDaGVja3N1bSA9IHRoaXMuZ2VuZXJhdGVDaGVja3N1bShjYWNoZWREYXRhLmRhdGEpO1xuICAgICAgICAgICAgaWYgKGNhY2hlZERhdGEuY2hlY2tzdW0gIT09IGV4cGVjdGVkQ2hlY2tzdW0pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDYWNoZSBpbnRlZ3JpdHkgY2hlY2sgZmFpbGVkLCByZW1vdmluZyBjb3JydXB0ZWQgZGF0YVwiKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkRGF0YS5kYXRhO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byByZXRyaWV2ZSBjYWNoZWQgZGF0YTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBRdWV1ZSBvcGVyYXRpb24gZm9yIG9mZmxpbmUgc3luY1xuICAgICAqIFJlcXVpcmVtZW50czogMTAuNFxuICAgICAqL1xuICAgIGFzeW5jIHF1ZXVlT3BlcmF0aW9uKFxuICAgICAgICBvcGVyYXRpb246IE9taXQ8U3luY09wZXJhdGlvbiwgXCJpZFwiIHwgXCJyZXRyeUNvdW50XCIgfCBcInRpbWVzdGFtcFwiPixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc3luY09wOiBTeW5jT3BlcmF0aW9uID0ge1xuICAgICAgICAgICAgLi4ub3BlcmF0aW9uLFxuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVPcGVyYXRpb25JZCgpLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBUaW1lc3RhbXAubm93KCksXG4gICAgICAgICAgICByZXRyeUNvdW50OiAwLFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMucGVuZGluZ09wZXJhdGlvbnMuc2V0KHN5bmNPcC5pZCwgc3luY09wKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlUGVuZGluZ09wZXJhdGlvbnMoKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoe1xuICAgICAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IHRoaXMucGVuZGluZ09wZXJhdGlvbnMuc2l6ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVHJ5IHRvIHByb2Nlc3MgaW1tZWRpYXRlbHkgaWYgb25saW5lXG4gICAgICAgIGlmICh0aGlzLnN5bmNTdGF0dXMuaXNPbmxpbmUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1BlbmRpbmdPcGVyYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHBlbmRpbmcgb3BlcmF0aW9ucyB3aGVuIGNvbm5lY3Rpb24gaXMgcmVzdG9yZWRcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjQsIDEwLjVcbiAgICAgKi9cbiAgICBhc3luYyBwcm9jZXNzUGVuZGluZ09wZXJhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLnN5bmNTdGF0dXMuc3luY0luUHJvZ3Jlc3MgfHwgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5zaXplID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBzeW5jSW5Qcm9ncmVzczogdHJ1ZSB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgb3BlcmF0aW9ucyA9IEFycmF5LmZyb20odGhpcy5wZW5kaW5nT3BlcmF0aW9ucy52YWx1ZXMoKSkuc29ydChcbiAgICAgICAgICAgICAgICAoYSwgYikgPT4gYS50aW1lc3RhbXAudG9NaWxsaXMoKSAtIGIudGltZXN0YW1wLnRvTWlsbGlzKCksXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiBvcGVyYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlT3BlcmF0aW9uKG9wZXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ09wZXJhdGlvbnMuZGVsZXRlKG9wZXJhdGlvbi5pZCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBleGVjdXRlIG9wZXJhdGlvbjpcIiwgZXJyb3IpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEluY3JlbWVudCByZXRyeSBjb3VudFxuICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24ucmV0cnlDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24ubGFzdEF0dGVtcHQgPSBUaW1lc3RhbXAubm93KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9wZXJhdGlvbiBpZiBtYXggcmV0cmllcyBleGNlZWRlZFxuICAgICAgICAgICAgICAgICAgICBpZiAob3BlcmF0aW9uLnJldHJ5Q291bnQgPj0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTWF4IHJldHJpZXMgZXhjZWVkZWQsIHJlbW92aW5nIG9wZXJhdGlvbjpcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5kZWxldGUob3BlcmF0aW9uLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlUGVuZGluZ09wZXJhdGlvbnMoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7XG4gICAgICAgICAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IHRoaXMucGVuZGluZ09wZXJhdGlvbnMuc2l6ZSxcbiAgICAgICAgICAgICAgICBsYXN0U3luYzogVGltZXN0YW1wLm5vdygpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBzeW5jSW5Qcm9ncmVzczogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGEgc3luYyBvcGVyYXRpb24gd2l0aCBhdG9taWMgdXBkYXRlc1xuICAgICAqIFJlcXVpcmVtZW50czogMTAuMlxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZU9wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJldHJ5V2l0aEJhY2tvZmYoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJ1blRyYW5zYWN0aW9uKGRiLCBhc3luYyAodHJhbnNhY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjb21wbGV0aW9uXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVDb21wbGV0aW9uT3BlcmF0aW9uKG9wZXJhdGlvbiwgdHJhbnNhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzdHJlYWtcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVN0cmVha09wZXJhdGlvbihvcGVyYXRpb24sIHRyYW5zYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibWlsZXN0b25lXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVNaWxlc3RvbmVPcGVyYXRpb24ob3BlcmF0aW9uLCB0cmFuc2FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBvcGVyYXRpb24gdHlwZTogJHtvcGVyYXRpb24udHlwZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHJlYWwtdGltZSBzdHJlYWsgdXBkYXRlcyB3aXRoIGNvbmZsaWN0IHJlc29sdXRpb25cbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVJlYWx0aW1lU3RyZWFrVXBkYXRlKFxuICAgICAgICBkb2NJZDogc3RyaW5nLFxuICAgICAgICBkYXRhOiBhbnksXG4gICAgICAgIGNoYW5nZVR5cGU6IFwiYWRkZWRcIiB8IFwibW9kaWZpZWRcIiB8IFwicmVtb3ZlZFwiLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGNoYW5nZVR5cGUgPT09IFwicmVtb3ZlZFwiKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gY2FjaGVcbiAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVDYWNoZUtleSA9IGAke1N5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuU1RSRUFLU31fJHtkb2NJZH1gO1xuICAgICAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKHJlbW92ZUNhY2hlS2V5KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHN0cmVhayA9IHRyYW5zZm9ybUZpcmVzdG9yZVRvU3RyZWFrKGRhdGEpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgY29uZmxpY3RzIHdpdGggbG9jYWwgZGF0YVxuICAgICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLlNUUkVBS1N9XyR7ZG9jSWR9YDtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZFN0cmVhayA9IGF3YWl0IHRoaXMuZ2V0Q2FjaGVkRGF0YTxIYWJpdFN0cmVhaz4oY2FjaGVLZXkpO1xuXG4gICAgICAgICAgICBpZiAoY2FjaGVkU3RyZWFrICYmIHRoaXMuaGFzQ29uZmxpY3QoY2FjaGVkU3RyZWFrLCBzdHJlYWspKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzb2x2ZWRTdHJlYWsgPSBhd2FpdCB0aGlzLnJlc29sdmVTdHJlYWtDb25mbGljdChcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVkU3RyZWFrLFxuICAgICAgICAgICAgICAgICAgICBzdHJlYWssXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShjYWNoZUtleSwgcmVzb2x2ZWRTdHJlYWspO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNhY2hlRGF0YShjYWNoZUtleSwgc3RyZWFrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBoYW5kbGluZyByZWFsdGltZSBzdHJlYWsgdXBkYXRlOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgcmVhbC10aW1lIGNvbXBsZXRpb24gdXBkYXRlc1xuICAgICAqIFJlcXVpcmVtZW50czogMTAuMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlUmVhbHRpbWVDb21wbGV0aW9uVXBkYXRlKFxuICAgICAgICBkb2NJZDogc3RyaW5nLFxuICAgICAgICBkYXRhOiBhbnksXG4gICAgICAgIGNoYW5nZVR5cGU6IFwiYWRkZWRcIiB8IFwibW9kaWZpZWRcIiB8IFwicmVtb3ZlZFwiLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGNoYW5nZVR5cGUgPT09IFwicmVtb3ZlZFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlQ2FjaGVLZXkgPSBgJHtTeW5jU2VydmljZS5DQUNIRV9LRVlTLkNPTVBMRVRJT05TfV8ke2RvY0lkfWA7XG4gICAgICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0ocmVtb3ZlQ2FjaGVLZXkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbiA9IHRyYW5zZm9ybUZpcmVzdG9yZVRvQ29tcGxldGlvbihkb2NJZCwgZGF0YSk7XG4gICAgICAgICAgICBjb25zdCBjYWNoZUtleSA9IGAke1N5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuQ09NUExFVElPTlN9XyR7ZG9jSWR9YDtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2FjaGVEYXRhKGNhY2hlS2V5LCBjb21wbGV0aW9uKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBoYW5kbGluZyByZWFsdGltZSBjb21wbGV0aW9uIHVwZGF0ZTpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzb2x2ZSBjb25mbGljdHMgdXNpbmcgdGltZXN0YW1wIHByaW9yaXR5XG4gICAgICogUmVxdWlyZW1lbnRzOiAxMC41XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyByZXNvbHZlU3RyZWFrQ29uZmxpY3QoXG4gICAgICAgIGxvY2FsU3RyZWFrOiBIYWJpdFN0cmVhayxcbiAgICAgICAgcmVtb3RlU3RyZWFrOiBIYWJpdFN0cmVhayxcbiAgICApOiBQcm9taXNlPEhhYml0U3RyZWFrPiB7XG4gICAgICAgIC8vIFVzZSB0aGUgc3RyZWFrIHdpdGggdGhlIG1vc3QgcmVjZW50IGxhc3RDb21wbGV0aW9uRGF0ZVxuICAgICAgICAvLyBJZiBkYXRlcyBhcmUgZXF1YWwsIHByZWZlciB0aGUgb25lIHdpdGggaGlnaGVyIGN1cnJlbnRTdHJlYWtcblxuICAgICAgICBpZiAoIWxvY2FsU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSAmJiByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlU3RyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvY2FsU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSAmJiAhcmVtb3RlU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvY2FsU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSAmJiByZW1vdGVTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlKSB7XG4gICAgICAgICAgICBpZiAobG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlID4gcmVtb3RlU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFN0cmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgbG9jYWxTdHJlYWsubGFzdENvbXBsZXRpb25EYXRlIDwgcmVtb3RlU3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZVN0cmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gU2FtZSBkYXRlLCB1c2UgaGlnaGVyIHN0cmVha1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFN0cmVhay5jdXJyZW50U3RyZWFrID49IHJlbW90ZVN0cmVhay5jdXJyZW50U3RyZWFrXG4gICAgICAgICAgICAgICAgICAgID8gbG9jYWxTdHJlYWtcbiAgICAgICAgICAgICAgICAgICAgOiByZW1vdGVTdHJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGYWxsYmFjayB0byByZW1vdGUgaWYgbm8gY2xlYXIgd2lubmVyXG4gICAgICAgIHJldHVybiByZW1vdGVTdHJlYWs7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlcmUncyBhIGNvbmZsaWN0IGJldHdlZW4gbG9jYWwgYW5kIHJlbW90ZSBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBoYXNDb25mbGljdChsb2NhbDogSGFiaXRTdHJlYWssIHJlbW90ZTogSGFiaXRTdHJlYWspOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGxvY2FsLmN1cnJlbnRTdHJlYWsgIT09IHJlbW90ZS5jdXJyZW50U3RyZWFrIHx8XG4gICAgICAgICAgICBsb2NhbC5iZXN0U3RyZWFrICE9PSByZW1vdGUuYmVzdFN0cmVhayB8fFxuICAgICAgICAgICAgbG9jYWwubGFzdENvbXBsZXRpb25EYXRlICE9PSByZW1vdGUubGFzdENvbXBsZXRpb25EYXRlIHx8XG4gICAgICAgICAgICBsb2NhbC5mcmVlemVzQXZhaWxhYmxlICE9PSByZW1vdGUuZnJlZXplc0F2YWlsYWJsZSB8fFxuICAgICAgICAgICAgbG9jYWwuZnJlZXplc1VzZWQgIT09IHJlbW90ZS5mcmVlemVzVXNlZFxuICAgICAgICApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGNvbXBsZXRpb24gb3BlcmF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tcGxldGlvbk9wZXJhdGlvbihcbiAgICAgICAgb3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLFxuICAgICAgICB0cmFuc2FjdGlvbjogYW55LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb21wbGV0aW9uc0NvbGxlY3Rpb24gPSBnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbigpO1xuXG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25SZWYgPSBkb2MoY29tcGxldGlvbnNDb2xsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5zZXQoY29tcGxldGlvblJlZiwge1xuICAgICAgICAgICAgICAgICAgICAuLi5vcGVyYXRpb24uZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ1cGRhdGVcIjpcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVSZWYgPSBkb2MoY29tcGxldGlvbnNDb2xsZWN0aW9uLCBvcGVyYXRpb24uZGF0YS5pZCk7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24udXBkYXRlKHVwZGF0ZVJlZiwge1xuICAgICAgICAgICAgICAgICAgICAuLi5vcGVyYXRpb24uZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVSZWYgPSBkb2MoY29tcGxldGlvbnNDb2xsZWN0aW9uLCBvcGVyYXRpb24uZGF0YS5pZCk7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uZGVsZXRlKGRlbGV0ZVJlZik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIHN0cmVhayBvcGVyYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVTdHJlYWtPcGVyYXRpb24oXG4gICAgICAgIG9wZXJhdGlvbjogU3luY09wZXJhdGlvbixcbiAgICAgICAgdHJhbnNhY3Rpb246IGFueSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc3RyZWFrc0NvbGxlY3Rpb24gPSBnZXRIYWJpdFN0cmVha3NDb2xsZWN0aW9uKCk7XG4gICAgICAgIGNvbnN0IHN0cmVha0lkID0gZ2VuZXJhdGVTdHJlYWtJZChvcGVyYXRpb24udXNlcklkLCBvcGVyYXRpb24uaGFiaXRJZCEpO1xuICAgICAgICBjb25zdCBzdHJlYWtSZWYgPSBkb2Moc3RyZWFrc0NvbGxlY3Rpb24sIHN0cmVha0lkKTtcblxuICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCJjcmVhdGVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1cGRhdGVcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBzdHJlYWtEYXRhID0gdHJhbnNmb3JtU3RyZWFrVG9GaXJlc3RvcmUob3BlcmF0aW9uLmRhdGEpO1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnNldChzdHJlYWtSZWYsIHN0cmVha0RhdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImRlbGV0ZVwiOlxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLmRlbGV0ZShzdHJlYWtSZWYpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBtaWxlc3RvbmUgb3BlcmF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlTWlsZXN0b25lT3BlcmF0aW9uKFxuICAgICAgICBvcGVyYXRpb246IFN5bmNPcGVyYXRpb24sXG4gICAgICAgIHRyYW5zYWN0aW9uOiBhbnksXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIE1pbGVzdG9uZSBvcGVyYXRpb25zIGFyZSB0eXBpY2FsbHkgcGFydCBvZiBzdHJlYWsgdXBkYXRlc1xuICAgICAgICAvLyBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgZm9yIGZ1dHVyZSBtaWxlc3RvbmUtc3BlY2lmaWMgb3BlcmF0aW9uc1xuICAgICAgICBjb25zb2xlLmxvZyhcIkV4ZWN1dGluZyBtaWxlc3RvbmUgb3BlcmF0aW9uOlwiLCBvcGVyYXRpb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIGNoZWNrc3VtIGZvciBkYXRhIGludGVncml0eVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVDaGVja3N1bShkYXRhOiBhbnkpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBzdHIgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgbGV0IGhhc2ggPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgICAgICAgaGFzaCA9IChoYXNoIDw8IDUpIC0gaGFzaCArIGNoYXI7XG4gICAgICAgICAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnQgdG8gMzItYml0IGludGVnZXJcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGFzaC50b1N0cmluZygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBvcGVyYXRpb24gSURcbiAgICAgKi9cbiAgICBwcml2YXRlIGdlbmVyYXRlT3BlcmF0aW9uSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBvcF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBwZW5kaW5nIG9wZXJhdGlvbnMgdG8gc3RvcmFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZVBlbmRpbmdPcGVyYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgb3BlcmF0aW9ucyA9IEFycmF5LmZyb20odGhpcy5wZW5kaW5nT3BlcmF0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBjb25zdCBzZXJpYWxpemVkID0gb3BlcmF0aW9ucy5tYXAoKG9wKSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLm9wLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogb3AudGltZXN0YW1wLnRvTWlsbGlzKCksXG4gICAgICAgICAgICAgICAgbGFzdEF0dGVtcHQ6IG9wLmxhc3RBdHRlbXB0Py50b01pbGxpcygpLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLlBFTkRJTkdfT1BTLFxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHNlcmlhbGl6ZWQpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2F2ZSBwZW5kaW5nIG9wZXJhdGlvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgcGVuZGluZyBvcGVyYXRpb25zIGZyb20gc3RvcmFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZFBlbmRpbmdPcGVyYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3RvcmVkID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5QRU5ESU5HX09QUyxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIXN0b3JlZCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdCBvcGVyYXRpb25zID0gSlNPTi5wYXJzZShzdG9yZWQpO1xuICAgICAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5jbGVhcigpO1xuXG4gICAgICAgICAgICBvcGVyYXRpb25zLmZvckVhY2goKG9wOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBvcGVyYXRpb246IFN5bmNPcGVyYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIC4uLm9wLFxuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IFRpbWVzdGFtcC5mcm9tTWlsbGlzKG9wLnRpbWVzdGFtcCksXG4gICAgICAgICAgICAgICAgICAgIGxhc3RBdHRlbXB0OiBvcC5sYXN0QXR0ZW1wdFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBUaW1lc3RhbXAuZnJvbU1pbGxpcyhvcC5sYXN0QXR0ZW1wdClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nT3BlcmF0aW9ucy5zZXQob3BlcmF0aW9uLmlkLCBvcGVyYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgcGVuZGluZyBvcGVyYXRpb25zOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnQgY29ubmVjdGl2aXR5IG1vbml0b3JpbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0Q29ubmVjdGl2aXR5TW9uaXRvcmluZygpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2hlY2sgY29ubmVjdGl2aXR5IGV2ZXJ5IDMwIHNlY29uZHNcbiAgICAgICAgc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb25saW5lID0gYXdhaXQgaXNPbmxpbmUoKTtcbiAgICAgICAgICAgIGNvbnN0IHdhc09ubGluZSA9IHRoaXMuc3luY1N0YXR1cy5pc09ubGluZTtcblxuICAgICAgICAgICAgdGhpcy51cGRhdGVTeW5jU3RhdHVzKHsgaXNPbmxpbmU6IG9ubGluZSB9KTtcblxuICAgICAgICAgICAgLy8gSWYgd2UganVzdCBjYW1lIGJhY2sgb25saW5lLCBwcm9jZXNzIHBlbmRpbmcgb3BlcmF0aW9uc1xuICAgICAgICAgICAgaWYgKG9ubGluZSAmJiAhd2FzT25saW5lKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb25uZWN0aW9uIHJlc3RvcmVkLCBwcm9jZXNzaW5nIHBlbmRpbmcgb3BlcmF0aW9uc1wiKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NQZW5kaW5nT3BlcmF0aW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAzMDAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHN5bmMgZXJyb3JzXG4gICAgICovXG4gICAgcHJpdmF0ZSBoYW5kbGVTeW5jRXJyb3IoZXJyb3I6IGFueSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiU3luYyBlcnJvcjpcIiwgZXJyb3IpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBzeW5jIHN0YXR1cyBiYXNlZCBvbiBlcnJvciB0eXBlXG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSBcInVuYXZhaWxhYmxlXCIgfHwgZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoXCJuZXR3b3JrXCIpKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBpc09ubGluZTogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgc3luYyBzdGF0dXMgYW5kIG5vdGlmeSBsaXN0ZW5lcnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVN5bmNTdGF0dXModXBkYXRlczogUGFydGlhbDxTeW5jU3RhdHVzPik6IHZvaWQge1xuICAgICAgICB0aGlzLnN5bmNTdGF0dXMgPSB7IC4uLnRoaXMuc3luY1N0YXR1cywgLi4udXBkYXRlcyB9O1xuXG4gICAgICAgIC8vIE5vdGlmeSBhbGwgc3RhdHVzIGNhbGxiYWNrc1xuICAgICAgICB0aGlzLnN0YXR1c0NhbGxiYWNrcy5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh0aGlzLnN5bmNTdGF0dXMpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gc3luYyBzdGF0dXMgY2FsbGJhY2s6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlIHRvIHN5bmMgc3RhdHVzIHVwZGF0ZXNcbiAgICAgKi9cbiAgICBvblN5bmNTdGF0dXNDaGFuZ2UoY2FsbGJhY2s6IChzdGF0dXM6IFN5bmNTdGF0dXMpID0+IHZvaWQpOiAoKSA9PiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0dXNDYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcblxuICAgICAgICAvLyBDYWxsIGltbWVkaWF0ZWx5IHdpdGggY3VycmVudCBzdGF0dXNcbiAgICAgICAgY2FsbGJhY2sodGhpcy5zeW5jU3RhdHVzKTtcblxuICAgICAgICAvLyBSZXR1cm4gdW5zdWJzY3JpYmUgZnVuY3Rpb25cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQ2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgc3luYyBzdGF0dXNcbiAgICAgKi9cbiAgICBnZXRTeW5jU3RhdHVzKCk6IFN5bmNTdGF0dXMge1xuICAgICAgICByZXR1cm4geyAuLi50aGlzLnN5bmNTdGF0dXMgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JjZSBzeW5jIGFsbCBkYXRhIGZvciBhIHVzZXJcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEwLjEsIDEwLjNcbiAgICAgKi9cbiAgICBhc3luYyBmb3JjZVN5bmNVc2VyRGF0YSh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuc3luY1N0YXR1cy5pc09ubGluZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZvcmNlIHN5bmMgd2hpbGUgb2ZmbGluZVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBzeW5jSW5Qcm9ncmVzczogdHJ1ZSB9KTtcblxuICAgICAgICAgICAgLy8gU3luYyBhbGwgc3RyZWFrIGRhdGFcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3luY1VzZXJTdHJlYWtzKHVzZXJJZCk7XG5cbiAgICAgICAgICAgIC8vIFN5bmMgYWxsIGNvbXBsZXRpb24gZGF0YVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zeW5jVXNlckNvbXBsZXRpb25zKHVzZXJJZCk7XG5cbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3luY1N0YXR1cyh7IGxhc3RTeW5jOiBUaW1lc3RhbXAubm93KCkgfSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoeyBzeW5jSW5Qcm9ncmVzczogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTeW5jIHVzZXIgc3RyZWFrcyBmcm9tIHNlcnZlclxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc3luY1VzZXJTdHJlYWtzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHN0cmVha3NDb2xsZWN0aW9uID0gZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbigpO1xuICAgICAgICAvLyBJbXBsZW1lbnRhdGlvbiB3b3VsZCBmZXRjaCBhbGwgdXNlciBzdHJlYWtzIGFuZCBjYWNoZSB0aGVtXG4gICAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gLSBmdWxsIGltcGxlbWVudGF0aW9uIHdvdWxkIGhhbmRsZSBwYWdpbmF0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3luY2luZyBzdHJlYWtzIGZvciB1c2VyOlwiLCB1c2VySWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN5bmMgdXNlciBjb21wbGV0aW9ucyBmcm9tIHNlcnZlclxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc3luY1VzZXJDb21wbGV0aW9ucyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb21wbGV0aW9uc0NvbGxlY3Rpb24gPSBnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbigpO1xuICAgICAgICAvLyBJbXBsZW1lbnRhdGlvbiB3b3VsZCBmZXRjaCBhbGwgdXNlciBjb21wbGV0aW9ucyBhbmQgY2FjaGUgdGhlbVxuICAgICAgICAvLyBUaGlzIGlzIGEgc2ltcGxpZmllZCB2ZXJzaW9uIC0gZnVsbCBpbXBsZW1lbnRhdGlvbiB3b3VsZCBoYW5kbGUgcGFnaW5hdGlvblxuICAgICAgICBjb25zb2xlLmxvZyhcIlN5bmNpbmcgY29tcGxldGlvbnMgZm9yIHVzZXI6XCIsIHVzZXJJZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIGNhY2hlZCBkYXRhXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDYWNoZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5tdWx0aVJlbW92ZShbXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5TVFJFQUtTLFxuICAgICAgICAgICAgICAgIFN5bmNTZXJ2aWNlLkNBQ0hFX0tFWVMuQ09NUExFVElPTlMsXG4gICAgICAgICAgICAgICAgU3luY1NlcnZpY2UuQ0FDSEVfS0VZUy5QRU5ESU5HX09QUyxcbiAgICAgICAgICAgICAgICBTeW5jU2VydmljZS5DQUNIRV9LRVlTLkxBU1RfU1lOQyxcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdPcGVyYXRpb25zLmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN5bmNTdGF0dXMoe1xuICAgICAgICAgICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiAwLFxuICAgICAgICAgICAgICAgIGxhc3RTeW5jOiBudWxsLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNsZWFyIGNhY2hlOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBzeW5jU2VydmljZSA9IFN5bmNTZXJ2aWNlLmdldEluc3RhbmNlKCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBT0EsSUFBQUEsZUFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsY0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsYUFBQSxHQUFBQyxzQkFBQSxDQUFBSCxPQUFBO0FBRUEsSUFBQUksVUFBQSxHQUFBSixPQUFBO0FBU0EsSUFBQUssWUFBQSxHQUFBTCxPQUFBO0FBSUEsSUFBQU0sbUJBQUEsR0FBQU4sT0FBQTtBQUs4QixJQXVDakJPLFdBQVcsR0FBQUMsT0FBQSxDQUFBRCxXQUFBO0VBb0JwQixTQUFBQSxZQUFBLEVBQXNCO0lBQUEsSUFBQUUsZ0JBQUEsQ0FBQUMsT0FBQSxRQUFBSCxXQUFBO0lBQUEsS0FsQmRJLGFBQWEsR0FBNkIsSUFBSUMsR0FBRyxDQUFDLENBQUM7SUFBQSxLQUNuREMsaUJBQWlCLEdBQStCLElBQUlELEdBQUcsQ0FBQyxDQUFDO0lBQUEsS0FDekRFLFVBQVUsR0FBZTtNQUM3QkMsUUFBUSxFQUFFLElBQUk7TUFDZEMsUUFBUSxFQUFFLElBQUk7TUFDZEgsaUJBQWlCLEVBQUUsQ0FBQztNQUNwQkksY0FBYyxFQUFFO0lBQ3BCLENBQUM7SUFBQSxLQUNPQyxlQUFlLEdBQXNDLElBQUlDLEdBQUcsQ0FBQyxDQUFDO0lBV2xFLElBQUksQ0FBQ0Ms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