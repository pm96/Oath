{"version":3,"names":["_firebaseConfig","require","_errorHandling","_asyncStorage","_interopRequireDefault","_firestore","_collections","_habitStreakSchemas","SyncService","exports","_classCallCheck2","default","syncListeners","Map","pendingOperations","syncStatus","isOnline","lastSync","syncInProgress","statusCallbacks","Set","initializeSync","_createClass2","key","value","_initializeSync","_asyncToGenerator2","loadPendingOperations","online","updateSyncStatus","processPendingOperations","startConnectivityMonitoring","error","console","apply","arguments","_startRealtimeSync","userId","_this","Error","stopRealtimeSync","streaksCollection","getHabitStreaksCollection","streaksQuery","query","where","streakListener","onSnapshot","snapshot","docChanges","forEach","_ref","change","streakData","doc","data","handleRealtimeStreakUpdate","id","type","_x2","handleSyncError","completionsCollection","getHabitCompletionsCollection","completionsQuery","completionListener","_ref2","completionData","handleRealtimeCompletionUpdate","_x3","set","startRealtimeSync","_x","streakKey","completionKey","get","delete","_cacheData","version","length","undefined","checksum","generateChecksum","cachedData","timestamp","Timestamp","now","AsyncStorage","setItem","JSON","stringify","cacheData","_x4","_x5","_getCachedData","cachedString","getItem","parse","expectedChecksum","warn","removeItem","getCachedData","_x6","_queueOperation","operation","syncOp","Object","assign","generateOperationId","retryCount","savePendingOperations","size","queueOperation","_x7","_processPendingOperations","operations","Array","from","values","sort","a","b","toMillis","executeOperation","lastAttempt","_executeOperation","_this2","retryWithBackoff","runTransaction","db","_ref4","transaction","executeCompletionOperation","executeStreakOperation","executeMilestoneOperation","_x9","_x8","_handleRealtimeStreakUpdate","docId","changeType","removeCacheKey","CACHE_KEYS","STREAKS","streak","transformFirestoreToStreak","cacheKey","cachedStreak","hasConflict","resolvedStreak","resolveStreakConflict","_x0","_x1","_x10","_handleRealtimeCompletionUpdate","COMPLETIONS","completion","transformFirestoreToCompletion","_x11","_x12","_x13","_resolveStreakConflict","localStreak","remoteStreak","lastCompletionDate","currentStreak","_x14","_x15","local","remote","bestStreak","freezesAvailable","freezesUsed","_executeCompletionOperation","action","completionRef","createdAt","serverTimestamp","updateRef","update","updatedAt","deleteRef","_x16","_x17","_executeStreakOperation","streakId","generateStreakId","habitId","streakRef","transformStreakToFirestore","_x18","_x19","_executeMilestoneOperation","log","_x20","_x21","str","hash","i","char","charCodeAt","toString","Date","Math","random","substr","_savePendingOperations","serialized","map","op","_op$lastAttempt","PENDING_OPS","_loadPendingOperations","_this3","stored","clear","fromMillis","_this4","setInterval","wasOnline","_error$message","code","message","includes","updates","_this5","callback","onSyncStatusChange","_this6","add","getSyncStatus","_forceSyncUserData","syncUserStreaks","syncUserCompletions","forceSyncUserData","_x22","_syncUserStreaks","_x23","_syncUserCompletions","_x24","_clearCache","multiRemove","LAST_SYNC","clearCache","getInstance","instance","syncService"],"sources":["syncService.ts"],"sourcesContent":["/**\n * Data Synchronization Service\n *\n * Handles cross-device data synchronization, offline caching, and conflict resolution\n * Requirements: 10.1, 10.2, 10.3, 10.4, 10.5\n */\n\nimport { db } from \"@/firebaseConfig\";\nimport { HabitStreak } from \"@/types\";\nimport { isOnline, retryWithBackoff } from \"@/utils/errorHandling\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { Unsubscribe } from \"firebase/auth\";\nimport {\n    Timestamp,\n    doc,\n    onSnapshot,\n    query,\n    runTransaction,\n    serverTimestamp,\n    where,\n} from \"firebase/firestore\";\nimport {\n    getHabitCompletionsCollection,\n    getHabitStreaksCollection,\n} from \"./collections\";\nimport {\n    generateStreakId,\n    transformFirestoreToCompletion,\n    transformFirestoreToStreak,\n    transformStreakToFirestore,\n} from \"./habitStreakSchemas\";\n\n/**\n * Sync operation types\n */\nexport interface SyncOperation {\n    id: string;\n    type: \"completion\" | \"streak\" | \"milestone\";\n    action: \"create\" | \"update\" | \"delete\";\n    data: any;\n    timestamp: Timestamp;\n    userId: string;\n    habitId?: string;\n    retryCount: number;\n    lastAttempt?: Timestamp;\n}\n\n/**\n * Cached data structure\n */\nexport interface CachedData<T> {\n    data: T;\n    timestamp: Timestamp;\n    version: number;\n    checksum: string;\n}\n\n/**\n * Sync status\n */\nexport interface SyncStatus {\n    isOnline: boolean;\n    lastSync: Timestamp | null;\n    pendingOperations: number;\n    syncInProgress: boolean;\n}\n/**\n * Data Synchronization Service Implementation\n */\nexport class SyncService {\n    private static instance: SyncService;\n    private syncListeners: Map<string, Unsubscribe> = new Map();\n    private pendingOperations: Map<string, SyncOperation> = new Map();\n    private syncStatus: SyncStatus = {\n        isOnline: true,\n        lastSync: null,\n        pendingOperations: 0,\n        syncInProgress: false,\n    };\n    private statusCallbacks: Set<(status: SyncStatus) => void> = new Set();\n\n    // Cache keys\n    private static readonly CACHE_KEYS = {\n        STREAKS: \"@habit_streaks_cache\",\n        COMPLETIONS: \"@habit_completions_cache\",\n        PENDING_OPS: \"@pending_sync_operations\",\n        LAST_SYNC: \"@last_sync_timestamp\",\n    };\n\n    private constructor() {\n        this.initializeSync();\n    }\n\n    public static getInstance(): SyncService {\n        if (!SyncService.instance) {\n            SyncService.instance = new SyncService();\n        }\n        return SyncService.instance;\n    }\n\n    /**\n     * Initialize synchronization system\n     * Requirements: 10.1, 10.4\n     */\n    private async initializeSync(): Promise<void> {\n        try {\n            // Load pending operations from storage\n            await this.loadPendingOperations();\n\n            // Check connectivity and start sync if online\n            const online = await isOnline();\n            this.updateSyncStatus({ isOnline: online });\n\n            if (online) {\n                await this.processPendingOperations();\n            }\n\n            // Set up connectivity monitoring\n            this.startConnectivityMonitoring();\n        } catch (error) {\n            console.error(\"Failed to initialize sync service:\", error);\n        }\n    }\n\n    /**\n     * Start real-time synchronization for a user's habit data\n     * Requirements: 10.1\n     */\n    async startRealtimeSync(userId: string): Promise<void> {\n        if (!userId) {\n            throw new Error(\"User ID is required for sync\");\n        }\n\n        // Stop existing listeners for this user\n        this.stopRealtimeSync(userId);\n\n        try {\n            // Set up streak data listener\n            const streaksCollection = getHabitStreaksCollection();\n            const streaksQuery = query(\n                streaksCollection,\n                where(\"userId\", \"==\", userId),\n            );\n            const streakListener = onSnapshot(\n                streaksQuery,\n                (snapshot) => {\n                    snapshot.docChanges().forEach(async (change) => {\n                        const streakData = change.doc.data();\n                        await this.handleRealtimeStreakUpdate(\n                            change.doc.id,\n                            streakData,\n                            change.type,\n                        );\n                    });\n                },\n                (error) => {\n                    console.error(\"Streak sync error:\", error);\n                    this.handleSyncError(error);\n                },\n            );\n\n            // Set up completion data listener\n            const completionsCollection = getHabitCompletionsCollection();\n            const completionsQuery = query(\n                completionsCollection,\n                where(\"userId\", \"==\", userId),\n            );\n            const completionListener = onSnapshot(\n                completionsQuery,\n                (snapshot) => {\n                    snapshot.docChanges().forEach(async (change) => {\n                        const completionData = change.doc.data();\n                        await this.handleRealtimeCompletionUpdate(\n                            change.doc.id,\n                            completionData,\n                            change.type,\n                        );\n                    });\n                },\n                (error) => {\n                    console.error(\"Completion sync error:\", error);\n                    this.handleSyncError(error);\n                },\n            );\n\n            // Store listeners\n            this.syncListeners.set(`streaks_${userId}`, streakListener);\n            this.syncListeners.set(`completions_${userId}`, completionListener);\n        } catch (error) {\n            console.error(\"Failed to start realtime sync:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Stop real-time synchronization for a user\n     */\n    stopRealtimeSync(userId: string): void {\n        const streakKey = `streaks_${userId}`;\n        const completionKey = `completions_${userId}`;\n\n        const streakListener = this.syncListeners.get(streakKey);\n        if (streakListener) {\n            streakListener();\n            this.syncListeners.delete(streakKey);\n        }\n\n        const completionListener = this.syncListeners.get(completionKey);\n        if (completionListener) {\n            completionListener();\n            this.syncListeners.delete(completionKey);\n        }\n    }\n\n    /**\n     * Cache data locally with integrity verification\n     * Requirements: 10.4\n     */\n    async cacheData<T>(key: string, data: T, version: number = 1): Promise<void> {\n        try {\n            const checksum = this.generateChecksum(data);\n            const cachedData: CachedData<T> = {\n                data,\n                timestamp: Timestamp.now(),\n                version,\n                checksum,\n            };\n\n            await AsyncStorage.setItem(key, JSON.stringify(cachedData));\n        } catch (error) {\n            console.error(\"Failed to cache data:\", error);\n            // Don't throw - caching failure shouldn't break the app\n        }\n    }\n\n    /**\n     * Retrieve cached data with integrity verification\n     * Requirements: 10.4, 12.5\n     */\n    async getCachedData<T>(key: string): Promise<T | null> {\n        try {\n            const cachedString = await AsyncStorage.getItem(key);\n            if (!cachedString) {\n                return null;\n            }\n\n            const cachedData: CachedData<T> = JSON.parse(cachedString);\n\n            // Verify data integrity\n            const expectedChecksum = this.generateChecksum(cachedData.data);\n            if (cachedData.checksum !== expectedChecksum) {\n                console.warn(\"Cache integrity check failed, removing corrupted data\");\n                await AsyncStorage.removeItem(key);\n                return null;\n            }\n\n            return cachedData.data;\n        } catch (error) {\n            console.error(\"Failed to retrieve cached data:\", error);\n            return null;\n        }\n    }\n\n    /**\n     * Queue operation for offline sync\n     * Requirements: 10.4\n     */\n    async queueOperation(\n        operation: Omit<SyncOperation, \"id\" | \"retryCount\" | \"timestamp\">,\n    ): Promise<void> {\n        const syncOp: SyncOperation = {\n            ...operation,\n            id: this.generateOperationId(),\n            timestamp: Timestamp.now(),\n            retryCount: 0,\n        };\n\n        this.pendingOperations.set(syncOp.id, syncOp);\n        await this.savePendingOperations();\n\n        this.updateSyncStatus({\n            pendingOperations: this.pendingOperations.size,\n        });\n\n        // Try to process immediately if online\n        if (this.syncStatus.isOnline) {\n            await this.processPendingOperations();\n        }\n    }\n\n    /**\n     * Process pending operations when connection is restored\n     * Requirements: 10.4, 10.5\n     */\n    async processPendingOperations(): Promise<void> {\n        if (this.syncStatus.syncInProgress || this.pendingOperations.size === 0) {\n            return;\n        }\n\n        this.updateSyncStatus({ syncInProgress: true });\n\n        try {\n            const operations = Array.from(this.pendingOperations.values()).sort(\n                (a, b) => a.timestamp.toMillis() - b.timestamp.toMillis(),\n            );\n\n            for (const operation of operations) {\n                try {\n                    await this.executeOperation(operation);\n                    this.pendingOperations.delete(operation.id);\n                } catch (error) {\n                    console.error(\"Failed to execute operation:\", error);\n\n                    // Increment retry count\n                    operation.retryCount++;\n                    operation.lastAttempt = Timestamp.now();\n\n                    // Remove operation if max retries exceeded\n                    if (operation.retryCount >= 3) {\n                        console.warn(\n                            \"Max retries exceeded, removing operation:\",\n                            operation.id,\n                        );\n                        this.pendingOperations.delete(operation.id);\n                    }\n                }\n            }\n\n            await this.savePendingOperations();\n            this.updateSyncStatus({\n                pendingOperations: this.pendingOperations.size,\n                lastSync: Timestamp.now(),\n            });\n        } finally {\n            this.updateSyncStatus({ syncInProgress: false });\n        }\n    }\n\n    /**\n     * Execute a sync operation with atomic updates\n     * Requirements: 10.2\n     */\n    private async executeOperation(operation: SyncOperation): Promise<void> {\n        return await retryWithBackoff(async () => {\n            return await runTransaction(db, async (transaction) => {\n                switch (operation.type) {\n                    case \"completion\":\n                        await this.executeCompletionOperation(operation, transaction);\n                        break;\n                    case \"streak\":\n                        await this.executeStreakOperation(operation, transaction);\n                        break;\n                    case \"milestone\":\n                        await this.executeMilestoneOperation(operation, transaction);\n                        break;\n                    default:\n                        throw new Error(`Unknown operation type: ${operation.type}`);\n                }\n            });\n        });\n    }\n\n    /**\n     * Handle real-time streak updates with conflict resolution\n     * Requirements: 10.1, 10.5\n     */\n    private async handleRealtimeStreakUpdate(\n        docId: string,\n        data: any,\n        changeType: \"added\" | \"modified\" | \"removed\",\n    ): Promise<void> {\n        try {\n            if (changeType === \"removed\") {\n                // Remove from cache\n                const removeCacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;\n                await AsyncStorage.removeItem(removeCacheKey);\n                return;\n            }\n\n            const streak = transformFirestoreToStreak(data);\n\n            // Check for conflicts with local data\n            const cacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;\n            const cachedStreak = await this.getCachedData<HabitStreak>(cacheKey);\n\n            if (cachedStreak && this.hasConflict(cachedStreak, streak)) {\n                const resolvedStreak = await this.resolveStreakConflict(\n                    cachedStreak,\n                    streak,\n                );\n                await this.cacheData(cacheKey, resolvedStreak);\n            } else {\n                await this.cacheData(cacheKey, streak);\n            }\n        } catch (error) {\n            console.error(\"Error handling realtime streak update:\", error);\n        }\n    }\n\n    /**\n     * Handle real-time completion updates\n     * Requirements: 10.1\n     */\n    private async handleRealtimeCompletionUpdate(\n        docId: string,\n        data: any,\n        changeType: \"added\" | \"modified\" | \"removed\",\n    ): Promise<void> {\n        try {\n            if (changeType === \"removed\") {\n                const removeCacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;\n                await AsyncStorage.removeItem(removeCacheKey);\n                return;\n            }\n\n            const completion = transformFirestoreToCompletion(docId, data);\n            const cacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;\n            await this.cacheData(cacheKey, completion);\n        } catch (error) {\n            console.error(\"Error handling realtime completion update:\", error);\n        }\n    }\n\n    /**\n     * Resolve conflicts using timestamp priority\n     * Requirements: 10.5\n     */\n    private async resolveStreakConflict(\n        localStreak: HabitStreak,\n        remoteStreak: HabitStreak,\n    ): Promise<HabitStreak> {\n        // Use the streak with the most recent lastCompletionDate\n        // If dates are equal, prefer the one with higher currentStreak\n\n        if (!localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {\n            return remoteStreak;\n        }\n\n        if (localStreak.lastCompletionDate && !remoteStreak.lastCompletionDate) {\n            return localStreak;\n        }\n\n        if (localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {\n            if (localStreak.lastCompletionDate > remoteStreak.lastCompletionDate) {\n                return localStreak;\n            } else if (\n                localStreak.lastCompletionDate < remoteStreak.lastCompletionDate\n            ) {\n                return remoteStreak;\n            } else {\n                // Same date, use higher streak\n                return localStreak.currentStreak >= remoteStreak.currentStreak\n                    ? localStreak\n                    : remoteStreak;\n            }\n        }\n\n        // Fallback to remote if no clear winner\n        return remoteStreak;\n    }\n\n    /**\n     * Check if there's a conflict between local and remote data\n     */\n    private hasConflict(local: HabitStreak, remote: HabitStreak): boolean {\n        return (\n            local.currentStreak !== remote.currentStreak ||\n            local.bestStreak !== remote.bestStreak ||\n            local.lastCompletionDate !== remote.lastCompletionDate ||\n            local.freezesAvailable !== remote.freezesAvailable ||\n            local.freezesUsed !== remote.freezesUsed\n        );\n    }\n    /**\n     * Execute completion operation\n     */\n    private async executeCompletionOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        const completionsCollection = getHabitCompletionsCollection();\n\n        switch (operation.action) {\n            case \"create\":\n                const completionRef = doc(completionsCollection);\n                transaction.set(completionRef, {\n                    ...operation.data,\n                    createdAt: serverTimestamp(),\n                });\n                break;\n            case \"update\":\n                const updateRef = doc(completionsCollection, operation.data.id);\n                transaction.update(updateRef, {\n                    ...operation.data,\n                    updatedAt: serverTimestamp(),\n                });\n                break;\n            case \"delete\":\n                const deleteRef = doc(completionsCollection, operation.data.id);\n                transaction.delete(deleteRef);\n                break;\n        }\n    }\n\n    /**\n     * Execute streak operation\n     */\n    private async executeStreakOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        const streaksCollection = getHabitStreaksCollection();\n        const streakId = generateStreakId(operation.userId, operation.habitId!);\n        const streakRef = doc(streaksCollection, streakId);\n\n        switch (operation.action) {\n            case \"create\":\n            case \"update\":\n                const streakData = transformStreakToFirestore(operation.data);\n                transaction.set(streakRef, streakData);\n                break;\n            case \"delete\":\n                transaction.delete(streakRef);\n                break;\n        }\n    }\n\n    /**\n     * Execute milestone operation\n     */\n    private async executeMilestoneOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        // Milestone operations are typically part of streak updates\n        // This is a placeholder for future milestone-specific operations\n        console.log(\"Executing milestone operation:\", operation);\n    }\n\n    /**\n     * Generate checksum for data integrity\n     */\n    private generateChecksum(data: any): string {\n        const str = JSON.stringify(data);\n        let hash = 0;\n        for (let i = 0; i < str.length; i++) {\n            const char = str.charCodeAt(i);\n            hash = (hash << 5) - hash + char;\n            hash = hash & hash; // Convert to 32-bit integer\n        }\n        return hash.toString();\n    }\n\n    /**\n     * Generate unique operation ID\n     */\n    private generateOperationId(): string {\n        return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n\n    /**\n     * Save pending operations to storage\n     */\n    private async savePendingOperations(): Promise<void> {\n        try {\n            const operations = Array.from(this.pendingOperations.values());\n            const serialized = operations.map((op) => ({\n                ...op,\n                timestamp: op.timestamp.toMillis(),\n                lastAttempt: op.lastAttempt?.toMillis(),\n            }));\n\n            await AsyncStorage.setItem(\n                SyncService.CACHE_KEYS.PENDING_OPS,\n                JSON.stringify(serialized),\n            );\n        } catch (error) {\n            console.error(\"Failed to save pending operations:\", error);\n        }\n    }\n\n    /**\n     * Load pending operations from storage\n     */\n    private async loadPendingOperations(): Promise<void> {\n        try {\n            const stored = await AsyncStorage.getItem(\n                SyncService.CACHE_KEYS.PENDING_OPS,\n            );\n            if (!stored) return;\n\n            const operations = JSON.parse(stored);\n            this.pendingOperations.clear();\n\n            operations.forEach((op: any) => {\n                const operation: SyncOperation = {\n                    ...op,\n                    timestamp: Timestamp.fromMillis(op.timestamp),\n                    lastAttempt: op.lastAttempt\n                        ? Timestamp.fromMillis(op.lastAttempt)\n                        : undefined,\n                };\n                this.pendingOperations.set(operation.id, operation);\n            });\n        } catch (error) {\n            console.error(\"Failed to load pending operations:\", error);\n        }\n    }\n    /**\n     * Start connectivity monitoring\n     */\n    private startConnectivityMonitoring(): void {\n        // Check connectivity every 30 seconds\n        setInterval(async () => {\n            const online = await isOnline();\n            const wasOnline = this.syncStatus.isOnline;\n\n            this.updateSyncStatus({ isOnline: online });\n\n            // If we just came back online, process pending operations\n            if (online && !wasOnline) {\n                console.log(\"Connection restored, processing pending operations\");\n                await this.processPendingOperations();\n            }\n        }, 30000);\n    }\n\n    /**\n     * Handle sync errors\n     */\n    private handleSyncError(error: any): void {\n        console.error(\"Sync error:\", error);\n\n        // Update sync status based on error type\n        if (error.code === \"unavailable\" || error.message?.includes(\"network\")) {\n            this.updateSyncStatus({ isOnline: false });\n        }\n    }\n\n    /**\n     * Update sync status and notify listeners\n     */\n    private updateSyncStatus(updates: Partial<SyncStatus>): void {\n        this.syncStatus = { ...this.syncStatus, ...updates };\n\n        // Notify all status callbacks\n        this.statusCallbacks.forEach((callback) => {\n            try {\n                callback(this.syncStatus);\n            } catch (error) {\n                console.error(\"Error in sync status callback:\", error);\n            }\n        });\n    }\n\n    /**\n     * Subscribe to sync status updates\n     */\n    onSyncStatusChange(callback: (status: SyncStatus) => void): () => void {\n        this.statusCallbacks.add(callback);\n\n        // Call immediately with current status\n        callback(this.syncStatus);\n\n        // Return unsubscribe function\n        return () => {\n            this.statusCallbacks.delete(callback);\n        };\n    }\n\n    /**\n     * Get current sync status\n     */\n    getSyncStatus(): SyncStatus {\n        return { ...this.syncStatus };\n    }\n\n    /**\n     * Force sync all data for a user\n     * Requirements: 10.1, 10.3\n     */\n    async forceSyncUserData(userId: string): Promise<void> {\n        if (!this.syncStatus.isOnline) {\n            throw new Error(\"Cannot force sync while offline\");\n        }\n\n        try {\n            this.updateSyncStatus({ syncInProgress: true });\n\n            // Sync all streak data\n            await this.syncUserStreaks(userId);\n\n            // Sync all completion data\n            await this.syncUserCompletions(userId);\n\n            this.updateSyncStatus({ lastSync: Timestamp.now() });\n        } finally {\n            this.updateSyncStatus({ syncInProgress: false });\n        }\n    }\n\n    /**\n     * Sync user streaks from server\n     */\n    private async syncUserStreaks(userId: string): Promise<void> {\n        const streaksCollection = getHabitStreaksCollection();\n        // Implementation would fetch all user streaks and cache them\n        // This is a simplified version - full implementation would handle pagination\n        console.log(\"Syncing streaks for user:\", userId);\n    }\n\n    /**\n     * Sync user completions from server\n     */\n    private async syncUserCompletions(userId: string): Promise<void> {\n        const completionsCollection = getHabitCompletionsCollection();\n        // Implementation would fetch all user completions and cache them\n        // This is a simplified version - full implementation would handle pagination\n        console.log(\"Syncing completions for user:\", userId);\n    }\n\n    /**\n     * Clear all cached data\n     */\n    async clearCache(): Promise<void> {\n        try {\n            await AsyncStorage.multiRemove([\n                SyncService.CACHE_KEYS.STREAKS,\n                SyncService.CACHE_KEYS.COMPLETIONS,\n                SyncService.CACHE_KEYS.PENDING_OPS,\n                SyncService.CACHE_KEYS.LAST_SYNC,\n            ]);\n\n            this.pendingOperations.clear();\n            this.updateSyncStatus({\n                pendingOperations: 0,\n                lastSync: null,\n            });\n        } catch (error) {\n            console.error(\"Failed to clear cache:\", error);\n        }\n    }\n}\n\n// Export singleton instance\nexport const syncService = SyncService.getInstance();\n"],"mappings":"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","ignoreList":[]}