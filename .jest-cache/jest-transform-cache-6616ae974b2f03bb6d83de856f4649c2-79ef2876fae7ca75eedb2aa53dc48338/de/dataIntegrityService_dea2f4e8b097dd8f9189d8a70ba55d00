d6ab8ad9167ace526b727a5c17a7c9a7
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.dataIntegrityService = exports.DataIntegrityService = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _firestore = require("firebase/firestore");
var _collections = require("./collections");
var _habitStreakSchemas = require("./habitStreakSchemas");
var DataIntegrityService = exports.DataIntegrityService = function () {
  function DataIntegrityService() {
    (0, _classCallCheck2.default)(this, DataIntegrityService);
  }
  return (0, _createClass2.default)(DataIntegrityService, [{
    key: "verifyStreakIntegrity",
    value: (function () {
      var _verifyStreakIntegrity = (0, _asyncToGenerator2.default)(function* (habitId, userId, streakData) {
        var errors = [];
        var warnings = [];
        var correctedData;
        try {
          var streak = streakData;
          if (!streak) {
            var streakId = (0, _habitStreakSchemas.generateStreakId)(userId, habitId);
            var streaksCollection = (0, _collections.getHabitStreaksCollection)();
            var streakDoc = yield (0, _firestore.getDoc)((0, _firestore.doc)(streaksCollection, streakId));
            if (!streakDoc.exists()) {
              errors.push("Streak document not found");
              return {
                isValid: false,
                errors: errors,
                warnings: warnings
              };
            }
            streak = (0, _habitStreakSchemas.transformFirestoreToStreak)(streakDoc.data());
          }
          if (!(0, _habitStreakSchemas.validateUserOwnership)(userId, streak.userId)) {
            errors.push("User ownership validation failed");
          }
          if (!(0, _habitStreakSchemas.validateStreakDocument)(streak)) {
            errors.push("Streak document structure is invalid");
          }
          var streakValidation = this.validateStreakLogic(streak);
          if (!streakValidation.isValid) {
            errors.push.apply(errors, (0, _toConsumableArray2.default)(streakValidation.errors));
            warnings.push.apply(warnings, (0, _toConsumableArray2.default)(streakValidation.warnings));
            correctedData = streakValidation.correctedData;
          }
          var milestoneValidation = this.validateMilestones(streak);
          if (!milestoneValidation.isValid) {
            errors.push.apply(errors, (0, _toConsumableArray2.default)(milestoneValidation.errors));
            warnings.push.apply(warnings, (0, _toConsumableArray2.default)(milestoneValidation.warnings));
          }
          yield this.logIntegrityCheck("streak", habitId, userId, errors.length === 0);
          return {
            isValid: errors.length === 0,
            errors: errors,
            warnings: warnings,
            correctedData: correctedData
          };
        } catch (error) {
          errors.push(`Integrity check failed: ${error}`);
          return {
            isValid: false,
            errors: errors,
            warnings: warnings
          };
        }
      });
      function verifyStreakIntegrity(_x, _x2, _x3) {
        return _verifyStreakIntegrity.apply(this, arguments);
      }
      return verifyStreakIntegrity;
    }())
  }, {
    key: "verifyCompletionIntegrity",
    value: (function () {
      var _verifyCompletionIntegrity = (0, _asyncToGenerator2.default)(function* (completionId, userId, completionData) {
        var errors = [];
        var warnings = [];
        try {
          var completion = completionData;
          if (!completion) {
            var completionsCollection = (0, _collections.getHabitCompletionsCollection)();
            var completionDoc = yield (0, _firestore.getDoc)((0, _firestore.doc)(completionsCollection, completionId));
            if (!completionDoc.exists()) {
              errors.push("Completion document not found");
              return {
                isValid: false,
                errors: errors,
                warnings: warnings
              };
            }
            completion = (0, _habitStreakSchemas.transformFirestoreToCompletion)(completionId, completionDoc.data());
          }
          if (!(0, _habitStreakSchemas.validateUserOwnership)(userId, completion.userId)) {
            errors.push("User ownership validation failed");
          }
          var completionValidation = this.validateCompletionData(completion);
          if (!completionValidation.isValid) {
            errors.push.apply(errors, (0, _toConsumableArray2.default)(completionValidation.errors));
            warnings.push.apply(warnings, (0, _toConsumableArray2.default)(completionValidation.warnings));
          }
          yield this.logIntegrityCheck("completion", completionId, userId, errors.length === 0);
          return {
            isValid: errors.length === 0,
            errors: errors,
            warnings: warnings
          };
        } catch (error) {
          errors.push(`Integrity check failed: ${error}`);
          return {
            isValid: false,
            errors: errors,
            warnings: warnings
          };
        }
      });
      function verifyCompletionIntegrity(_x4, _x5, _x6) {
        return _verifyCompletionIntegrity.apply(this, arguments);
      }
      return verifyCompletionIntegrity;
    }())
  }, {
    key: "validateStreakLogic",
    value: function validateStreakLogic(streak) {
      var errors = [];
      var warnings = [];
      var correctedData;
      if (streak.currentStreak > streak.bestStreak) {
        warnings.push("Current streak exceeds best streak - correcting best streak");
        correctedData = Object.assign({}, streak, {
          bestStreak: streak.currentStreak
        });
      }
      if (streak.currentStreak < 0 || streak.bestStreak < 0) {
        errors.push("Streak values cannot be negative");
      }
      if (streak.freezesAvailable < 0 || streak.freezesUsed < 0) {
        errors.push("Freeze counts cannot be negative");
      }
      var totalFreezesEarned = Math.floor(streak.bestStreak / 30);
      if (streak.freezesUsed > totalFreezesEarned) {
        warnings.push("Freeze usage exceeds theoretical maximum based on milestones");
      }
      if (streak.lastCompletionDate && !this.isValidDateString(streak.lastCompletionDate)) {
        errors.push("Invalid last completion date format");
      }
      if (streak.streakStartDate && !this.isValidDateString(streak.streakStartDate)) {
        errors.push("Invalid streak start date format");
      }
      return {
        isValid: errors.length === 0,
        errors: errors,
        warnings: warnings,
        correctedData: correctedData
      };
    }
  }, {
    key: "validateMilestones",
    value: function validateMilestones(streak) {
      var errors = [];
      var warnings = [];
      var sortedMilestones = (0, _toConsumableArray2.default)(streak.milestones).sort(function (a, b) {
        return a.days - b.days;
      });
      var isOrdered = streak.milestones.every(function (milestone, index) {
        return milestone.days === sortedMilestones[index].days;
      });
      if (!isOrdered) {
        warnings.push("Milestones are not in ascending order");
      }
      var uniqueDays = new Set(streak.milestones.map(function (m) {
        return m.days;
      }));
      if (uniqueDays.size !== streak.milestones.length) {
        errors.push("Duplicate milestone days found");
      }
      var invalidMilestones = streak.milestones.filter(function (m) {
        return m.days > streak.bestStreak;
      });
      if (invalidMilestones.length > 0) {
        warnings.push(`${invalidMilestones.length} milestones exceed best streak`);
      }
      var invalidTimestamps = streak.milestones.filter(function (m) {
        return !m.achievedAt || m.achievedAt.toMillis() > Date.now();
      });
      if (invalidTimestamps.length > 0) {
        errors.push("Invalid milestone timestamps found");
      }
      return {
        isValid: errors.length === 0,
        errors: errors,
        warnings: warnings
      };
    }
  }, {
    key: "validateCompletionData",
    value: function validateCompletionData(completion) {
      var errors = [];
      var warnings = [];
      if (!completion.id || !completion.habitId || !completion.userId) {
        errors.push("Missing required completion fields");
      }
      if (completion.completedAt.toMillis() > Date.now()) {
        errors.push("Completion timestamp is in the future");
      }
      var validDifficulties = ["easy", "medium", "hard"];
      if (!validDifficulties.includes(completion.difficulty)) {
        errors.push("Invalid difficulty level");
      }
      if (completion.timezone && !this.isValidTimezone(completion.timezone)) {
        warnings.push("Invalid timezone format");
      }
      if (completion.notes && completion.notes.length > 500) {
        warnings.push("Completion notes are unusually long");
      }
      return {
        isValid: errors.length === 0,
        errors: errors,
        warnings: warnings
      };
    }
  }, {
    key: "detectSuspiciousActivity",
    value: (function () {
      var _detectSuspiciousActivity = (0, _asyncToGenerator2.default)(function* (userId, recentCompletions) {
        var flags = [];
        var riskLevel = "low";
        try {
          var now = Date.now();
          var recentCount = recentCompletions.filter(function (c) {
            return now - c.completedAt.toMillis() < 60 * 60 * 1000;
          }).length;
          if (recentCount > 10) {
            flags.push("Excessive completions in short timeframe");
            riskLevel = "high";
          } else if (recentCount > 5) {
            flags.push("High completion frequency");
            riskLevel = "medium";
          }
          var timestamps = recentCompletions.map(function (c) {
            return c.completedAt.toMillis();
          });
          var uniqueTimestamps = new Set(timestamps);
          if (uniqueTimestamps.size < timestamps.length) {
            flags.push("Duplicate completion timestamps");
            riskLevel = "high";
          }
          var timezones = new Set(recentCompletions.map(function (c) {
            return c.timezone;
          }));
          if (timezones.size > 3) {
            flags.push("Completions from multiple timezones");
            riskLevel = "medium";
          }
          var sortedByCreation = (0, _toConsumableArray2.default)(recentCompletions).sort(function (a, b) {
            return a.completedAt.toMillis() - b.completedAt.toMillis();
          });
          var sortedByCompletion = (0, _toConsumableArray2.default)(recentCompletions).sort(function (a, b) {
            return a.completedAt.toMillis() - b.completedAt.toMillis();
          });
          var isRetroactive = sortedByCreation.some(function (completion, index) {
            var _sortedByCompletion$i;
            return completion.id !== ((_sortedByCompletion$i = sortedByCompletion[index]) == null ? void 0 : _sortedByCompletion$i.id);
          });
          if (isRetroactive) {
            flags.push("Pattern of retroactive completions");
            if (riskLevel === "low") riskLevel = "medium";
          }
          if (flags.length > 0) {
            yield this.logSuspiciousActivity(userId, flags, riskLevel);
          }
          return {
            isSuspicious: flags.length > 0,
            flags: flags,
            riskLevel: riskLevel
          };
        } catch (error) {
          console.error("Error detecting suspicious activity:", error);
          return {
            isSuspicious: false,
            flags: [],
            riskLevel: "low"
          };
        }
      });
      function detectSuspiciousActivity(_x7, _x8) {
        return _detectSuspiciousActivity.apply(this, arguments);
      }
      return detectSuspiciousActivity;
    }())
  }, {
    key: "isValidDateString",
    value: function isValidDateString(dateString) {
      var regex = /^\d{4}-\d{2}-\d{2}$/;
      if (!regex.test(dateString)) return false;
      var date = new Date(dateString);
      return date instanceof Date && !isNaN(date.getTime());
    }
  }, {
    key: "isValidTimezone",
    value: function isValidTimezone(timezone) {
      try {
        Intl.DateTimeFormat(undefined, {
          timeZone: timezone
        });
        return true;
      } catch (_unused) {
        return false;
      }
    }
  }, {
    key: "logIntegrityCheck",
    value: (function () {
      var _logIntegrityCheck = (0, _asyncToGenerator2.default)(function* (type, entityId, userId, passed) {
        try {
          var logEntry = {
            timestamp: Date.now(),
            type: type,
            entityId: entityId,
            userId: userId,
            passed: passed
          };
          var existingLog = yield _asyncStorage.default.getItem(DataIntegrityService.INTEGRITY_LOG_KEY);
          var log = existingLog ? JSON.parse(existingLog) : [];
          log.push(logEntry);
          if (log.length > DataIntegrityService.MAX_LOG_ENTRIES) {
            log.splice(0, log.length - DataIntegrityService.MAX_LOG_ENTRIES);
          }
          yield _asyncStorage.default.setItem(DataIntegrityService.INTEGRITY_LOG_KEY, JSON.stringify(log));
        } catch (error) {
          console.error("Failed to log integrity check:", error);
        }
      });
      function logIntegrityCheck(_x9, _x0, _x1, _x10) {
        return _logIntegrityCheck.apply(this, arguments);
      }
      return logIntegrityCheck;
    }())
  }, {
    key: "logSuspiciousActivity",
    value: (function () {
      var _logSuspiciousActivity = (0, _asyncToGenerator2.default)(function* (userId, flags, riskLevel) {
        try {
          var logEntry = {
            timestamp: Date.now(),
            userId: userId,
            flags: flags,
            riskLevel: riskLevel,
            type: "suspicious_activity"
          };
          console.warn("Suspicious activity detected:", logEntry);
          var existingLog = yield _asyncStorage.default.getItem(DataIntegrityService.INTEGRITY_LOG_KEY);
          var log = existingLog ? JSON.parse(existingLog) : [];
          log.push(logEntry);
          if (log.length > DataIntegrityService.MAX_LOG_ENTRIES) {
            log.splice(0, log.length - DataIntegrityService.MAX_LOG_ENTRIES);
          }
          yield _asyncStorage.default.setItem(DataIntegrityService.INTEGRITY_LOG_KEY, JSON.stringify(log));
        } catch (error) {
          console.error("Failed to log suspicious activity:", error);
        }
      });
      function logSuspiciousActivity(_x11, _x12, _x13) {
        return _logSuspiciousActivity.apply(this, arguments);
      }
      return logSuspiciousActivity;
    }())
  }, {
    key: "getIntegrityLog",
    value: (function () {
      var _getIntegrityLog = (0, _asyncToGenerator2.default)(function* () {
        try {
          var logData = yield _asyncStorage.default.getItem(DataIntegrityService.INTEGRITY_LOG_KEY);
          return logData ? JSON.parse(logData) : [];
        } catch (error) {
          console.error("Failed to get integrity log:", error);
          return [];
        }
      });
      function getIntegrityLog() {
        return _getIntegrityLog.apply(this, arguments);
      }
      return getIntegrityLog;
    }())
  }, {
    key: "clearIntegrityLog",
    value: (function () {
      var _clearIntegrityLog = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield _asyncStorage.default.removeItem(DataIntegrityService.INTEGRITY_LOG_KEY);
        } catch (error) {
          console.error("Failed to clear integrity log:", error);
        }
      });
      function clearIntegrityLog() {
        return _clearIntegrityLog.apply(this, arguments);
      }
      return clearIntegrityLog;
    }())
  }]);
}();
DataIntegrityService.INTEGRITY_LOG_KEY = "@integrity_checks_log";
DataIntegrityService.MAX_LOG_ENTRIES = 100;
var dataIntegrityService = exports.dataIntegrityService = new DataIntegrityService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZmlyZXN0b3JlIiwiX2NvbGxlY3Rpb25zIiwiX2hhYml0U3RyZWFrU2NoZW1hcyIsIkRhdGFJbnRlZ3JpdHlTZXJ2aWNlIiwiZXhwb3J0cyIsIl9jbGFzc0NhbGxDaGVjazIiLCJkZWZhdWx0IiwiX2NyZWF0ZUNsYXNzMiIsImtleSIsInZhbHVlIiwiX3ZlcmlmeVN0cmVha0ludGVncml0eSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImhhYml0SWQiLCJ1c2VySWQiLCJzdHJlYWtEYXRhIiwiZXJyb3JzIiwid2FybmluZ3MiLCJjb3JyZWN0ZWREYXRhIiwic3RyZWFrIiwic3RyZWFrSWQiLCJnZW5lcmF0ZVN0cmVha0lkIiwic3RyZWFrc0NvbGxlY3Rpb24iLCJnZXRIYWJpdFN0cmVha3NDb2xsZWN0aW9uIiwic3RyZWFrRG9jIiwiZ2V0RG9jIiwiZG9jIiwiZXhpc3RzIiwicHVzaCIsImlzVmFsaWQiLCJ0cmFuc2Zvcm1GaXJlc3RvcmVUb1N0cmVhayIsImRhdGEiLCJ2YWxpZGF0ZVVzZXJPd25lcnNoaXAiLCJ2YWxpZGF0ZVN0cmVha0RvY3VtZW50Iiwic3RyZWFrVmFsaWRhdGlvbiIsInZhbGlkYXRlU3RyZWFrTG9naWMiLCJhcHBseSIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJtaWxlc3RvbmVWYWxpZGF0aW9uIiwidmFsaWRhdGVNaWxlc3RvbmVzIiwibG9nSW50ZWdyaXR5Q2hlY2siLCJsZW5ndGgiLCJlcnJvciIsInZlcmlmeVN0cmVha0ludGVncml0eSIsIl94IiwiX3gyIiwiX3gzIiwiYXJndW1lbnRzIiwiX3ZlcmlmeUNvbXBsZXRpb25JbnRlZ3JpdHkiLCJjb21wbGV0aW9uSWQiLCJjb21wbGV0aW9uRGF0YSIsImNvbXBsZXRpb24iLCJjb21wbGV0aW9uc0NvbGxlY3Rpb24iLCJnZXRIYWJpdENvbXBsZXRpb25zQ29sbGVjdGlvbiIsImNvbXBsZXRpb25Eb2MiLCJ0cmFuc2Zvcm1GaXJlc3RvcmVUb0NvbXBsZXRpb24iLCJjb21wbGV0aW9uVmFsaWRhdGlvbiIsInZhbGlkYXRlQ29tcGxldGlvbkRhdGEiLCJ2ZXJpZnlDb21wbGV0aW9uSW50ZWdyaXR5IiwiX3g0IiwiX3g1IiwiX3g2IiwiY3VycmVudFN0cmVhayIsImJlc3RTdHJlYWsiLCJPYmplY3QiLCJhc3NpZ24iLCJmcmVlemVzQXZhaWxhYmxlIiwiZnJlZXplc1VzZWQiLCJ0b3RhbEZyZWV6ZXNFYXJuZWQiLCJNYXRoIiwiZmxvb3IiLCJsYXN0Q29tcGxldGlvbkRhdGUiLCJpc1ZhbGlkRGF0ZVN0cmluZyIsInN0cmVha1N0YXJ0RGF0ZSIsInNvcnRlZE1pbGVzdG9uZXMiLCJtaWxlc3RvbmVzIiwic29ydCIsImEiLCJiIiwiZGF5cyIsImlzT3JkZXJlZCIsImV2ZXJ5IiwibWlsZXN0b25lIiwiaW5kZXgiLCJ1bmlxdWVEYXlzIiwiU2V0IiwibWFwIiwibSIsInNpemUiLCJpbnZhbGlkTWlsZXN0b25lcyIsImZpbHRlciIsImludmFsaWRUaW1lc3RhbXBzIiwiYWNoaWV2ZWRBdCIsInRvTWlsbGlzIiwiRGF0ZSIsIm5vdyIsImlkIiwiY29tcGxldGVkQXQiLCJ2YWxpZERpZmZpY3VsdGllcyIsImluY2x1ZGVzIiwiZGlmZmljdWx0eSIsInRpbWV6b25lIiwiaXNWYWxpZFRpbWV6b25lIiwibm90ZXMiLCJfZGV0ZWN0U3VzcGljaW91c0FjdGl2aXR5IiwicmVjZW50Q29tcGxldGlvbnMiLCJmbGFncyIsInJpc2tMZXZlbCIsInJlY2VudENvdW50IiwiYyIsInRpbWVzdGFtcHMiLCJ1bmlxdWVUaW1lc3RhbXBzIiwidGltZXpvbmVzIiwic29ydGVkQnlDcmVhdGlvbiIsInNvcnRlZEJ5Q29tcGxldGlvbiIsImlzUmV0cm9hY3RpdmUiLCJzb21lIiwiX3NvcnRlZEJ5Q29tcGxldGlvbiRpIiwibG9nU3VzcGljaW91c0FjdGl2aXR5IiwiaXNTdXNwaWNpb3VzIiwiY29uc29sZSIsImRldGVjdFN1c3BpY2lvdXNBY3Rpdml0eSIsIl94NyIsIl94OCIsImRhdGVTdHJpbmciLCJyZWdleCIsInRlc3QiLCJkYXRlIiwiaXNOYU4iLCJnZXRUaW1lIiwiSW50bCIsIkRhdGVUaW1lRm9ybWF0IiwidW5kZWZpbmVkIiwidGltZVpvbmUiLCJfdW51c2VkIiwiX2xvZ0ludGVncml0eUNoZWNrIiwidHlwZSIsImVudGl0eUlkIiwicGFzc2VkIiwibG9nRW50cnkiLCJ0aW1lc3RhbXAiLCJleGlzdGluZ0xvZyIsIkFzeW5jU3RvcmFnZSIsImdldEl0ZW0iLCJJTlRFR1JJVFlfTE9HX0tFWSIsImxvZyIsIkpTT04iLCJwYXJzZSIsIk1BWF9MT0dfRU5UUklFUyIsInNwbGljZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJfeDkiLCJfeDAiLCJfeDEiLCJfeDEwIiwiX2xvZ1N1c3BpY2lvdXNBY3Rpdml0eSIsIndhcm4iLCJfeDExIiwiX3gxMiIsIl94MTMiLCJfZ2V0SW50ZWdyaXR5TG9nIiwibG9nRGF0YSIsImdldEludGVncml0eUxvZyIsIl9jbGVhckludGVncml0eUxvZyIsInJlbW92ZUl0ZW0iLCJjbGVhckludGVncml0eUxvZyIsImRhdGFJbnRlZ3JpdHlTZXJ2aWNlIl0sInNvdXJjZXMiOlsiZGF0YUludGVncml0eVNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEYXRhIEludGVncml0eSBTZXJ2aWNlXG4gKlxuICogSGFuZGxlcyBkYXRhIHZhbGlkYXRpb24sIGludGVncml0eSBjaGVja3MsIGFuZCBjb3JydXB0aW9uIGRldGVjdGlvblxuICogUmVxdWlyZW1lbnRzOiAxMi40LCAxMi41XG4gKi9cblxuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tIFwiQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2VcIjtcbmltcG9ydCB7IGRvYywgZ2V0RG9jIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuaW1wb3J0IHsgSGFiaXRDb21wbGV0aW9uLCBIYWJpdFN0cmVhayB9IGZyb20gXCIuLi8uLi90eXBlcy9oYWJpdC1zdHJlYWtzXCI7XG5pbXBvcnQge1xuICAgIGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uLFxuICAgIGdldEhhYml0U3RyZWFrc0NvbGxlY3Rpb24sXG59IGZyb20gXCIuL2NvbGxlY3Rpb25zXCI7XG5pbXBvcnQge1xuICAgIGdlbmVyYXRlU3RyZWFrSWQsXG4gICAgdHJhbnNmb3JtRmlyZXN0b3JlVG9Db21wbGV0aW9uLFxuICAgIHRyYW5zZm9ybUZpcmVzdG9yZVRvU3RyZWFrLFxuICAgIHZhbGlkYXRlU3RyZWFrRG9jdW1lbnQsXG4gICAgdmFsaWRhdGVVc2VyT3duZXJzaGlwLFxufSBmcm9tIFwiLi9oYWJpdFN0cmVha1NjaGVtYXNcIjtcblxuLyoqXG4gKiBJbnRlZ3JpdHkgY2hlY2sgcmVzdWx0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW50ZWdyaXR5Q2hlY2tSZXN1bHQge1xuICAgIGlzVmFsaWQ6IGJvb2xlYW47XG4gICAgZXJyb3JzOiBzdHJpbmdbXTtcbiAgICB3YXJuaW5nczogc3RyaW5nW107XG4gICAgY29ycmVjdGVkRGF0YT86IGFueTtcbn1cblxuLyoqXG4gKiBEYXRhIHZhbGlkYXRpb24gcnVsZXNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0aW9uUnVsZTxUPiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHZhbGlkYXRlOiAoZGF0YTogVCkgPT4gYm9vbGVhbjtcbiAgICBlcnJvck1lc3NhZ2U6IHN0cmluZztcbn1cblxuLyoqXG4gKiBEYXRhIEludGVncml0eSBTZXJ2aWNlIEltcGxlbWVudGF0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBEYXRhSW50ZWdyaXR5U2VydmljZSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgSU5URUdSSVRZX0xPR19LRVkgPSBcIkBpbnRlZ3JpdHlfY2hlY2tzX2xvZ1wiO1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1BWF9MT0dfRU5UUklFUyA9IDEwMDtcblxuICAgIC8qKlxuICAgICAqIFZlcmlmeSBzdHJlYWsgZGF0YSBpbnRlZ3JpdHkgYmVmb3JlIGRpc3BsYXlcbiAgICAgKiBSZXF1aXJlbWVudHM6IDEyLjRcbiAgICAgKi9cbiAgICBhc3luYyB2ZXJpZnlTdHJlYWtJbnRlZ3JpdHkoXG4gICAgICAgIGhhYml0SWQ6IHN0cmluZyxcbiAgICAgICAgdXNlcklkOiBzdHJpbmcsXG4gICAgICAgIHN0cmVha0RhdGE/OiBIYWJpdFN0cmVhayxcbiAgICApOiBQcm9taXNlPEludGVncml0eUNoZWNrUmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBjb3JyZWN0ZWREYXRhOiBIYWJpdFN0cmVhayB8IHVuZGVmaW5lZDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHN0cmVhayBkYXRhIGlmIG5vdCBwcm92aWRlZFxuICAgICAgICAgICAgbGV0IHN0cmVhayA9IHN0cmVha0RhdGE7XG4gICAgICAgICAgICBpZiAoIXN0cmVhaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha0lkID0gZ2VuZXJhdGVTdHJlYWtJZCh1c2VySWQsIGhhYml0SWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha3NDb2xsZWN0aW9uID0gZ2V0SGFiaXRTdHJlYWtzQ29sbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVha0RvYyA9IGF3YWl0IGdldERvYyhkb2Moc3RyZWFrc0NvbGxlY3Rpb24sIHN0cmVha0lkKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXN0cmVha0RvYy5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChcIlN0cmVhayBkb2N1bWVudCBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMsIHdhcm5pbmdzIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RyZWFrID0gdHJhbnNmb3JtRmlyZXN0b3JlVG9TdHJlYWsoc3RyZWFrRG9jLmRhdGEoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHVzZXIgb3duZXJzaGlwXG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRlVXNlck93bmVyc2hpcCh1c2VySWQsIHN0cmVhay51c2VySWQpKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJVc2VyIG93bmVyc2hpcCB2YWxpZGF0aW9uIGZhaWxlZFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgc3RyZWFrIGRvY3VtZW50IHN0cnVjdHVyZVxuICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZVN0cmVha0RvY3VtZW50KHN0cmVhaykpIHtcbiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChcIlN0cmVhayBkb2N1bWVudCBzdHJ1Y3R1cmUgaXMgaW52YWxpZFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgc3RyZWFrIGxvZ2ljXG4gICAgICAgICAgICBjb25zdCBzdHJlYWtWYWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZVN0cmVha0xvZ2ljKHN0cmVhayk7XG4gICAgICAgICAgICBpZiAoIXN0cmVha1ZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKC4uLnN0cmVha1ZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICAgICAgICAgICAgICB3YXJuaW5ncy5wdXNoKC4uLnN0cmVha1ZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgICAgICAgICAgICAgIGNvcnJlY3RlZERhdGEgPSBzdHJlYWtWYWxpZGF0aW9uLmNvcnJlY3RlZERhdGE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIG1pbGVzdG9uZSBjb25zaXN0ZW5jeVxuICAgICAgICAgICAgY29uc3QgbWlsZXN0b25lVmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVNaWxlc3RvbmVzKHN0cmVhayk7XG4gICAgICAgICAgICBpZiAoIW1pbGVzdG9uZVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKC4uLm1pbGVzdG9uZVZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICAgICAgICAgICAgICB3YXJuaW5ncy5wdXNoKC4uLm1pbGVzdG9uZVZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMb2cgaW50ZWdyaXR5IGNoZWNrXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmxvZ0ludGVncml0eUNoZWNrKFxuICAgICAgICAgICAgICAgIFwic3RyZWFrXCIsXG4gICAgICAgICAgICAgICAgaGFiaXRJZCxcbiAgICAgICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICAgICAgZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgICAgICBlcnJvcnMsXG4gICAgICAgICAgICAgICAgd2FybmluZ3MsXG4gICAgICAgICAgICAgICAgY29ycmVjdGVkRGF0YSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChgSW50ZWdyaXR5IGNoZWNrIGZhaWxlZDogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMsIHdhcm5pbmdzIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWZXJpZnkgY29tcGxldGlvbiBkYXRhIGludGVncml0eVxuICAgICAqIFJlcXVpcmVtZW50czogMTIuNFxuICAgICAqL1xuICAgIGFzeW5jIHZlcmlmeUNvbXBsZXRpb25JbnRlZ3JpdHkoXG4gICAgICAgIGNvbXBsZXRpb25JZDogc3RyaW5nLFxuICAgICAgICB1c2VySWQ6IHN0cmluZyxcbiAgICAgICAgY29tcGxldGlvbkRhdGE/OiBIYWJpdENvbXBsZXRpb24sXG4gICAgKTogUHJvbWlzZTxJbnRlZ3JpdHlDaGVja1Jlc3VsdD4ge1xuICAgICAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgY29tcGxldGlvbiBkYXRhIGlmIG5vdCBwcm92aWRlZFxuICAgICAgICAgICAgbGV0IGNvbXBsZXRpb24gPSBjb21wbGV0aW9uRGF0YTtcbiAgICAgICAgICAgIGlmICghY29tcGxldGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25zQ29sbGVjdGlvbiA9IGdldEhhYml0Q29tcGxldGlvbnNDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGxldGlvbkRvYyA9IGF3YWl0IGdldERvYyhcbiAgICAgICAgICAgICAgICAgICAgZG9jKGNvbXBsZXRpb25zQ29sbGVjdGlvbiwgY29tcGxldGlvbklkKSxcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjb21wbGV0aW9uRG9jLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKFwiQ29tcGxldGlvbiBkb2N1bWVudCBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMsIHdhcm5pbmdzIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29tcGxldGlvbiA9IHRyYW5zZm9ybUZpcmVzdG9yZVRvQ29tcGxldGlvbihcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGlvbklkLFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uRG9jLmRhdGEoKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB1c2VyIG93bmVyc2hpcFxuICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZVVzZXJPd25lcnNoaXAodXNlcklkLCBjb21wbGV0aW9uLnVzZXJJZCkpIHtcbiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChcIlVzZXIgb3duZXJzaGlwIHZhbGlkYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21wbGV0aW9uIGRhdGFcbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRpb25WYWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbXBsZXRpb25EYXRhKGNvbXBsZXRpb24pO1xuICAgICAgICAgICAgaWYgKCFjb21wbGV0aW9uVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goLi4uY29tcGxldGlvblZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICAgICAgICAgICAgICB3YXJuaW5ncy5wdXNoKC4uLmNvbXBsZXRpb25WYWxpZGF0aW9uLndhcm5pbmdzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9nIGludGVncml0eSBjaGVja1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2dJbnRlZ3JpdHlDaGVjayhcbiAgICAgICAgICAgICAgICBcImNvbXBsZXRpb25cIixcbiAgICAgICAgICAgICAgICBjb21wbGV0aW9uSWQsXG4gICAgICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgICAgIGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICAgICAgZXJyb3JzLFxuICAgICAgICAgICAgICAgIHdhcm5pbmdzLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKGBJbnRlZ3JpdHkgY2hlY2sgZmFpbGVkOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9ycywgd2FybmluZ3MgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHN0cmVhayBsb2dpYyBhbmQgY29uc2lzdGVuY3lcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlU3RyZWFrTG9naWMoc3RyZWFrOiBIYWJpdFN0cmVhayk6IEludGVncml0eUNoZWNrUmVzdWx0IHtcbiAgICAgICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGV0IGNvcnJlY3RlZERhdGE6IEhhYml0U3RyZWFrIHwgdW5kZWZpbmVkO1xuXG4gICAgICAgIC8vIFJ1bGUgMTogQ3VycmVudCBzdHJlYWsgc2hvdWxkIG5vdCBleGNlZWQgYmVzdCBzdHJlYWtcbiAgICAgICAgaWYgKHN0cmVhay5jdXJyZW50U3RyZWFrID4gc3RyZWFrLmJlc3RTdHJlYWspIHtcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goXG4gICAgICAgICAgICAgICAgXCJDdXJyZW50IHN0cmVhayBleGNlZWRzIGJlc3Qgc3RyZWFrIC0gY29ycmVjdGluZyBiZXN0IHN0cmVha1wiLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvcnJlY3RlZERhdGEgPSB7XG4gICAgICAgICAgICAgICAgLi4uc3RyZWFrLFxuICAgICAgICAgICAgICAgIGJlc3RTdHJlYWs6IHN0cmVhay5jdXJyZW50U3RyZWFrLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1bGUgMjogU3RyZWFrIHZhbHVlcyBzaG91bGQgYmUgbm9uLW5lZ2F0aXZlXG4gICAgICAgIGlmIChzdHJlYWsuY3VycmVudFN0cmVhayA8IDAgfHwgc3RyZWFrLmJlc3RTdHJlYWsgPCAwKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChcIlN0cmVhayB2YWx1ZXMgY2Fubm90IGJlIG5lZ2F0aXZlXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUnVsZSAzOiBGcmVlemUgY291bnRzIHNob3VsZCBiZSBub24tbmVnYXRpdmVcbiAgICAgICAgaWYgKHN0cmVhay5mcmVlemVzQXZhaWxhYmxlIDwgMCB8fCBzdHJlYWsuZnJlZXplc1VzZWQgPCAwKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChcIkZyZWV6ZSBjb3VudHMgY2Fubm90IGJlIG5lZ2F0aXZlXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUnVsZSA0OiBVc2VkIGZyZWV6ZXMgc2hvdWxkIG5vdCBleGNlZWQgYXZhaWxhYmxlICsgdXNlZCB0b3RhbFxuICAgICAgICBjb25zdCB0b3RhbEZyZWV6ZXNFYXJuZWQgPSBNYXRoLmZsb29yKHN0cmVhay5iZXN0U3RyZWFrIC8gMzApOyAvLyBBc3N1bWluZyAxIGZyZWV6ZSBwZXIgMzAgZGF5c1xuICAgICAgICBpZiAoc3RyZWFrLmZyZWV6ZXNVc2VkID4gdG90YWxGcmVlemVzRWFybmVkKSB7XG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKFxuICAgICAgICAgICAgICAgIFwiRnJlZXplIHVzYWdlIGV4Y2VlZHMgdGhlb3JldGljYWwgbWF4aW11bSBiYXNlZCBvbiBtaWxlc3RvbmVzXCIsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUnVsZSA1OiBWYWxpZGF0ZSBkYXRlIGZvcm1hdHNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgc3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSAmJlxuICAgICAgICAgICAgIXRoaXMuaXNWYWxpZERhdGVTdHJpbmcoc3RyZWFrLmxhc3RDb21wbGV0aW9uRGF0ZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChcIkludmFsaWQgbGFzdCBjb21wbGV0aW9uIGRhdGUgZm9ybWF0XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgc3RyZWFrLnN0cmVha1N0YXJ0RGF0ZSAmJlxuICAgICAgICAgICAgIXRoaXMuaXNWYWxpZERhdGVTdHJpbmcoc3RyZWFrLnN0cmVha1N0YXJ0RGF0ZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChcIkludmFsaWQgc3RyZWFrIHN0YXJ0IGRhdGUgZm9ybWF0XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICBlcnJvcnMsXG4gICAgICAgICAgICB3YXJuaW5ncyxcbiAgICAgICAgICAgIGNvcnJlY3RlZERhdGEsXG4gICAgICAgIH07XG4gICAgfSAvKipcblxuICAgICAqIFZhbGlkYXRlIG1pbGVzdG9uZSBjb25zaXN0ZW5jeVxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVNaWxlc3RvbmVzKHN0cmVhazogSGFiaXRTdHJlYWspOiBJbnRlZ3JpdHlDaGVja1Jlc3VsdCB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgLy8gUnVsZSAxOiBNaWxlc3RvbmVzIHNob3VsZCBiZSBpbiBhc2NlbmRpbmcgb3JkZXJcbiAgICAgICAgY29uc3Qgc29ydGVkTWlsZXN0b25lcyA9IFsuLi5zdHJlYWsubWlsZXN0b25lc10uc29ydChcbiAgICAgICAgICAgIChhLCBiKSA9PiBhLmRheXMgLSBiLmRheXMsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGlzT3JkZXJlZCA9IHN0cmVhay5taWxlc3RvbmVzLmV2ZXJ5KFxuICAgICAgICAgICAgKG1pbGVzdG9uZSwgaW5kZXgpID0+IG1pbGVzdG9uZS5kYXlzID09PSBzb3J0ZWRNaWxlc3RvbmVzW2luZGV4XS5kYXlzLFxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghaXNPcmRlcmVkKSB7XG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKFwiTWlsZXN0b25lcyBhcmUgbm90IGluIGFzY2VuZGluZyBvcmRlclwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1bGUgMjogTm8gZHVwbGljYXRlIG1pbGVzdG9uZSBkYXlzXG4gICAgICAgIGNvbnN0IHVuaXF1ZURheXMgPSBuZXcgU2V0KHN0cmVhay5taWxlc3RvbmVzLm1hcCgobSkgPT4gbS5kYXlzKSk7XG4gICAgICAgIGlmICh1bmlxdWVEYXlzLnNpemUgIT09IHN0cmVhay5taWxlc3RvbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJEdXBsaWNhdGUgbWlsZXN0b25lIGRheXMgZm91bmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdWxlIDM6IE1pbGVzdG9uZSBkYXlzIHNob3VsZCBub3QgZXhjZWVkIGJlc3Qgc3RyZWFrXG4gICAgICAgIGNvbnN0IGludmFsaWRNaWxlc3RvbmVzID0gc3RyZWFrLm1pbGVzdG9uZXMuZmlsdGVyKFxuICAgICAgICAgICAgKG0pID0+IG0uZGF5cyA+IHN0cmVhay5iZXN0U3RyZWFrLFxuICAgICAgICApO1xuICAgICAgICBpZiAoaW52YWxpZE1pbGVzdG9uZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgd2FybmluZ3MucHVzaChcbiAgICAgICAgICAgICAgICBgJHtpbnZhbGlkTWlsZXN0b25lcy5sZW5ndGh9IG1pbGVzdG9uZXMgZXhjZWVkIGJlc3Qgc3RyZWFrYCxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdWxlIDQ6IFZhbGlkYXRlIG1pbGVzdG9uZSB0aW1lc3RhbXBzXG4gICAgICAgIGNvbnN0IGludmFsaWRUaW1lc3RhbXBzID0gc3RyZWFrLm1pbGVzdG9uZXMuZmlsdGVyKFxuICAgICAgICAgICAgKG0pID0+ICFtLmFjaGlldmVkQXQgfHwgbS5hY2hpZXZlZEF0LnRvTWlsbGlzKCkgPiBEYXRlLm5vdygpLFxuICAgICAgICApO1xuICAgICAgICBpZiAoaW52YWxpZFRpbWVzdGFtcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJJbnZhbGlkIG1pbGVzdG9uZSB0aW1lc3RhbXBzIGZvdW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICBlcnJvcnMsXG4gICAgICAgICAgICB3YXJuaW5ncyxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBjb21wbGV0aW9uIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tcGxldGlvbkRhdGEoXG4gICAgICAgIGNvbXBsZXRpb246IEhhYml0Q29tcGxldGlvbixcbiAgICApOiBJbnRlZ3JpdHlDaGVja1Jlc3VsdCB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgLy8gUnVsZSAxOiBSZXF1aXJlZCBmaWVsZHMgc2hvdWxkIGJlIHByZXNlbnRcbiAgICAgICAgaWYgKCFjb21wbGV0aW9uLmlkIHx8ICFjb21wbGV0aW9uLmhhYml0SWQgfHwgIWNvbXBsZXRpb24udXNlcklkKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChcIk1pc3NpbmcgcmVxdWlyZWQgY29tcGxldGlvbiBmaWVsZHNcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdWxlIDI6IENvbXBsZXRpb24gdGltZXN0YW1wIHNob3VsZCBub3QgYmUgaW4gdGhlIGZ1dHVyZVxuICAgICAgICBpZiAoY29tcGxldGlvbi5jb21wbGV0ZWRBdC50b01pbGxpcygpID4gRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJDb21wbGV0aW9uIHRpbWVzdGFtcCBpcyBpbiB0aGUgZnV0dXJlXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUnVsZSAzOiBWYWxpZGF0ZSBkaWZmaWN1bHR5IGxldmVsXG4gICAgICAgIGNvbnN0IHZhbGlkRGlmZmljdWx0aWVzID0gW1wiZWFzeVwiLCBcIm1lZGl1bVwiLCBcImhhcmRcIl07XG4gICAgICAgIGlmICghdmFsaWREaWZmaWN1bHRpZXMuaW5jbHVkZXMoY29tcGxldGlvbi5kaWZmaWN1bHR5KSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJJbnZhbGlkIGRpZmZpY3VsdHkgbGV2ZWxcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdWxlIDQ6IFZhbGlkYXRlIHRpbWV6b25lIGZvcm1hdFxuICAgICAgICBpZiAoY29tcGxldGlvbi50aW1lem9uZSAmJiAhdGhpcy5pc1ZhbGlkVGltZXpvbmUoY29tcGxldGlvbi50aW1lem9uZSkpIHtcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goXCJJbnZhbGlkIHRpbWV6b25lIGZvcm1hdFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1bGUgNTogTm90ZXMgc2hvdWxkIG5vdCBiZSBleGNlc3NpdmVseSBsb25nXG4gICAgICAgIGlmIChjb21wbGV0aW9uLm5vdGVzICYmIGNvbXBsZXRpb24ubm90ZXMubGVuZ3RoID4gNTAwKSB7XG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKFwiQ29tcGxldGlvbiBub3RlcyBhcmUgdW51c3VhbGx5IGxvbmdcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIGVycm9ycyxcbiAgICAgICAgICAgIHdhcm5pbmdzLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdCBhbmQgZmxhZyBzdXNwaWNpb3VzIGFjdGl2aXR5XG4gICAgICogUmVxdWlyZW1lbnRzOiAxMi41XG4gICAgICovXG4gICAgYXN5bmMgZGV0ZWN0U3VzcGljaW91c0FjdGl2aXR5KFxuICAgICAgICB1c2VySWQ6IHN0cmluZyxcbiAgICAgICAgcmVjZW50Q29tcGxldGlvbnM6IEhhYml0Q29tcGxldGlvbltdLFxuICAgICk6IFByb21pc2U8e1xuICAgICAgICBpc1N1c3BpY2lvdXM6IGJvb2xlYW47XG4gICAgICAgIGZsYWdzOiBzdHJpbmdbXTtcbiAgICAgICAgcmlza0xldmVsOiBcImxvd1wiIHwgXCJtZWRpdW1cIiB8IFwiaGlnaFwiO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZmxhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCByaXNrTGV2ZWw6IFwibG93XCIgfCBcIm1lZGl1bVwiIHwgXCJoaWdoXCIgPSBcImxvd1wiO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGbGFnIDE6IFRvbyBtYW55IGNvbXBsZXRpb25zIGluIGEgc2hvcnQgdGltZVxuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudENvdW50ID0gcmVjZW50Q29tcGxldGlvbnMuZmlsdGVyKFxuICAgICAgICAgICAgICAgIChjKSA9PiBub3cgLSBjLmNvbXBsZXRlZEF0LnRvTWlsbGlzKCkgPCA2MCAqIDYwICogMTAwMCwgLy8gTGFzdCBob3VyXG4gICAgICAgICAgICApLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHJlY2VudENvdW50ID4gMTApIHtcbiAgICAgICAgICAgICAgICBmbGFncy5wdXNoKFwiRXhjZXNzaXZlIGNvbXBsZXRpb25zIGluIHNob3J0IHRpbWVmcmFtZVwiKTtcbiAgICAgICAgICAgICAgICByaXNrTGV2ZWwgPSBcImhpZ2hcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZW50Q291bnQgPiA1KSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MucHVzaChcIkhpZ2ggY29tcGxldGlvbiBmcmVxdWVuY3lcIik7XG4gICAgICAgICAgICAgICAgcmlza0xldmVsID0gXCJtZWRpdW1cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmxhZyAyOiBDb21wbGV0aW9ucyB3aXRoIGlkZW50aWNhbCB0aW1lc3RhbXBzXG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXBzID0gcmVjZW50Q29tcGxldGlvbnMubWFwKChjKSA9PiBjLmNvbXBsZXRlZEF0LnRvTWlsbGlzKCkpO1xuICAgICAgICAgICAgY29uc3QgdW5pcXVlVGltZXN0YW1wcyA9IG5ldyBTZXQodGltZXN0YW1wcyk7XG4gICAgICAgICAgICBpZiAodW5pcXVlVGltZXN0YW1wcy5zaXplIDwgdGltZXN0YW1wcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmbGFncy5wdXNoKFwiRHVwbGljYXRlIGNvbXBsZXRpb24gdGltZXN0YW1wc1wiKTtcbiAgICAgICAgICAgICAgICByaXNrTGV2ZWwgPSBcImhpZ2hcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmxhZyAzOiBDb21wbGV0aW9ucyBmcm9tIG11bHRpcGxlIHRpbWV6b25lcyByYXBpZGx5XG4gICAgICAgICAgICBjb25zdCB0aW1lem9uZXMgPSBuZXcgU2V0KHJlY2VudENvbXBsZXRpb25zLm1hcCgoYykgPT4gYy50aW1lem9uZSkpO1xuICAgICAgICAgICAgaWYgKHRpbWV6b25lcy5zaXplID4gMykge1xuICAgICAgICAgICAgICAgIGZsYWdzLnB1c2goXCJDb21wbGV0aW9ucyBmcm9tIG11bHRpcGxlIHRpbWV6b25lc1wiKTtcbiAgICAgICAgICAgICAgICByaXNrTGV2ZWwgPSBcIm1lZGl1bVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGbGFnIDQ6IFJldHJvYWN0aXZlIGNvbXBsZXRpb25zIHBhdHRlcm5cbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZEJ5Q3JlYXRpb24gPSBbLi4ucmVjZW50Q29tcGxldGlvbnNdLnNvcnQoXG4gICAgICAgICAgICAgICAgKGEsIGIpID0+IGEuY29tcGxldGVkQXQudG9NaWxsaXMoKSAtIGIuY29tcGxldGVkQXQudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBzb3J0ZWRCeUNvbXBsZXRpb24gPSBbLi4ucmVjZW50Q29tcGxldGlvbnNdLnNvcnQoXG4gICAgICAgICAgICAgICAgKGEsIGIpID0+IGEuY29tcGxldGVkQXQudG9NaWxsaXMoKSAtIGIuY29tcGxldGVkQXQudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGlzUmV0cm9hY3RpdmUgPSBzb3J0ZWRCeUNyZWF0aW9uLnNvbWUoXG4gICAgICAgICAgICAgICAgKGNvbXBsZXRpb24sIGluZGV4KSA9PiBjb21wbGV0aW9uLmlkICE9PSBzb3J0ZWRCeUNvbXBsZXRpb25baW5kZXhdPy5pZCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChpc1JldHJvYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MucHVzaChcIlBhdHRlcm4gb2YgcmV0cm9hY3RpdmUgY29tcGxldGlvbnNcIik7XG4gICAgICAgICAgICAgICAgaWYgKHJpc2tMZXZlbCA9PT0gXCJsb3dcIikgcmlza0xldmVsID0gXCJtZWRpdW1cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9nIHN1c3BpY2lvdXMgYWN0aXZpdHlcbiAgICAgICAgICAgIGlmIChmbGFncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2dTdXNwaWNpb3VzQWN0aXZpdHkodXNlcklkLCBmbGFncywgcmlza0xldmVsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc1N1c3BpY2lvdXM6IGZsYWdzLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICAgICAgZmxhZ3MsXG4gICAgICAgICAgICAgICAgcmlza0xldmVsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZXRlY3Rpbmcgc3VzcGljaW91cyBhY3Rpdml0eTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc1N1c3BpY2lvdXM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGZsYWdzOiBbXSxcbiAgICAgICAgICAgICAgICByaXNrTGV2ZWw6IFwibG93XCIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGF0ZSBzdHJpbmcgZm9ybWF0IChZWVlZLU1NLUREKVxuICAgICAqL1xuICAgIHByaXZhdGUgaXNWYWxpZERhdGVTdHJpbmcoZGF0ZVN0cmluZzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvO1xuICAgICAgICBpZiAoIXJlZ2V4LnRlc3QoZGF0ZVN0cmluZykpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7XG4gICAgICAgIHJldHVybiBkYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiAhaXNOYU4oZGF0ZS5nZXRUaW1lKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHRpbWV6b25lIGZvcm1hdFxuICAgICAqL1xuICAgIHByaXZhdGUgaXNWYWxpZFRpbWV6b25lKHRpbWV6b25lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIEludGwuRGF0ZVRpbWVGb3JtYXQodW5kZWZpbmVkLCB7IHRpbWVab25lOiB0aW1lem9uZSB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZyBpbnRlZ3JpdHkgY2hlY2sgcmVzdWx0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2dJbnRlZ3JpdHlDaGVjayhcbiAgICAgICAgdHlwZTogc3RyaW5nLFxuICAgICAgICBlbnRpdHlJZDogc3RyaW5nLFxuICAgICAgICB1c2VySWQ6IHN0cmluZyxcbiAgICAgICAgcGFzc2VkOiBib29sZWFuLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbG9nRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICAgICAgZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgICAgIHBhc3NlZCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIEdldCBleGlzdGluZyBsb2dcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTG9nID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oXG4gICAgICAgICAgICAgICAgRGF0YUludGVncml0eVNlcnZpY2UuSU5URUdSSVRZX0xPR19LRVksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgbG9nID0gZXhpc3RpbmdMb2cgPyBKU09OLnBhcnNlKGV4aXN0aW5nTG9nKSA6IFtdO1xuXG4gICAgICAgICAgICAvLyBBZGQgbmV3IGVudHJ5XG4gICAgICAgICAgICBsb2cucHVzaChsb2dFbnRyeSk7XG5cbiAgICAgICAgICAgIC8vIEtlZXAgb25seSByZWNlbnQgZW50cmllc1xuICAgICAgICAgICAgaWYgKGxvZy5sZW5ndGggPiBEYXRhSW50ZWdyaXR5U2VydmljZS5NQVhfTE9HX0VOVFJJRVMpIHtcbiAgICAgICAgICAgICAgICBsb2cuc3BsaWNlKDAsIGxvZy5sZW5ndGggLSBEYXRhSW50ZWdyaXR5U2VydmljZS5NQVhfTE9HX0VOVFJJRVMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTYXZlIHVwZGF0ZWQgbG9nXG4gICAgICAgICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShcbiAgICAgICAgICAgICAgICBEYXRhSW50ZWdyaXR5U2VydmljZS5JTlRFR1JJVFlfTE9HX0tFWSxcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShsb2cpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9nIGludGVncml0eSBjaGVjazpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9nIHN1c3BpY2lvdXMgYWN0aXZpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvZ1N1c3BpY2lvdXNBY3Rpdml0eShcbiAgICAgICAgdXNlcklkOiBzdHJpbmcsXG4gICAgICAgIGZsYWdzOiBzdHJpbmdbXSxcbiAgICAgICAgcmlza0xldmVsOiBzdHJpbmcsXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsb2dFbnRyeSA9IHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgICAgIGZsYWdzLFxuICAgICAgICAgICAgICAgIHJpc2tMZXZlbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN1c3BpY2lvdXNfYWN0aXZpdHlcIixcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlN1c3BpY2lvdXMgYWN0aXZpdHkgZGV0ZWN0ZWQ6XCIsIGxvZ0VudHJ5KTtcblxuICAgICAgICAgICAgLy8gSW4gYSBwcm9kdWN0aW9uIGFwcCwgdGhpcyB3b3VsZCBhbHNvIHNlbmQgdG8gYSBtb25pdG9yaW5nIHNlcnZpY2VcbiAgICAgICAgICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgbG9nIGxvY2FsbHlcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTG9nID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oXG4gICAgICAgICAgICAgICAgRGF0YUludGVncml0eVNlcnZpY2UuSU5URUdSSVRZX0xPR19LRVksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgbG9nID0gZXhpc3RpbmdMb2cgPyBKU09OLnBhcnNlKGV4aXN0aW5nTG9nKSA6IFtdO1xuICAgICAgICAgICAgbG9nLnB1c2gobG9nRW50cnkpO1xuXG4gICAgICAgICAgICBpZiAobG9nLmxlbmd0aCA+IERhdGFJbnRlZ3JpdHlTZXJ2aWNlLk1BWF9MT0dfRU5UUklFUykge1xuICAgICAgICAgICAgICAgIGxvZy5zcGxpY2UoMCwgbG9nLmxlbmd0aCAtIERhdGFJbnRlZ3JpdHlTZXJ2aWNlLk1BWF9MT0dfRU5UUklFUyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAgICAgICAgIERhdGFJbnRlZ3JpdHlTZXJ2aWNlLklOVEVHUklUWV9MT0dfS0VZLFxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGxvZyksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBsb2cgc3VzcGljaW91cyBhY3Rpdml0eTpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGludGVncml0eSBjaGVjayBoaXN0b3J5XG4gICAgICovXG4gICAgYXN5bmMgZ2V0SW50ZWdyaXR5TG9nKCk6IFByb21pc2U8YW55W10+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGxvZ0RhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShcbiAgICAgICAgICAgICAgICBEYXRhSW50ZWdyaXR5U2VydmljZS5JTlRFR1JJVFlfTE9HX0tFWSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gbG9nRGF0YSA/IEpTT04ucGFyc2UobG9nRGF0YSkgOiBbXTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IGludGVncml0eSBsb2c6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGludGVncml0eSBsb2dcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckludGVncml0eUxvZygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKERhdGFJbnRlZ3JpdHlTZXJ2aWNlLklOVEVHUklUWV9MT0dfS0VZKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2xlYXIgaW50ZWdyaXR5IGxvZzpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgZGF0YUludGVncml0eVNlcnZpY2UgPSBuZXcgRGF0YUludGVncml0eVNlcnZpY2UoKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7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