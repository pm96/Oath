2931d2eca179480493071d45b84fb63d
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var fc = _interopRequireWildcard(require("fast-check"));
var userIdArb = fc.oneof(fc.constant("user-1"), fc.constant("user-2"), fc.constant("user-3"), fc.constant("user-4"), fc.constant("user-5"));
var goalIdArb = fc.oneof(fc.constant("goal-1"), fc.constant("goal-2"), fc.constant("goal-3"), fc.constant("goal-4"));
var nudgeIdArb = fc.oneof(fc.constant("nudge-1"), fc.constant("nudge-2"), fc.constant("nudge-3"));
var testUserArb = fc.record({
  userId: userIdArb,
  friends: fc.array(userIdArb, {
    maxLength: 3
  }),
  displayName: fc.constant("Test User"),
  email: fc.constant("test@example.com")
});
var testGoalArb = fc.record({
  goalId: goalIdArb,
  ownerId: userIdArb,
  description: fc.constant("Test goal"),
  isShared: fc.boolean(),
  type: fc.constantFrom("flexible", "time"),
  targetTime: fc.option(fc.constant("07:00"), {
    nil: null
  })
});
var testNudgeArb = fc.record({
  nudgeId: nudgeIdArb,
  senderId: userIdArb,
  receiverId: userIdArb,
  goalId: goalIdArb,
  goalDescription: fc.constant("Test goal description")
});
var authContextArb = fc.record({
  uid: fc.option(userIdArb, {
    nil: null
  }),
  isAuthenticated: fc.boolean()
});
function canReadGoal(authContext, goal, users) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  if (goal.ownerId === authContext.uid) {
    return true;
  }
  var goalOwner = users.find(function (u) {
    return u.userId === goal.ownerId;
  });
  if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
    return true;
  }
  return false;
}
function canReadNudge(authContext, nudge) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  return nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid;
}
function canCreateNudge(authContext, nudge, users) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return false;
  }
  if (nudge.senderId !== authContext.uid) {
    return false;
  }
  var sender = users.find(function (u) {
    return u.userId === authContext.uid;
  });
  if (!sender || !sender.friends.includes(nudge.receiverId)) {
    return false;
  }
  return true;
}
function canAccessNudgeHistory(authContext, nudges, userId) {
  if (!authContext.isAuthenticated || !authContext.uid) {
    return [];
  }
  return nudges.filter(function (nudge) {
    return nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid;
  });
}
describe("Security Rules Property-Based Tests", function () {
  describe("Property 29: Feed access authorization", function () {
    it("should only allow reading goals belonging to friends or self", function () {
      fc.assert(fc.property(authContextArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, goal, users) {
        var canRead = canReadGoal(authContext, goal, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canRead).toBe(false);
          return;
        }
        if (goal.ownerId === authContext.uid) {
          expect(canRead).toBe(true);
          return;
        }
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
          expect(canRead).toBe(true);
        } else {
          expect(canRead).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
    it("should deny access to goals of non-friends", function () {
      fc.assert(fc.property(userIdArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (currentUserId, goal, users) {
        fc.pre(goal.ownerId !== currentUserId);
        var authContext = {
          uid: currentUserId,
          isAuthenticated: true
        };
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        fc.pre(!!goalOwner && !goalOwner.friends.includes(currentUserId));
        var canRead = canReadGoal(authContext, goal, users);
        expect(canRead).toBe(false);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 30: Nudge authorization", function () {
    it("should only allow creating nudges to friends", function () {
      fc.assert(fc.property(authContextArb, testNudgeArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, nudge, users) {
        var canCreate = canCreateNudge(authContext, nudge, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canCreate).toBe(false);
          return;
        }
        if (nudge.senderId !== authContext.uid) {
          expect(canCreate).toBe(false);
          return;
        }
        var sender = users.find(function (u) {
          return u.userId === authContext.uid;
        });
        if (sender && sender.friends.includes(nudge.receiverId)) {
          expect(canCreate).toBe(true);
        } else {
          expect(canCreate).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
    it("should deny nudge creation to non-friends", function () {
      fc.assert(fc.property(userIdArb, userIdArb, goalIdArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (senderId, receiverId, goalId, users) {
        fc.pre(senderId !== receiverId);
        var sender = users.find(function (u) {
          return u.userId === senderId;
        });
        fc.pre(!!sender && !sender.friends.includes(receiverId));
        var authContext = {
          uid: senderId,
          isAuthenticated: true
        };
        var nudge = {
          nudgeId: "test-nudge",
          senderId: senderId,
          receiverId: receiverId,
          goalId: goalId,
          goalDescription: "Test goal"
        };
        var canCreate = canCreateNudge(authContext, nudge, users);
        expect(canCreate).toBe(false);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 31: Goal detail access authorization", function () {
    it("should allow goal detail access only to owner or friends", function () {
      fc.assert(fc.property(authContextArb, testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (authContext, goal, users) {
        var canAccess = canReadGoal(authContext, goal, users);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(canAccess).toBe(false);
          return;
        }
        if (goal.ownerId === authContext.uid) {
          expect(canAccess).toBe(true);
          return;
        }
        var goalOwner = users.find(function (u) {
          return u.userId === goal.ownerId;
        });
        if (goalOwner && goalOwner.friends.includes(authContext.uid)) {
          expect(canAccess).toBe(true);
        } else {
          expect(canAccess).toBe(false);
        }
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 32: Nudge history authorization", function () {
    it("should only return nudges where user is sender or receiver", function () {
      fc.assert(fc.property(authContextArb, fc.array(testNudgeArb, {
        minLength: 0,
        maxLength: 10
      }), userIdArb, function (authContext, allNudges, queryUserId) {
        var accessibleNudges = canAccessNudgeHistory(authContext, allNudges, queryUserId);
        if (!authContext.isAuthenticated || !authContext.uid) {
          expect(accessibleNudges).toEqual([]);
          return;
        }
        for (var nudge of accessibleNudges) {
          expect(nudge.senderId === authContext.uid || nudge.receiverId === authContext.uid).toBe(true);
        }
      }), {
        numRuns: 20
      });
    });
    it("should exclude nudges where user is neither sender nor receiver", function () {
      fc.assert(fc.property(userIdArb, fc.array(testNudgeArb, {
        minLength: 1,
        maxLength: 10
      }), function (currentUserId, allNudges) {
        var unrelatedNudges = allNudges.filter(function (nudge) {
          return nudge.senderId !== currentUserId && nudge.receiverId !== currentUserId;
        });
        fc.pre(unrelatedNudges.length > 0);
        var authContext = {
          uid: currentUserId,
          isAuthenticated: true
        };
        var accessibleNudges = canAccessNudgeHistory(authContext, unrelatedNudges, currentUserId);
        expect(accessibleNudges).toEqual([]);
      }), {
        numRuns: 20
      });
    });
  });
  describe("Property 33: Unauthenticated access denial", function () {
    it("should deny all goal access for unauthenticated users", function () {
      fc.assert(fc.property(testGoalArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (goal, users) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var canRead = canReadGoal(unauthenticatedContext, goal, users);
        expect(canRead).toBe(false);
      }), {
        numRuns: 20
      });
    });
    it("should deny all nudge access for unauthenticated users", function () {
      fc.assert(fc.property(testNudgeArb, fc.array(testUserArb, {
        minLength: 1,
        maxLength: 5
      }), function (nudge, users) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var canRead = canReadNudge(unauthenticatedContext, nudge);
        expect(canRead).toBe(false);
        var canCreate = canCreateNudge(unauthenticatedContext, nudge, users);
        expect(canCreate).toBe(false);
      }), {
        numRuns: 20
      });
    });
    it("should deny nudge history access for unauthenticated users", function () {
      fc.assert(fc.property(fc.array(testNudgeArb, {
        minLength: 0,
        maxLength: 10
      }), userIdArb, function (allNudges, queryUserId) {
        var unauthenticatedContext = {
          uid: null,
          isAuthenticated: false
        };
        var accessibleNudges = canAccessNudgeHistory(unauthenticatedContext, allNudges, queryUserId);
        expect(accessibleNudges).toEqual([]);
      }), {
        numRuns: 20
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmYyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsInVzZXJJZEFyYiIsIm9uZW9mIiwiY29uc3RhbnQiLCJnb2FsSWRBcmIiLCJudWRnZUlkQXJiIiwidGVzdFVzZXJBcmIiLCJyZWNvcmQiLCJ1c2VySWQiLCJmcmllbmRzIiwiYXJyYXkiLCJtYXhMZW5ndGgiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwidGVzdEdvYWxBcmIiLCJnb2FsSWQiLCJvd25lcklkIiwiZGVzY3JpcHRpb24iLCJpc1NoYXJlZCIsImJvb2xlYW4iLCJ0eXBlIiwiY29uc3RhbnRGcm9tIiwidGFyZ2V0VGltZSIsIm9wdGlvbiIsIm5pbCIsInRlc3ROdWRnZUFyYiIsIm51ZGdlSWQiLCJzZW5kZXJJZCIsInJlY2VpdmVySWQiLCJnb2FsRGVzY3JpcHRpb24iLCJhdXRoQ29udGV4dEFyYiIsInVpZCIsImlzQXV0aGVudGljYXRlZCIsImNhblJlYWRHb2FsIiwiYXV0aENvbnRleHQiLCJnb2FsIiwidXNlcnMiLCJnb2FsT3duZXIiLCJmaW5kIiwidSIsImluY2x1ZGVzIiwiY2FuUmVhZE51ZGdlIiwibnVkZ2UiLCJjYW5DcmVhdGVOdWRnZSIsInNlbmRlciIsImNhbkFjY2Vzc051ZGdlSGlzdG9yeSIsIm51ZGdlcyIsImZpbHRlciIsImRlc2NyaWJlIiwiaXQiLCJhc3NlcnQiLCJwcm9wZXJ0eSIsIm1pbkxlbmd0aCIsImNhblJlYWQiLCJleHBlY3QiLCJ0b0JlIiwibnVtUnVucyIsImN1cnJlbnRVc2VySWQiLCJwcmUiLCJjYW5DcmVhdGUiLCJjYW5BY2Nlc3MiLCJhbGxOdWRnZXMiLCJxdWVyeVVzZXJJZCIsImFjY2Vzc2libGVOdWRnZXMiLCJ0b0VxdWFsIiwidW5yZWxhdGVkTnVkZ2VzIiwibGVuZ3RoIiwidW5hdXRoZW50aWNhdGVkQ29udGV4dCJdLCJzb3VyY2VzIjpbInNlY3VyaXR5UnVsZXMucHJvcGVydHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFByb3BlcnR5LUJhc2VkIFRlc3RzIGZvciBGaXJlc3RvcmUgU2VjdXJpdHkgUnVsZXNcbiAqIEZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWRcbiAqL1xuXG5pbXBvcnQgKiBhcyBmYyBmcm9tIFwiZmFzdC1jaGVja1wiO1xuXG4vKipcbiAqIFRlc3QgaW50ZXJmYWNlcyBmb3Igc2VjdXJpdHkgcnVsZSB2YWxpZGF0aW9uXG4gKi9cbmludGVyZmFjZSBUZXN0VXNlciB7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgZnJpZW5kczogc3RyaW5nW107XG4gICAgZGlzcGxheU5hbWU6IHN0cmluZztcbiAgICBlbWFpbDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgVGVzdEdvYWwge1xuICAgIGdvYWxJZDogc3RyaW5nO1xuICAgIG93bmVySWQ6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGlzU2hhcmVkOiBib29sZWFuO1xuICAgIHR5cGU6IFwidGltZVwiIHwgXCJmbGV4aWJsZVwiO1xuICAgIHRhcmdldFRpbWU6IHN0cmluZyB8IG51bGw7XG59XG5cbmludGVyZmFjZSBUZXN0TnVkZ2Uge1xuICAgIG51ZGdlSWQ6IHN0cmluZztcbiAgICBzZW5kZXJJZDogc3RyaW5nO1xuICAgIHJlY2VpdmVySWQ6IHN0cmluZztcbiAgICBnb2FsSWQ6IHN0cmluZztcbiAgICBnb2FsRGVzY3JpcHRpb246IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEF1dGhDb250ZXh0IHtcbiAgICB1aWQ6IHN0cmluZyB8IG51bGw7XG4gICAgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuO1xufVxuXG4vLyBPcHRpbWl6ZWQgZ2VuZXJhdG9ycyBmb3IgZmFzdGVyIHRlc3QgZXhlY3V0aW9uXG5jb25zdCB1c2VySWRBcmIgPSBmYy5vbmVvZihcbiAgICBmYy5jb25zdGFudChcInVzZXItMVwiKSxcbiAgICBmYy5jb25zdGFudChcInVzZXItMlwiKSxcbiAgICBmYy5jb25zdGFudChcInVzZXItM1wiKSxcbiAgICBmYy5jb25zdGFudChcInVzZXItNFwiKSxcbiAgICBmYy5jb25zdGFudChcInVzZXItNVwiKSxcbik7XG5cbmNvbnN0IGdvYWxJZEFyYiA9IGZjLm9uZW9mKFxuICAgIGZjLmNvbnN0YW50KFwiZ29hbC0xXCIpLFxuICAgIGZjLmNvbnN0YW50KFwiZ29hbC0yXCIpLFxuICAgIGZjLmNvbnN0YW50KFwiZ29hbC0zXCIpLFxuICAgIGZjLmNvbnN0YW50KFwiZ29hbC00XCIpLFxuKTtcblxuY29uc3QgbnVkZ2VJZEFyYiA9IGZjLm9uZW9mKFxuICAgIGZjLmNvbnN0YW50KFwibnVkZ2UtMVwiKSxcbiAgICBmYy5jb25zdGFudChcIm51ZGdlLTJcIiksXG4gICAgZmMuY29uc3RhbnQoXCJudWRnZS0zXCIpLFxuKTtcblxuY29uc3QgdGVzdFVzZXJBcmIgPSBmYy5yZWNvcmQoe1xuICAgIHVzZXJJZDogdXNlcklkQXJiLFxuICAgIGZyaWVuZHM6IGZjLmFycmF5KHVzZXJJZEFyYiwgeyBtYXhMZW5ndGg6IDMgfSksXG4gICAgZGlzcGxheU5hbWU6IGZjLmNvbnN0YW50KFwiVGVzdCBVc2VyXCIpLFxuICAgIGVtYWlsOiBmYy5jb25zdGFudChcInRlc3RAZXhhbXBsZS5jb21cIiksXG59KTtcblxuY29uc3QgdGVzdEdvYWxBcmIgPSBmYy5yZWNvcmQoe1xuICAgIGdvYWxJZDogZ29hbElkQXJiLFxuICAgIG93bmVySWQ6IHVzZXJJZEFyYixcbiAgICBkZXNjcmlwdGlvbjogZmMuY29uc3RhbnQoXCJUZXN0IGdvYWxcIiksXG4gICAgaXNTaGFyZWQ6IGZjLmJvb2xlYW4oKSxcbiAgICB0eXBlOiBmYy5jb25zdGFudEZyb20oXCJmbGV4aWJsZVwiLCBcInRpbWVcIiksXG4gICAgdGFyZ2V0VGltZTogZmMub3B0aW9uKGZjLmNvbnN0YW50KFwiMDc6MDBcIiksIHsgbmlsOiBudWxsIH0pLFxufSk7XG5cbmNvbnN0IHRlc3ROdWRnZUFyYiA9IGZjLnJlY29yZCh7XG4gICAgbnVkZ2VJZDogbnVkZ2VJZEFyYixcbiAgICBzZW5kZXJJZDogdXNlcklkQXJiLFxuICAgIHJlY2VpdmVySWQ6IHVzZXJJZEFyYixcbiAgICBnb2FsSWQ6IGdvYWxJZEFyYixcbiAgICBnb2FsRGVzY3JpcHRpb246IGZjLmNvbnN0YW50KFwiVGVzdCBnb2FsIGRlc2NyaXB0aW9uXCIpLFxufSk7XG5cbmNvbnN0IGF1dGhDb250ZXh0QXJiID0gZmMucmVjb3JkKHtcbiAgICB1aWQ6IGZjLm9wdGlvbih1c2VySWRBcmIsIHsgbmlsOiBudWxsIH0pLFxuICAgIGlzQXV0aGVudGljYXRlZDogZmMuYm9vbGVhbigpLFxufSk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgdGhhdCBzaW11bGF0ZSBGaXJlc3RvcmUgc2VjdXJpdHkgcnVsZSBsb2dpY1xuZnVuY3Rpb24gY2FuUmVhZEdvYWwoXG4gICAgYXV0aENvbnRleHQ6IEF1dGhDb250ZXh0LFxuICAgIGdvYWw6IFRlc3RHb2FsLFxuICAgIHVzZXJzOiBUZXN0VXNlcltdLFxuKTogYm9vbGVhbiB7XG4gICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gVXNlciBjYW4gcmVhZCB0aGVpciBvd24gZ29hbHNcbiAgICBpZiAoZ29hbC5vd25lcklkID09PSBhdXRoQ29udGV4dC51aWQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gVXNlciBjYW4gcmVhZCBnb2FscyBvZiBmcmllbmRzXG4gICAgY29uc3QgZ29hbE93bmVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IGdvYWwub3duZXJJZCk7XG4gICAgaWYgKGdvYWxPd25lciAmJiBnb2FsT3duZXIuZnJpZW5kcy5pbmNsdWRlcyhhdXRoQ29udGV4dC51aWQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY2FuUmVhZE51ZGdlKGF1dGhDb250ZXh0OiBBdXRoQ29udGV4dCwgbnVkZ2U6IFRlc3ROdWRnZSk6IGJvb2xlYW4ge1xuICAgIGlmICghYXV0aENvbnRleHQuaXNBdXRoZW50aWNhdGVkIHx8ICFhdXRoQ29udGV4dC51aWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFVzZXIgY2FuIHJlYWQgbnVkZ2VzIHdoZXJlIHRoZXkgYXJlIHNlbmRlciBvciByZWNlaXZlclxuICAgIHJldHVybiAoXG4gICAgICAgIG51ZGdlLnNlbmRlcklkID09PSBhdXRoQ29udGV4dC51aWQgfHwgbnVkZ2UucmVjZWl2ZXJJZCA9PT0gYXV0aENvbnRleHQudWlkXG4gICAgKTtcbn1cblxuZnVuY3Rpb24gY2FuQ3JlYXRlTnVkZ2UoXG4gICAgYXV0aENvbnRleHQ6IEF1dGhDb250ZXh0LFxuICAgIG51ZGdlOiBUZXN0TnVkZ2UsXG4gICAgdXNlcnM6IFRlc3RVc2VyW10sXG4pOiBib29sZWFuIHtcbiAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBVc2VyIG11c3QgYmUgdGhlIHNlbmRlclxuICAgIGlmIChudWRnZS5zZW5kZXJJZCAhPT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBSZWNlaXZlciBtdXN0IGJlIGluIHNlbmRlcidzIGZyaWVuZHMgbGlzdFxuICAgIGNvbnN0IHNlbmRlciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBhdXRoQ29udGV4dC51aWQpO1xuICAgIGlmICghc2VuZGVyIHx8ICFzZW5kZXIuZnJpZW5kcy5pbmNsdWRlcyhudWRnZS5yZWNlaXZlcklkKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGNhbkFjY2Vzc051ZGdlSGlzdG9yeShcbiAgICBhdXRoQ29udGV4dDogQXV0aENvbnRleHQsXG4gICAgbnVkZ2VzOiBUZXN0TnVkZ2VbXSxcbiAgICB1c2VySWQ6IHN0cmluZyxcbik6IFRlc3ROdWRnZVtdIHtcbiAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLyBVc2VyIGNhbiBvbmx5IHNlZSBudWRnZXMgd2hlcmUgdGhleSBhcmUgc2VuZGVyIG9yIHJlY2VpdmVyXG4gICAgcmV0dXJuIG51ZGdlcy5maWx0ZXIoXG4gICAgICAgIChudWRnZSkgPT5cbiAgICAgICAgICAgIG51ZGdlLnNlbmRlcklkID09PSBhdXRoQ29udGV4dC51aWQgfHxcbiAgICAgICAgICAgIG51ZGdlLnJlY2VpdmVySWQgPT09IGF1dGhDb250ZXh0LnVpZCxcbiAgICApO1xufVxuXG5kZXNjcmliZShcIlNlY3VyaXR5IFJ1bGVzIFByb3BlcnR5LUJhc2VkIFRlc3RzXCIsICgpID0+IHtcbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDI5OiBGZWVkIGFjY2VzcyBhdXRob3JpemF0aW9uKipcbiAgICAgKiAqKlZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDEwLjEqKlxuICAgICAqL1xuICAgIGRlc2NyaWJlKFwiUHJvcGVydHkgMjk6IEZlZWQgYWNjZXNzIGF1dGhvcml6YXRpb25cIiwgKCkgPT4ge1xuICAgICAgICBpdChcInNob3VsZCBvbmx5IGFsbG93IHJlYWRpbmcgZ29hbHMgYmVsb25naW5nIHRvIGZyaWVuZHMgb3Igc2VsZlwiLCAoKSA9PiB7XG4gICAgICAgICAgICBmYy5hc3NlcnQoXG4gICAgICAgICAgICAgICAgZmMucHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgIGF1dGhDb250ZXh0QXJiLFxuICAgICAgICAgICAgICAgICAgICB0ZXN0R29hbEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChhdXRoQ29udGV4dCwgZ29hbCwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhblJlYWQgPSBjYW5SZWFkR29hbChhdXRoQ29udGV4dCwgZ29hbCwgdXNlcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWwub3duZXJJZCA9PT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnb2FsT3duZXIgPSB1c2Vycy5maW5kKCh1KSA9PiB1LnVzZXJJZCA9PT0gZ29hbC5vd25lcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnb2FsT3duZXIgJiYgZ29hbE93bmVyLmZyaWVuZHMuaW5jbHVkZXMoYXV0aENvbnRleHQudWlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5SZWFkKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IGFjY2VzcyB0byBnb2FscyBvZiBub24tZnJpZW5kc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBmYy5hc3NlcnQoXG4gICAgICAgICAgICAgICAgZmMucHJvcGVydHkoXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdEdvYWxBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAoY3VycmVudFVzZXJJZCwgZ29hbCwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZjLnByZShnb2FsLm93bmVySWQgIT09IGN1cnJlbnRVc2VySWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoQ29udGV4dCA9IHsgdWlkOiBjdXJyZW50VXNlcklkLCBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdvYWxPd25lciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBnb2FsLm93bmVySWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmYy5wcmUoISFnb2FsT3duZXIgJiYgIWdvYWxPd25lci5mcmllbmRzLmluY2x1ZGVzKGN1cnJlbnRVc2VySWQpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuUmVhZCA9IGNhblJlYWRHb2FsKGF1dGhDb250ZXh0LCBnb2FsLCB1c2Vycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqICoqRmVhdHVyZTogc29jaWFsLW51ZGdpbmctZmVlZCwgUHJvcGVydHkgMzA6IE51ZGdlIGF1dGhvcml6YXRpb24qKlxuICAgICAqICoqVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMTAuMioqXG4gICAgICovXG4gICAgZGVzY3JpYmUoXCJQcm9wZXJ0eSAzMDogTnVkZ2UgYXV0aG9yaXphdGlvblwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIG9ubHkgYWxsb3cgY3JlYXRpbmcgbnVkZ2VzIHRvIGZyaWVuZHNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdE51ZGdlQXJiLFxuICAgICAgICAgICAgICAgICAgICBmYy5hcnJheSh0ZXN0VXNlckFyYiwgeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogNSB9KSxcbiAgICAgICAgICAgICAgICAgICAgKGF1dGhDb250ZXh0LCBudWRnZSwgdXNlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbkNyZWF0ZSA9IGNhbkNyZWF0ZU51ZGdlKGF1dGhDb250ZXh0LCBudWRnZSwgdXNlcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dGhDb250ZXh0LmlzQXV0aGVudGljYXRlZCB8fCAhYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVkZ2Uuc2VuZGVySWQgIT09IGF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5DcmVhdGUpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IGF1dGhDb250ZXh0LnVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZGVyICYmIHNlbmRlci5mcmllbmRzLmluY2x1ZGVzKG51ZGdlLnJlY2VpdmVySWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IG51ZGdlIGNyZWF0aW9uIHRvIG5vbi1mcmllbmRzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGZjLmFzc2VydChcbiAgICAgICAgICAgICAgICBmYy5wcm9wZXJ0eShcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkQXJiLFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIGdvYWxJZEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChzZW5kZXJJZCwgcmVjZWl2ZXJJZCwgZ29hbElkLCB1c2VycykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmMucHJlKHNlbmRlcklkICE9PSByZWNlaXZlcklkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gdXNlcnMuZmluZCgodSkgPT4gdS51c2VySWQgPT09IHNlbmRlcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZjLnByZSghIXNlbmRlciAmJiAhc2VuZGVyLmZyaWVuZHMuaW5jbHVkZXMocmVjZWl2ZXJJZCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoQ29udGV4dCA9IHsgdWlkOiBzZW5kZXJJZCwgaXNBdXRoZW50aWNhdGVkOiB0cnVlIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudWRnZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZUlkOiBcInRlc3QtbnVkZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsRGVzY3JpcHRpb246IFwiVGVzdCBnb2FsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5DcmVhdGUgPSBjYW5DcmVhdGVOdWRnZShhdXRoQ29udGV4dCwgbnVkZ2UsIHVzZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5DcmVhdGUpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDMxOiBHb2FsIGRldGFpbCBhY2Nlc3MgYXV0aG9yaXphdGlvbioqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC4zKipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMxOiBHb2FsIGRldGFpbCBhY2Nlc3MgYXV0aG9yaXphdGlvblwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIGFsbG93IGdvYWwgZGV0YWlsIGFjY2VzcyBvbmx5IHRvIG93bmVyIG9yIGZyaWVuZHNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgdGVzdEdvYWxBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAoYXV0aENvbnRleHQsIGdvYWwsIHVzZXJzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHb2FsIGRldGFpbCBhY2Nlc3MgdXNlcyB0aGUgc2FtZSBsb2dpYyBhcyBmZWVkIGFjY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuQWNjZXNzID0gY2FuUmVhZEdvYWwoYXV0aENvbnRleHQsIGdvYWwsIHVzZXJzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChjYW5BY2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWwub3duZXJJZCA9PT0gYXV0aENvbnRleHQudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdvYWxPd25lciA9IHVzZXJzLmZpbmQoKHUpID0+IHUudXNlcklkID09PSBnb2FsLm93bmVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWxPd25lciAmJiBnb2FsT3duZXIuZnJpZW5kcy5pbmNsdWRlcyhhdXRoQ29udGV4dC51aWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkFjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqICoqRmVhdHVyZTogc29jaWFsLW51ZGdpbmctZmVlZCwgUHJvcGVydHkgMzI6IE51ZGdlIGhpc3RvcnkgYXV0aG9yaXphdGlvbioqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC40KipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMyOiBOdWRnZSBoaXN0b3J5IGF1dGhvcml6YXRpb25cIiwgKCkgPT4ge1xuICAgICAgICBpdChcInNob3VsZCBvbmx5IHJldHVybiBudWRnZXMgd2hlcmUgdXNlciBpcyBzZW5kZXIgb3IgcmVjZWl2ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBhdXRoQ29udGV4dEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdE51ZGdlQXJiLCB7IG1pbkxlbmd0aDogMCwgbWF4TGVuZ3RoOiAxMCB9KSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkQXJiLFxuICAgICAgICAgICAgICAgICAgICAoYXV0aENvbnRleHQsIGFsbE51ZGdlcywgcXVlcnlVc2VySWQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjY2Vzc2libGVOdWRnZXMgPSBjYW5BY2Nlc3NOdWRnZUhpc3RvcnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aENvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsTnVkZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdXRoQ29udGV4dC5pc0F1dGhlbnRpY2F0ZWQgfHwgIWF1dGhDb250ZXh0LnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChhY2Nlc3NpYmxlTnVkZ2VzKS50b0VxdWFsKFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbnVkZ2Ugb2YgYWNjZXNzaWJsZU51ZGdlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVkZ2Uuc2VuZGVySWQgPT09IGF1dGhDb250ZXh0LnVpZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5yZWNlaXZlcklkID09PSBhdXRoQ29udGV4dC51aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgZXhjbHVkZSBudWRnZXMgd2hlcmUgdXNlciBpcyBuZWl0aGVyIHNlbmRlciBub3IgcmVjZWl2ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3ROdWRnZUFyYiwgeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogMTAgfSksXG4gICAgICAgICAgICAgICAgICAgIChjdXJyZW50VXNlcklkLCBhbGxOdWRnZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciB0byBudWRnZXMgd2hlcmUgdXNlciBpcyBub3QgaW52b2x2ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVucmVsYXRlZE51ZGdlcyA9IGFsbE51ZGdlcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG51ZGdlKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5zZW5kZXJJZCAhPT0gY3VycmVudFVzZXJJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWRnZS5yZWNlaXZlcklkICE9PSBjdXJyZW50VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZmMucHJlKHVucmVsYXRlZE51ZGdlcy5sZW5ndGggPiAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aENvbnRleHQgPSB7IHVpZDogY3VycmVudFVzZXJJZCwgaXNBdXRoZW50aWNhdGVkOiB0cnVlIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY2Nlc3NpYmxlTnVkZ2VzID0gY2FuQWNjZXNzTnVkZ2VIaXN0b3J5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhDb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVucmVsYXRlZE51ZGdlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGFjY2Vzc2libGVOdWRnZXMpLnRvRXF1YWwoW10pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiAqKkZlYXR1cmU6IHNvY2lhbC1udWRnaW5nLWZlZWQsIFByb3BlcnR5IDMzOiBVbmF1dGhlbnRpY2F0ZWQgYWNjZXNzIGRlbmlhbCoqXG4gICAgICogKipWYWxpZGF0ZXM6IFJlcXVpcmVtZW50cyAxMC41KipcbiAgICAgKi9cbiAgICBkZXNjcmliZShcIlByb3BlcnR5IDMzOiBVbmF1dGhlbnRpY2F0ZWQgYWNjZXNzIGRlbmlhbFwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwic2hvdWxkIGRlbnkgYWxsIGdvYWwgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB0ZXN0R29hbEFyYixcbiAgICAgICAgICAgICAgICAgICAgZmMuYXJyYXkodGVzdFVzZXJBcmIsIHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDUgfSksXG4gICAgICAgICAgICAgICAgICAgIChnb2FsLCB1c2VycykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5hdXRoZW50aWNhdGVkQ29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5SZWFkID0gY2FuUmVhZEdvYWwodW5hdXRoZW50aWNhdGVkQ29udGV4dCwgZ29hbCwgdXNlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhblJlYWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgZGVueSBhbGwgbnVkZ2UgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICB0ZXN0TnVkZ2VBcmIsXG4gICAgICAgICAgICAgICAgICAgIGZjLmFycmF5KHRlc3RVc2VyQXJiLCB7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiA1IH0pLFxuICAgICAgICAgICAgICAgICAgICAobnVkZ2UsIHVzZXJzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmF1dGhlbnRpY2F0ZWRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuUmVhZCA9IGNhblJlYWROdWRnZSh1bmF1dGhlbnRpY2F0ZWRDb250ZXh0LCBudWRnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2FuUmVhZCkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbkNyZWF0ZSA9IGNhbkNyZWF0ZU51ZGdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuYXV0aGVudGljYXRlZENvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVkZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGNhbkNyZWF0ZSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7IG51bVJ1bnM6IDIwIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBkZW55IG51ZGdlIGhpc3RvcnkgYWNjZXNzIGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZmMuYXNzZXJ0KFxuICAgICAgICAgICAgICAgIGZjLnByb3BlcnR5KFxuICAgICAgICAgICAgICAgICAgICBmYy5hcnJheSh0ZXN0TnVkZ2VBcmIsIHsgbWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDEwIH0pLFxuICAgICAgICAgICAgICAgICAgICB1c2VySWRBcmIsXG4gICAgICAgICAgICAgICAgICAgIChhbGxOdWRnZXMsIHF1ZXJ5VXNlcklkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmF1dGhlbnRpY2F0ZWRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjY2Vzc2libGVOdWRnZXMgPSBjYW5BY2Nlc3NOdWRnZUhpc3RvcnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5hdXRoZW50aWNhdGVkQ29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxOdWRnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlVc2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGFjY2Vzc2libGVOdWRnZXMpLnRvRXF1YWwoW10pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgeyBudW1SdW5zOiAyMCB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IjtBQUtBLElBQUFBLEVBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQW1DQSxJQUFNQyxTQUFTLEdBQUdILEVBQUUsQ0FBQ0ksS0FBSyxDQUN0QkosRUFBRSxDQUFDSyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQ3JCTCxFQUFFLENBQUNLLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFDckJMLEVBQUUsQ0FBQ0ssUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUNyQkwsRUFBRSxDQUFDSyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQ3JCTCxFQUFFLENBQUNLLFFBQVEsQ0FBQyxRQUFRLENBQ3hCLENBQUM7QUFFRCxJQUFNQyxTQUFTLEdBQUdOLEVBQUUsQ0FBQ0ksS0FBSyxDQUN0QkosRUFBRSxDQUFDSyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQ3JCTCxFQUFFLENBQUNLLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFDckJMLEVBQUUsQ0FBQ0ssUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUNyQkwsRUFBRSxDQUFDSyxRQUFRLENBQUMsUUFBUSxDQUN4QixDQUFDO0FBRUQsSUFBTUUsVUFBVSxHQUFHUCxFQUFFLENBQUNJLEtBQUssQ0FDdkJKLEVBQUUsQ0FBQ0ssUUFBUSxDQUFDLFNBQVMsQ0FBQyxFQUN0QkwsRUFBRSxDQUFDSyxRQUFRLENBQUMsU0FBUyxDQUFDLEVBQ3RCTCxFQUFFLENBQUNLLFFBQVEsQ0FBQyxTQUFTLENBQ3pCLENBQUM7QUFFRCxJQUFNRyxXQUFXLEdBQUdSLEVBQUUsQ0FBQ1MsTUFBTSxDQUFDO0VBQzFCQyxNQUFNLEVBQUVQLFNBQVM7RUFDakJRLE9BQU8sRUFBRVgsRUFBRSxDQUFDWSxLQUFLLENBQUNULFNBQVMsRUFBRTtJQUFFVSxTQUFTLEVBQUU7RUFBRSxDQUFDLENBQUM7RUFDOUNDLFdBQVcsRUFBRWQsRUFBRSxDQUFDSyxRQUFRLENB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