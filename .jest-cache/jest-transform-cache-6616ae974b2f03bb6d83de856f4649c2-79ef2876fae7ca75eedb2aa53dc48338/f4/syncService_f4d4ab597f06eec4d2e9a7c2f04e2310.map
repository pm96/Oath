{"version":3,"names":["_firestore","require","SyncService","exports","_classCallCheck2","default","syncListeners","Map","pendingOperations","syncStatus","isOnline","lastSync","syncInProgress","statusCallbacks","Set","initializeSync","_createClass2","key","value","_initializeSync","_asyncToGenerator2","loadPendingOperations","online","updateSyncStatus","processPendingOperations","startConnectivityMonitoring","error","console","apply","arguments","_startRealtimeSync","userId","_this","Error","stopRealtimeSync","streaksCollection","getHabitStreaksCollection","streakListener","onSnapshot","snapshot","docChanges","forEach","_ref","change","streakData","doc","data","handleRealtimeStreakUpdate","id","type","_x2","handleSyncError","completionsCollection","getHabitCompletionsCollection","completionListener","_ref2","completionData","handleRealtimeCompletionUpdate","_x3","set","startRealtimeSync","_x","streakKey","completionKey","get","delete","_cacheData","version","length","undefined","checksum","generateChecksum","cachedData","timestamp","Timestamp","now","AsyncStorage","setItem","JSON","stringify","cacheData","_x4","_x5","_getCachedData","cachedString","getItem","parse","expectedChecksum","warn","removeItem","getCachedData","_x6","_queueOperation","operation","syncOp","Object","assign","generateOperationId","retryCount","savePendingOperations","size","queueOperation","_x7","_processPendingOperations","operations","Array","from","values","sort","a","b","toMillis","executeOperation","lastAttempt","_executeOperation","_this2","retryWithBackoff","runTransaction","db","_ref4","transaction","executeCompletionOperation","executeStreakOperation","executeMilestoneOperation","_x9","_x8","_handleRealtimeStreakUpdate","docId","changeType","removeCacheKey","CACHE_KEYS","STREAKS","streak","transformFirestoreToStreak","cacheKey","cachedStreak","hasConflict","resolvedStreak","resolveStreakConflict","_x0","_x1","_x10","_handleRealtimeCompletionUpdate","COMPLETIONS","completion","transformFirestoreToCompletion","_x11","_x12","_x13","_resolveStreakConflict","localStreak","remoteStreak","lastCompletionDate","currentStreak","_x14","_x15","local","remote","bestStreak","freezesAvailable","freezesUsed","_executeCompletionOperation","action","completionRef","createdAt","serverTimestamp","updateRef","update","updatedAt","deleteRef","_x16","_x17","_executeStreakOperation","streakId","generateStreakId","habitId","streakRef","transformStreakToFirestore","_x18","_x19","_executeMilestoneOperation","log","_x20","_x21","str","hash","i","char","charCodeAt","toString","Date","Math","random","substr","_savePendingOperations","serialized","map","op","_op$lastAttempt","PENDING_OPS","_loadPendingOperations","_this3","stored","clear","fromMillis","_this4","setInterval","wasOnline","_error$message","code","message","includes","updates","_this5","callback","onSyncStatusChange","_this6","add","getSyncStatus","_forceSyncUserData","syncUserStreaks","syncUserCompletions","forceSyncUserData","_x22","_syncUserStreaks","_x23","_syncUserCompletions","_x24","_clearCache","multiRemove","LAST_SYNC","clearCache","getInstance","instance","syncService"],"sources":["syncService.ts"],"sourcesContent":["/**\n * Data Synchronization Service\n *\n * Handles cross-device data synchronization, offline caching, and conflict resolution\n * Requirements: 10.1, 10.2, 10.3, 10.4, 10.5\n */\n\nimport { Timestamp } from \"firebase/firestore\";\n\n/**\n * Sync operation types\n */\nexport interface SyncOperation {\n    id: string;\n    type: \"completion\" | \"streak\" | \"milestone\";\n    action: \"create\" | \"update\" | \"delete\";\n    data: any;\n    timestamp: Timestamp;\n    userId: string;\n    habitId?: string;\n    retryCount: number;\n    lastAttempt?: Timestamp;\n}\n\n/**\n * Cached data structure\n */\nexport interface CachedData<T> {\n    data: T;\n    timestamp: Timestamp;\n    version: number;\n    checksum: string;\n}\n\n/**\n * Sync status\n */\nexport interface SyncStatus {\n    isOnline: boolean;\n    lastSync: Timestamp | null;\n    pendingOperations: number;\n    syncInProgress: boolean;\n}\n/**\n * Data Synchronization Service Implementation\n */\nexport class SyncService {\n    private static instance: SyncService;\n    private syncListeners: Map<string, Unsubscribe> = new Map();\n    private pendingOperations: Map<string, SyncOperation> = new Map();\n    private syncStatus: SyncStatus = {\n        isOnline: true,\n        lastSync: null,\n        pendingOperations: 0,\n        syncInProgress: false,\n    };\n    private statusCallbacks: Set<(status: SyncStatus) => void> = new Set();\n\n    // Cache keys\n    private static readonly CACHE_KEYS = {\n        STREAKS: \"@habit_streaks_cache\",\n        COMPLETIONS: \"@habit_completions_cache\",\n        PENDING_OPS: \"@pending_sync_operations\",\n        LAST_SYNC: \"@last_sync_timestamp\",\n    };\n\n    private constructor() {\n        this.initializeSync();\n    }\n\n    public static getInstance(): SyncService {\n        if (!SyncService.instance) {\n            SyncService.instance = new SyncService();\n        }\n        return SyncService.instance;\n    }\n\n    /**\n     * Initialize synchronization system\n     * Requirements: 10.1, 10.4\n     */\n    private async initializeSync(): Promise<void> {\n        try {\n            // Load pending operations from storage\n            await this.loadPendingOperations();\n\n            // Check connectivity and start sync if online\n            const online = await isOnline();\n            this.updateSyncStatus({ isOnline: online });\n\n            if (online) {\n                await this.processPendingOperations();\n            }\n\n            // Set up connectivity monitoring\n            this.startConnectivityMonitoring();\n        } catch (error) {\n            console.error(\"Failed to initialize sync service:\", error);\n        }\n    }\n\n    /**\n     * Start real-time synchronization for a user's habit data\n     * Requirements: 10.1\n     */\n    async startRealtimeSync(userId: string): Promise<void> {\n        if (!userId) {\n            throw new Error(\"User ID is required for sync\");\n        }\n\n        // Stop existing listeners for this user\n        this.stopRealtimeSync(userId);\n\n        try {\n            // Set up streak data listener\n            const streaksCollection = getHabitStreaksCollection();\n            const streakListener = onSnapshot(\n                streaksCollection,\n                (snapshot) => {\n                    snapshot.docChanges().forEach(async (change) => {\n                        const streakData = change.doc.data();\n                        if (streakData.userId === userId) {\n                            await this.handleRealtimeStreakUpdate(\n                                change.doc.id,\n                                streakData,\n                                change.type,\n                            );\n                        }\n                    });\n                },\n                (error) => {\n                    console.error(\"Streak sync error:\", error);\n                    this.handleSyncError(error);\n                },\n            );\n\n            // Set up completion data listener\n            const completionsCollection = getHabitCompletionsCollection();\n            const completionListener = onSnapshot(\n                completionsCollection,\n                (snapshot) => {\n                    snapshot.docChanges().forEach(async (change) => {\n                        const completionData = change.doc.data();\n                        if (completionData.userId === userId) {\n                            await this.handleRealtimeCompletionUpdate(\n                                change.doc.id,\n                                completionData,\n                                change.type,\n                            );\n                        }\n                    });\n                },\n                (error) => {\n                    console.error(\"Completion sync error:\", error);\n                    this.handleSyncError(error);\n                },\n            );\n\n            // Store listeners\n            this.syncListeners.set(`streaks_${userId}`, streakListener);\n            this.syncListeners.set(`completions_${userId}`, completionListener);\n        } catch (error) {\n            console.error(\"Failed to start realtime sync:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Stop real-time synchronization for a user\n     */\n    stopRealtimeSync(userId: string): void {\n        const streakKey = `streaks_${userId}`;\n        const completionKey = `completions_${userId}`;\n\n        const streakListener = this.syncListeners.get(streakKey);\n        if (streakListener) {\n            streakListener();\n            this.syncListeners.delete(streakKey);\n        }\n\n        const completionListener = this.syncListeners.get(completionKey);\n        if (completionListener) {\n            completionListener();\n            this.syncListeners.delete(completionKey);\n        }\n    }\n\n    /**\n     * Cache data locally with integrity verification\n     * Requirements: 10.4\n     */\n    async cacheData<T>(key: string, data: T, version: number = 1): Promise<void> {\n        try {\n            const checksum = this.generateChecksum(data);\n            const cachedData: CachedData<T> = {\n                data,\n                timestamp: Timestamp.now(),\n                version,\n                checksum,\n            };\n\n            await AsyncStorage.setItem(key, JSON.stringify(cachedData));\n        } catch (error) {\n            console.error(\"Failed to cache data:\", error);\n            // Don't throw - caching failure shouldn't break the app\n        }\n    }\n\n    /**\n     * Retrieve cached data with integrity verification\n     * Requirements: 10.4, 12.5\n     */\n    async getCachedData<T>(key: string): Promise<T | null> {\n        try {\n            const cachedString = await AsyncStorage.getItem(key);\n            if (!cachedString) {\n                return null;\n            }\n\n            const cachedData: CachedData<T> = JSON.parse(cachedString);\n\n            // Verify data integrity\n            const expectedChecksum = this.generateChecksum(cachedData.data);\n            if (cachedData.checksum !== expectedChecksum) {\n                console.warn(\"Cache integrity check failed, removing corrupted data\");\n                await AsyncStorage.removeItem(key);\n                return null;\n            }\n\n            return cachedData.data;\n        } catch (error) {\n            console.error(\"Failed to retrieve cached data:\", error);\n            return null;\n        }\n    }\n\n    /**\n     * Queue operation for offline sync\n     * Requirements: 10.4\n     */\n    async queueOperation(\n        operation: Omit<SyncOperation, \"id\" | \"retryCount\" | \"timestamp\">,\n    ): Promise<void> {\n        const syncOp: SyncOperation = {\n            ...operation,\n            id: this.generateOperationId(),\n            timestamp: Timestamp.now(),\n            retryCount: 0,\n        };\n\n        this.pendingOperations.set(syncOp.id, syncOp);\n        await this.savePendingOperations();\n\n        this.updateSyncStatus({\n            pendingOperations: this.pendingOperations.size,\n        });\n\n        // Try to process immediately if online\n        if (this.syncStatus.isOnline) {\n            await this.processPendingOperations();\n        }\n    }\n\n    /**\n     * Process pending operations when connection is restored\n     * Requirements: 10.4, 10.5\n     */\n    async processPendingOperations(): Promise<void> {\n        if (this.syncStatus.syncInProgress || this.pendingOperations.size === 0) {\n            return;\n        }\n\n        this.updateSyncStatus({ syncInProgress: true });\n\n        try {\n            const operations = Array.from(this.pendingOperations.values()).sort(\n                (a, b) => a.timestamp.toMillis() - b.timestamp.toMillis(),\n            );\n\n            for (const operation of operations) {\n                try {\n                    await this.executeOperation(operation);\n                    this.pendingOperations.delete(operation.id);\n                } catch (error) {\n                    console.error(\"Failed to execute operation:\", error);\n\n                    // Increment retry count\n                    operation.retryCount++;\n                    operation.lastAttempt = Timestamp.now();\n\n                    // Remove operation if max retries exceeded\n                    if (operation.retryCount >= 3) {\n                        console.warn(\n                            \"Max retries exceeded, removing operation:\",\n                            operation.id,\n                        );\n                        this.pendingOperations.delete(operation.id);\n                    }\n                }\n            }\n\n            await this.savePendingOperations();\n            this.updateSyncStatus({\n                pendingOperations: this.pendingOperations.size,\n                lastSync: Timestamp.now(),\n            });\n        } finally {\n            this.updateSyncStatus({ syncInProgress: false });\n        }\n    }\n\n    /**\n     * Execute a sync operation with atomic updates\n     * Requirements: 10.2\n     */\n    private async executeOperation(operation: SyncOperation): Promise<void> {\n        return await retryWithBackoff(async () => {\n            return await runTransaction(db, async (transaction) => {\n                switch (operation.type) {\n                    case \"completion\":\n                        await this.executeCompletionOperation(operation, transaction);\n                        break;\n                    case \"streak\":\n                        await this.executeStreakOperation(operation, transaction);\n                        break;\n                    case \"milestone\":\n                        await this.executeMilestoneOperation(operation, transaction);\n                        break;\n                    default:\n                        throw new Error(`Unknown operation type: ${operation.type}`);\n                }\n            });\n        });\n    }\n\n    /**\n     * Handle real-time streak updates with conflict resolution\n     * Requirements: 10.1, 10.5\n     */\n    private async handleRealtimeStreakUpdate(\n        docId: string,\n        data: any,\n        changeType: \"added\" | \"modified\" | \"removed\",\n    ): Promise<void> {\n        try {\n            if (changeType === \"removed\") {\n                // Remove from cache\n                const removeCacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;\n                await AsyncStorage.removeItem(removeCacheKey);\n                return;\n            }\n\n            const streak = transformFirestoreToStreak(data);\n\n            // Check for conflicts with local data\n            const cacheKey = `${SyncService.CACHE_KEYS.STREAKS}_${docId}`;\n            const cachedStreak = await this.getCachedData<HabitStreak>(cacheKey);\n\n            if (cachedStreak && this.hasConflict(cachedStreak, streak)) {\n                const resolvedStreak = await this.resolveStreakConflict(\n                    cachedStreak,\n                    streak,\n                );\n                await this.cacheData(cacheKey, resolvedStreak);\n            } else {\n                await this.cacheData(cacheKey, streak);\n            }\n        } catch (error) {\n            console.error(\"Error handling realtime streak update:\", error);\n        }\n    }\n\n    /**\n     * Handle real-time completion updates\n     * Requirements: 10.1\n     */\n    private async handleRealtimeCompletionUpdate(\n        docId: string,\n        data: any,\n        changeType: \"added\" | \"modified\" | \"removed\",\n    ): Promise<void> {\n        try {\n            if (changeType === \"removed\") {\n                const removeCacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;\n                await AsyncStorage.removeItem(removeCacheKey);\n                return;\n            }\n\n            const completion = transformFirestoreToCompletion(docId, data);\n            const cacheKey = `${SyncService.CACHE_KEYS.COMPLETIONS}_${docId}`;\n            await this.cacheData(cacheKey, completion);\n        } catch (error) {\n            console.error(\"Error handling realtime completion update:\", error);\n        }\n    }\n\n    /**\n     * Resolve conflicts using timestamp priority\n     * Requirements: 10.5\n     */\n    private async resolveStreakConflict(\n        localStreak: HabitStreak,\n        remoteStreak: HabitStreak,\n    ): Promise<HabitStreak> {\n        // Use the streak with the most recent lastCompletionDate\n        // If dates are equal, prefer the one with higher currentStreak\n\n        if (!localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {\n            return remoteStreak;\n        }\n\n        if (localStreak.lastCompletionDate && !remoteStreak.lastCompletionDate) {\n            return localStreak;\n        }\n\n        if (localStreak.lastCompletionDate && remoteStreak.lastCompletionDate) {\n            if (localStreak.lastCompletionDate > remoteStreak.lastCompletionDate) {\n                return localStreak;\n            } else if (\n                localStreak.lastCompletionDate < remoteStreak.lastCompletionDate\n            ) {\n                return remoteStreak;\n            } else {\n                // Same date, use higher streak\n                return localStreak.currentStreak >= remoteStreak.currentStreak\n                    ? localStreak\n                    : remoteStreak;\n            }\n        }\n\n        // Fallback to remote if no clear winner\n        return remoteStreak;\n    }\n\n    /**\n     * Check if there's a conflict between local and remote data\n     */\n    private hasConflict(local: HabitStreak, remote: HabitStreak): boolean {\n        return (\n            local.currentStreak !== remote.currentStreak ||\n            local.bestStreak !== remote.bestStreak ||\n            local.lastCompletionDate !== remote.lastCompletionDate ||\n            local.freezesAvailable !== remote.freezesAvailable ||\n            local.freezesUsed !== remote.freezesUsed\n        );\n    }\n    /**\n     * Execute completion operation\n     */\n    private async executeCompletionOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        const completionsCollection = getHabitCompletionsCollection();\n\n        switch (operation.action) {\n            case \"create\":\n                const completionRef = doc(completionsCollection);\n                transaction.set(completionRef, {\n                    ...operation.data,\n                    createdAt: serverTimestamp(),\n                });\n                break;\n            case \"update\":\n                const updateRef = doc(completionsCollection, operation.data.id);\n                transaction.update(updateRef, {\n                    ...operation.data,\n                    updatedAt: serverTimestamp(),\n                });\n                break;\n            case \"delete\":\n                const deleteRef = doc(completionsCollection, operation.data.id);\n                transaction.delete(deleteRef);\n                break;\n        }\n    }\n\n    /**\n     * Execute streak operation\n     */\n    private async executeStreakOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        const streaksCollection = getHabitStreaksCollection();\n        const streakId = generateStreakId(operation.userId, operation.habitId!);\n        const streakRef = doc(streaksCollection, streakId);\n\n        switch (operation.action) {\n            case \"create\":\n            case \"update\":\n                const streakData = transformStreakToFirestore(operation.data);\n                transaction.set(streakRef, streakData);\n                break;\n            case \"delete\":\n                transaction.delete(streakRef);\n                break;\n        }\n    }\n\n    /**\n     * Execute milestone operation\n     */\n    private async executeMilestoneOperation(\n        operation: SyncOperation,\n        transaction: any,\n    ): Promise<void> {\n        // Milestone operations are typically part of streak updates\n        // This is a placeholder for future milestone-specific operations\n        console.log(\"Executing milestone operation:\", operation);\n    }\n\n    /**\n     * Generate checksum for data integrity\n     */\n    private generateChecksum(data: any): string {\n        const str = JSON.stringify(data);\n        let hash = 0;\n        for (let i = 0; i < str.length; i++) {\n            const char = str.charCodeAt(i);\n            hash = (hash << 5) - hash + char;\n            hash = hash & hash; // Convert to 32-bit integer\n        }\n        return hash.toString();\n    }\n\n    /**\n     * Generate unique operation ID\n     */\n    private generateOperationId(): string {\n        return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n\n    /**\n     * Save pending operations to storage\n     */\n    private async savePendingOperations(): Promise<void> {\n        try {\n            const operations = Array.from(this.pendingOperations.values());\n            const serialized = operations.map((op) => ({\n                ...op,\n                timestamp: op.timestamp.toMillis(),\n                lastAttempt: op.lastAttempt?.toMillis(),\n            }));\n\n            await AsyncStorage.setItem(\n                SyncService.CACHE_KEYS.PENDING_OPS,\n                JSON.stringify(serialized),\n            );\n        } catch (error) {\n            console.error(\"Failed to save pending operations:\", error);\n        }\n    }\n\n    /**\n     * Load pending operations from storage\n     */\n    private async loadPendingOperations(): Promise<void> {\n        try {\n            const stored = await AsyncStorage.getItem(\n                SyncService.CACHE_KEYS.PENDING_OPS,\n            );\n            if (!stored) return;\n\n            const operations = JSON.parse(stored);\n            this.pendingOperations.clear();\n\n            operations.forEach((op: any) => {\n                const operation: SyncOperation = {\n                    ...op,\n                    timestamp: Timestamp.fromMillis(op.timestamp),\n                    lastAttempt: op.lastAttempt\n                        ? Timestamp.fromMillis(op.lastAttempt)\n                        : undefined,\n                };\n                this.pendingOperations.set(operation.id, operation);\n            });\n        } catch (error) {\n            console.error(\"Failed to load pending operations:\", error);\n        }\n    }\n    /**\n     * Start connectivity monitoring\n     */\n    private startConnectivityMonitoring(): void {\n        // Check connectivity every 30 seconds\n        setInterval(async () => {\n            const online = await isOnline();\n            const wasOnline = this.syncStatus.isOnline;\n\n            this.updateSyncStatus({ isOnline: online });\n\n            // If we just came back online, process pending operations\n            if (online && !wasOnline) {\n                console.log(\"Connection restored, processing pending operations\");\n                await this.processPendingOperations();\n            }\n        }, 30000);\n    }\n\n    /**\n     * Handle sync errors\n     */\n    private handleSyncError(error: any): void {\n        console.error(\"Sync error:\", error);\n\n        // Update sync status based on error type\n        if (error.code === \"unavailable\" || error.message?.includes(\"network\")) {\n            this.updateSyncStatus({ isOnline: false });\n        }\n    }\n\n    /**\n     * Update sync status and notify listeners\n     */\n    private updateSyncStatus(updates: Partial<SyncStatus>): void {\n        this.syncStatus = { ...this.syncStatus, ...updates };\n\n        // Notify all status callbacks\n        this.statusCallbacks.forEach((callback) => {\n            try {\n                callback(this.syncStatus);\n            } catch (error) {\n                console.error(\"Error in sync status callback:\", error);\n            }\n        });\n    }\n\n    /**\n     * Subscribe to sync status updates\n     */\n    onSyncStatusChange(callback: (status: SyncStatus) => void): () => void {\n        this.statusCallbacks.add(callback);\n\n        // Call immediately with current status\n        callback(this.syncStatus);\n\n        // Return unsubscribe function\n        return () => {\n            this.statusCallbacks.delete(callback);\n        };\n    }\n\n    /**\n     * Get current sync status\n     */\n    getSyncStatus(): SyncStatus {\n        return { ...this.syncStatus };\n    }\n\n    /**\n     * Force sync all data for a user\n     * Requirements: 10.1, 10.3\n     */\n    async forceSyncUserData(userId: string): Promise<void> {\n        if (!this.syncStatus.isOnline) {\n            throw new Error(\"Cannot force sync while offline\");\n        }\n\n        try {\n            this.updateSyncStatus({ syncInProgress: true });\n\n            // Sync all streak data\n            await this.syncUserStreaks(userId);\n\n            // Sync all completion data\n            await this.syncUserCompletions(userId);\n\n            this.updateSyncStatus({ lastSync: Timestamp.now() });\n        } finally {\n            this.updateSyncStatus({ syncInProgress: false });\n        }\n    }\n\n    /**\n     * Sync user streaks from server\n     */\n    private async syncUserStreaks(userId: string): Promise<void> {\n        const streaksCollection = getHabitStreaksCollection();\n        // Implementation would fetch all user streaks and cache them\n        // This is a simplified version - full implementation would handle pagination\n        console.log(\"Syncing streaks for user:\", userId);\n    }\n\n    /**\n     * Sync user completions from server\n     */\n    private async syncUserCompletions(userId: string): Promise<void> {\n        const completionsCollection = getHabitCompletionsCollection();\n        // Implementation would fetch all user completions and cache them\n        // This is a simplified version - full implementation would handle pagination\n        console.log(\"Syncing completions for user:\", userId);\n    }\n\n    /**\n     * Clear all cached data\n     */\n    async clearCache(): Promise<void> {\n        try {\n            await AsyncStorage.multiRemove([\n                SyncService.CACHE_KEYS.STREAKS,\n                SyncService.CACHE_KEYS.COMPLETIONS,\n                SyncService.CACHE_KEYS.PENDING_OPS,\n                SyncService.CACHE_KEYS.LAST_SYNC,\n            ]);\n\n            this.pendingOperations.clear();\n            this.updateSyncStatus({\n                pendingOperations: 0,\n                lastSync: null,\n            });\n        } catch (error) {\n            console.error(\"Failed to clear cache:\", error);\n        }\n    }\n}\n\n// Export singleton instance\nexport const syncService = SyncService.getInstance();\n"],"mappings":";;;;;;;;AAOA,IAAAA,UAAA,GAAAC,OAAA;AAA+C,IAuClCC,WAAW,GAAAC,OAAA,CAAAD,WAAA;EAoBpB,SAAAA,YAAA,EAAsB;IAAA,IAAAE,gBAAA,CAAAC,OAAA,QAAAH,WAAA;IAAA,KAlBdI,aAAa,GAA6B,IAAIC,GAAG,CAAC,CAAC;IAAA,KACnDC,iBAAiB,GAA+B,IAAID,GAAG,CAAC,CAAC;IAAA,KACzDE,UAAU,GAAe;MAC7BC,QAAQ,EAAE,IAAI;MACdC,QAAQ,EAAE,IAAI;MACdH,iBAAiB,EAAE,CAAC;MACpBI,cAAc,EAAE;IACpB,CAAC;IAAA,KACOC,eAAe,GAAsC,IAAIC,GAAG,CAAC,CAAC;IAWlE,IAAI,CAACC,cAAc,CAAC,CAAC;EACzB;EAAC,WAAAC,aAAA,CAAAX,OAAA,EAAAH,WAAA;IAAAe,GAAA;IAAAC,KAAA;MAAA,IAAAC,eAAA,OAAAC,kBAAA,CAAAf,OAAA,EAaD,aAA8C;QAC1C,IAAI;UAEA,MAAM,IAAI,CAACgB,qBAAqB,CAAC,CAAC;UAGlC,IAAMC,MAAM,SAASZ,QAAQ,CAAC,CAAC;UAC/B,IAAI,CAACa,gBAAgB,CAAC;YAAEb,QAAQ,EAAEY;UAAO,CAAC,CAAC;UAE3C,IAAIA,MAAM,EAAE;YACR,MAAM,IAAI,CAACE,wBAAwB,CAAC,CAAC;UACzC;UAGA,IAAI,CAACC,2BAA2B,CAAC,CAAC;QACtC,CAAC,CAAC,OAAOC,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;QAC9D;MACJ,CAAC;MAAA,SAlBaX,cAAcA,CAAA;QAAA,OAAAI,eAAA,CAAAS,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAdd,cAAc;IAAA;EAAA;IAAAE,GAAA;IAAAC,KAAA;MAAA,IAAAY,kBAAA,OAAAV,kBAAA,CAAAf,OAAA,EAwB5B,WAAwB0B,MAAc,EAAiB;QAAA,IAAAC,KAAA;QACnD,IAAI,CAACD,MAAM,EAAE;UACT,MAAM,IAAIE,KAAK,CAAC,8BAA8B,CAAC;QACnD;QAGA,IAAI,CAACC,gBAAgB,CAACH,MAAM,CAAC;QAE7B,IAAI;UAEA,IAAMI,iBAAiB,GAAGC,yBAAyB,CAAC,CAAC;UACrD,IAAMC,cAAc,GAAGC,UAAU,CAC7BH,iBAAiB,EACjB,UAACI,QAAQ,EAAK;YACVA,QAAQ,CAACC,UAAU,CAAC,CAAC,CAACC,OAAO;cAAA,IAAAC,IAAA,OAAAtB,kBAAA,CAAAf,OAAA,EAAC,WAAOsC,MAAM,EAAK;gBAC5C,IAAMC,UAAU,GAAGD,MAAM,CAACE,GAAG,CAACC,IAAI,CAAC,CAAC;gBACpC,IAAIF,UAAU,CAACb,MAAM,KAAKA,MAAM,EAAE;kBAC9B,MAAMC,KAAI,CAACe,0BAA0B,CACjCJ,MAAM,CAACE,GAAG,CAACG,EAAE,EACbJ,UAAU,EACVD,MAAM,CAACM,IACX,CAAC;gBACL;cACJ,CAAC;cAAA,iBAAAC,GAAA;gBAAA,OAAAR,IAAA,CAAAd,KAAA,OAAAC,SAAA;cAAA;YAAA,IAAC;UACN,CAAC,EACD,UAACH,KAAK,EAAK;YACPC,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;YAC1CM,KAAI,CAACmB,eAAe,CAACzB,KAAK,CAAC;UAC/B,CACJ,CAAC;UAGD,IAAM0B,qBAAqB,GAAGC,6BAA6B,CAAC,CAAC;UAC7D,IAAMC,kBAAkB,GAAGhB,UAAU,CACjCc,qBAAqB,EACrB,UAACb,QAAQ,EAAK;YACVA,QAAQ,CAACC,UAAU,CAAC,CAAC,CAACC,OAAO;cAAA,IAAAc,KAAA,OAAAnC,kBAAA,CAAAf,OAAA,EAAC,WAAOsC,MAAM,EAAK;gBAC5C,IAAMa,cAAc,GAAGb,MAAM,CAACE,GAAG,CAACC,IAAI,CAAC,CAAC;gBACxC,IAAIU,cAAc,CAACzB,MAAM,KAAKA,MAAM,EAAE;kBAClC,MAAMC,KAAI,CAACyB,8BAA8B,CACrCd,MAAM,CAACE,GAAG,CAACG,EAAE,EACbQ,cAAc,EACdb,MAAM,CAACM,IACX,CAAC;gBACL;cACJ,CAAC;cAAA,iBAAAS,GAAA;gBAAA,OAAAH,KAAA,CAAA3B,KAAA,OAAAC,SAAA;cAAA;YAAA,IAAC;UACN,CAAC,EACD,UAACH,KAAK,EAAK;YACPC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;YAC9CM,KAAI,CAACmB,eAAe,CAACzB,KAAK,CAAC;UAC/B,CACJ,CAAC;UAGD,IAAI,CAACpB,aAAa,CAACqD,GAAG,CAAC,WAAW5B,MAAM,EAAE,EAAEM,cAAc,CAAC;UAC3D,IAAI,CAAC/B,aAAa,CAACqD,GAAG,CAAC,eAAe5B,MAAM,EAAE,EAAEuB,kBAAkB,CAAC;QACvE,CAAC,CAAC,OAAO5B,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;UACtD,MAAMA,KAAK;QACf;MACJ,CAAC;MAAA,SA5DKkC,iBAAiBA,CAAAC,EAAA;QAAA,OAAA/B,kBAAA,CAAAF,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAjB+B,iBAAiB;IAAA;EAAA;IAAA3C,GAAA;IAAAC,KAAA,EAgEvB,SAAAgB,gBAAgBA,CAACH,MAAc,EAAQ;MACnC,IAAM+B,SAAS,GAAG,WAAW/B,MAAM,EAAE;MACrC,IAAMgC,aAAa,GAAG,eAAehC,MAAM,EAAE;MAE7C,IAAMM,cAAc,GAAG,IAAI,CAAC/B,aAAa,CAAC0D,GAAG,CAACF,SAAS,CAAC;MACxD,IAAIzB,cAAc,EAAE;QAChBA,cAAc,CAAC,CAAC;QAChB,IAAI,CAAC/B,aAAa,CAAC2D,MAAM,CAACH,SAAS,CAAC;MACxC;MAEA,IAAMR,kBAAkB,GAAG,IAAI,CAAChD,aAAa,CAAC0D,GAAG,CAACD,aAAa,CAAC;MAChE,IAAIT,kBAAkB,EAAE;QACpBA,kBAAkB,CAAC,CAAC;QACpB,IAAI,CAAChD,aAAa,CAAC2D,MAAM,CAACF,aAAa,CAAC;MAC5C;IACJ;EAAC;IAAA9C,GAAA;IAAAC,KAAA;MAAA,IAAAgD,UAAA,OAAA9C,kBAAA,CAAAf,OAAA,EAMD,WAAmBY,GAAW,EAAE6B,IAAO,EAAsC;QAAA,IAApCqB,OAAe,GAAAtC,SAAA,CAAAuC,MAAA,QAAAvC,SAAA,QAAAwC,SAAA,GAAAxC,SAAA,MAAG,CAAC;QACxD,IAAI;UACA,IAAMyC,QAAQ,GAAG,IAAI,CAACC,gBAAgB,CAACzB,IAAI,CAAC;UAC5C,IAAM0B,UAAyB,GAAG;YAC9B1B,IAAI,EAAJA,IAAI;YACJ2B,SAAS,EAAEC,oBAAS,CAACC,GAAG,CAAC,CAAC;YAC1BR,OAAO,EAAPA,OAAO;YACPG,QAAQ,EAARA;UACJ,CAAC;UAED,MAAMM,YAAY,CAACC,OAAO,CAAC5D,GAAG,EAAE6D,IAAI,CAACC,SAAS,CAACP,UAAU,CAAC,CAAC;QAC/D,CAAC,CAAC,OAAO9C,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAEjD;MACJ,CAAC;MAAA,SAfKsD,SAASA,CAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAhB,UAAA,CAAAtC,KAAA,OAAAC,SAAA;MAAA;MAAA,OAATmD,SAAS;IAAA;EAAA;IAAA/D,GAAA;IAAAC,KAAA;MAAA,IAAAiE,cAAA,OAAA/D,kBAAA,CAAAf,OAAA,EAqBf,WAAuBY,GAAW,EAAqB;QACnD,IAAI;UACA,IAAMmE,YAAY,SAASR,YAAY,CAACS,OAAO,CAACpE,GAAG,CAAC;UACpD,IAAI,CAACmE,YAAY,EAAE;YACf,OAAO,IAAI;UACf;UAEA,IAAMZ,UAAyB,GAAGM,IAAI,CAACQ,KAAK,CAACF,YAAY,CAAC;UAG1D,IAAMG,gBAAgB,GAAG,IAAI,CAAChB,gBAAgB,CAACC,UAAU,CAAC1B,IAAI,CAAC;UAC/D,IAAI0B,UAAU,CAACF,QAAQ,KAAKiB,gBAAgB,EAAE;YAC1C5D,OAAO,CAAC6D,IAAI,CAAC,uDAAuD,CAAC;YACrE,MAAMZ,YAAY,CAACa,UAAU,CAACxE,GAAG,CAAC;YAClC,OAAO,IAAI;UACf;UAEA,OAAOuD,UAAU,CAAC1B,IAAI;QAC1B,CAAC,CAAC,OAAOpB,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;UACvD,OAAO,IAAI;QACf;MACJ,CAAC;MAAA,SAtBKgE,aAAaA,CAAAC,GAAA;QAAA,OAAAR,cAAA,CAAAvD,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAb6D,aAAa;IAAA;EAAA;IAAAzE,GAAA;IAAAC,KAAA;MAAA,IAAA0E,eAAA,OAAAxE,kBAAA,CAAAf,OAAA,EA4BnB,WACIwF,SAAiE,EACpD;QACb,IAAMC,MAAqB,GAAAC,MAAA,CAAAC,MAAA,KACpBH,SAAS;UACZ7C,EAAE,EAAE,IAAI,CAACiD,mBAAmB,CAAC,CAAC;UAC9BxB,SAAS,EAAEC,oBAAS,CAACC,GAAG,CAAC,CAAC;UAC1BuB,UAAU,EAAE;QAAC,EAChB;QAED,IAAI,CAAC1F,iBAAiB,CAACmD,GAAG,CAACmC,MAAM,CAAC9C,EAAE,EAAE8C,MAAM,CAAC;QAC7C,MAAM,IAAI,CAACK,qBAAqB,CAAC,CAAC;QAElC,IAAI,CAAC5E,gBAAgB,CAAC;UAClBf,iBAAiB,EAAE,IAAI,CAACA,iBAAiB,CAAC4F;QAC9C,CAAC,CAAC;QAGF,IAAI,IAAI,CAAC3F,UAAU,CAACC,QAAQ,EAAE;UAC1B,MAAM,IAAI,CAACc,wBAAwB,CAAC,CAAC;QACzC;MACJ,CAAC;MAAA,SArBK6E,cAAcA,CAAAC,GAAA;QAAA,OAAAV,eAAA,CAAAhE,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAdwE,cAAc;IAAA;EAAA;IAAApF,GAAA;IAAAC,KAAA;MAAA,IAAAqF,yBAAA,OAAAnF,kBAAA,CAAAf,OAAA,EA2BpB,aAAgD;QAC5C,IAAI,IAAI,CAACI,UAAU,CAACG,cAAc,IAAI,IAAI,CAACJ,iBAAiB,CAAC4F,IAAI,KAAK,CAAC,EAAE;UACrE;QACJ;QAEA,IAAI,CAAC7E,gBAAgB,CAAC;UAAEX,cAAc,EAAE;QAAK,CAAC,CAAC;QAE/C,IAAI;UACA,IAAM4F,UAAU,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAAClG,iBAAiB,CAACmG,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,CAC/D,UAACC,CAAC,EAAEC,CAAC;YAAA,OAAKD,CAAC,CAACpC,SAAS,CAACsC,QAAQ,CAAC,CAAC,GAAGD,CAAC,CAACrC,SAAS,CAACsC,QAAQ,CAAC,CAAC;UAAA,CAC7D,CAAC;UAED,KAAK,IAAMlB,SAAS,IAAIW,UAAU,EAAE;YAChC,IAAI;cACA,MAAM,IAAI,CAACQ,gBAAgB,CAACnB,SAAS,CAAC;cACtC,IAAI,CAACrF,iBAAiB,CAACyD,MAAM,CAAC4B,SAAS,CAAC7C,EAAE,CAAC;YAC/C,CAAC,CAAC,OAAOtB,KAAK,EAAE;cACZC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;cAGpDmE,SAAS,CAACK,UAAU,EAAE;cACtBL,SAAS,CAACoB,WAAW,GAAGvC,oBAAS,CAACC,GAAG,CAAC,CAAC;cAGvC,IAAIkB,SAAS,CAACK,UAAU,IAAI,CAAC,EAAE;gBAC3BvE,OAAO,CAAC6D,IAAI,CACR,2CAA2C,EAC3CK,SAAS,CAAC7C,EACd,CAAC;gBACD,IAAI,CAACxC,iBAAiB,CAACyD,MAAM,CAAC4B,SAAS,CAAC7C,EAAE,CAAC;cAC/C;YACJ;UACJ;UAEA,MAAM,IAAI,CAACmD,qBAAqB,CAAC,CAAC;UAClC,IAAI,CAAC5E,gBAAgB,CAAC;YAClBf,iBAAiB,EAAE,IAAI,CAACA,iBAAiB,CAAC4F,IAAI;YAC9CzF,QAAQ,EAAE+D,oBAAS,CAACC,GAAG,CAAC;UAC5B,CAAC,CAAC;QACN,CAAC,SAAS;UACN,IAAI,CAACpD,gBAAgB,CAAC;YAAEX,cAAc,EAAE;UAAM,CAAC,CAAC;QACpD;MACJ,CAAC;MAAA,SA1CKY,wBAAwBA,CAAA;QAAA,OAAA+E,yBAAA,CAAA3E,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAxBL,wBAAwB;IAAA;EAAA;IAAAP,GAAA;IAAAC,KAAA;MAAA,IAAAgG,iBAAA,OAAA9F,kBAAA,CAAAf,OAAA,EAgD9B,WAA+BwF,SAAwB,EAAiB;QAAA,IAAAsB,MAAA;QACpE,aAAaC,gBAAgB,KAAAhG,kBAAA,CAAAf,OAAA,EAAC,aAAY;UACtC,aAAagH,cAAc,CAACC,EAAE;YAAA,IAAAC,KAAA,OAAAnG,kBAAA,CAAAf,OAAA,EAAE,WAAOmH,WAAW,EAAK;cACnD,QAAQ3B,SAAS,CAAC5C,IAAI;gBAClB,KAAK,YAAY;kBACb,MAAMkE,MAAI,CAACM,0BAA0B,CAAC5B,SAAS,EAAE2B,WAAW,CAAC;kBAC7D;gBACJ,KAAK,QAAQ;kBACT,MAAML,MAAI,CAACO,sBAAsB,CAAC7B,SAAS,EAAE2B,WAAW,CAAC;kBACzD;gBACJ,KAAK,WAAW;kBACZ,MAAML,MAAI,CAACQ,yBAAyB,CAAC9B,SAAS,EAAE2B,WAAW,CAAC;kBAC5D;gBACJ;kBACI,MAAM,IAAIvF,KAAK,CAAC,2BAA2B4D,SAAS,CAAC5C,IAAI,EAAE,CAAC;cACpE;YACJ,CAAC;YAAA,iBAAA2E,GAAA;cAAA,OAAAL,KAAA,CAAA3F,KAAA,OAAAC,SAAA;YAAA;UAAA,IAAC;QACN,CAAC,EAAC;MACN,CAAC;MAAA,SAlBamF,gBAAgBA,CAAAa,GAAA;QAAA,OAAAX,iBAAA,CAAAtF,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAhBmF,gBAAgB;IAAA;EAAA;IAAA/F,GAAA;IAAAC,KAAA;MAAA,IAAA4G,2BAAA,OAAA1G,kBAAA,CAAAf,OAAA,EAwB9B,WACI0H,KAAa,EACbjF,IAAS,EACTkF,UAA4C,EAC/B;QACb,IAAI;UACA,IAAIA,UAAU,KAAK,SAAS,EAAE;YAE1B,IAAMC,cAAc,GAAG,GAAG/H,WAAW,CAACgI,UAAU,CAACC,OAAO,IAAIJ,KAAK,EAAE;YACnE,MAAMnD,YAAY,CAACa,UAAU,CAACwC,cAAc,CAAC;YAC7C;UACJ;UAEA,IAAMG,MAAM,GAAGC,0BAA0B,CAACvF,IAAI,CAAC;UAG/C,IAAMwF,QAAQ,GAAG,GAAGpI,WAAW,CAACgI,UAAU,CAACC,OAAO,IAAIJ,KAAK,EAAE;UAC7D,IAAMQ,YAAY,SAAS,IAAI,CAAC7C,aAAa,CAAc4C,QAAQ,CAAC;UAEpE,IAAIC,YAAY,IAAI,IAAI,CAACC,WAAW,CAACD,YAAY,EAAEH,MAAM,CAAC,EAAE;YACxD,IAAMK,cAAc,SAAS,IAAI,CAACC,qBAAqB,CACnDH,YAAY,EACZH,MACJ,CAAC;YACD,MAAM,IAAI,CAACpD,SAAS,CAACsD,QAAQ,EAAEG,cAAc,CAAC;UAClD,CAAC,MAAM;YACH,MAAM,IAAI,CAACzD,SAAS,CAACsD,QAAQ,EAAEF,MAAM,CAAC;UAC1C;QACJ,CAAC,CAAC,OAAO1G,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;QAClE;MACJ,CAAC;MAAA,SA/BaqB,0BAA0BA,CAAA4F,GAAA,EAAAC,GAAA,EAAAC,IAAA;QAAA,OAAAf,2BAAA,CAAAlG,KAAA,OAAAC,SAAA;MAAA;MAAA,OAA1BkB,0BAA0B;IAAA;EAAA;IAAA9B,GAAA;IAAAC,KAAA;MAAA,IAAA4H,+BAAA,OAAA1H,kBAAA,CAAAf,OAAA,EAqCxC,WACI0H,KAAa,EACbjF,IAAS,EACTkF,UAA4C,EAC/B;QACb,IAAI;UACA,IAAIA,UAAU,KAAK,SAAS,EAAE;YAC1B,IAAMC,cAAc,GAAG,GAAG/H,WAAW,CAACgI,UAAU,CAACa,WAAW,IAAIhB,KAAK,EAAE;YACvE,MAAMnD,YAAY,CAACa,UAAU,CAACwC,cAAc,CAAC;YAC7C;UACJ;UAEA,IAAMe,UAAU,GAAGC,8BAA8B,CAAClB,KAAK,EAAEjF,IAAI,CAAC;UAC9D,IAAMwF,QAAQ,GAAG,GAAGpI,WAAW,CAACgI,UAAU,CAACa,WAAW,IAAIhB,KAAK,EAAE;UACjE,MAAM,IAAI,CAAC/C,SAAS,CAACsD,QAAQ,EAAEU,UAAU,CAAC;QAC9C,CAAC,CAAC,OAAOtH,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,4CAA4C,EAAEA,KAAK,CAAC;QACtE;MACJ,CAAC;MAAA,SAlBa+B,8BAA8BA,CAAAyF,IAAA,EAAAC,IAAA,EAAAC,IAAA;QAAA,OAAAN,+BAAA,CAAAlH,KAAA,OAAAC,SAAA;MAAA;MAAA,OAA9B4B,8BAA8B;IAAA;EAAA;IAAAxC,GAAA;IAAAC,KAAA;MAAA,IAAAmI,sBAAA,OAAAjI,kBAAA,CAAAf,OAAA,EAwB5C,WACIiJ,WAAwB,EACxBC,YAAyB,EACL;QAIpB,IAAI,CAACD,WAAW,CAACE,kBAAkB,IAAID,YAAY,CAACC,kBAAkB,EAAE;UACpE,OAAOD,YAAY;QACvB;QAEA,IAAID,WAAW,CAACE,kBAAkB,IAAI,CAACD,YAAY,CAACC,kBAAkB,EAAE;UACpE,OAAOF,WAAW;QACtB;QAEA,IAAIA,WAAW,CAACE,kBAAkB,IAAID,YAAY,CAACC,kBAAkB,EAAE;UACnE,IAAIF,WAAW,CAACE,kBAAkB,GAAGD,YAAY,CAACC,kBAAkB,EAAE;YAClE,OAAOF,WAAW;UACtB,CAAC,MAAM,IACHA,WAAW,CAACE,kBAAkB,GAAGD,YAAY,CAACC,kBAAkB,EAClE;YACE,OAAOD,YAAY;UACvB,CAAC,MAAM;YAEH,OAAOD,WAAW,CAACG,aAAa,IAAIF,YAAY,CAACE,aAAa,GACxDH,WAAW,GACXC,YAAY;UACtB;QACJ;QAGA,OAAOA,YAAY;MACvB,CAAC;MAAA,SAhCab,qBAAqBA,CAAAgB,IAAA,EAAAC,IAAA;QAAA,OAAAN,sBAAA,CAAAzH,KAAA,OAAAC,SAAA;MAAA;MAAA,OAArB6G,qBAAqB;IAAA;EAAA;IAAAzH,GAAA;IAAAC,KAAA,EAqCnC,SAAQsH,WAAWA,CAACoB,KAAkB,EAAEC,MAAmB,EAAW;MAClE,OACID,KAAK,CAACH,aAAa,KAAKI,MAAM,CAACJ,aAAa,IAC5CG,KAAK,CAACE,UAAU,KAAKD,MAAM,CAACC,UAAU,IACtCF,KAAK,CAACJ,kBAAkB,KAAKK,MAAM,CAACL,kBAAkB,IACtDI,KAAK,CAACG,gBAAgB,KAAKF,MAAM,CAACE,gBAAgB,IAClDH,KAAK,CAACI,WAAW,KAAKH,MAAM,CAACG,WAAW;IAEhD;EAAC;IAAA/I,GAAA;IAAAC,KAAA;MAAA,IAAA+I,2BAAA,OAAA7I,kBAAA,CAAAf,OAAA,EAID,WACIwF,SAAwB,EACxB2B,WAAgB,EACH;QACb,IAAMpE,qBAAqB,GAAGC,6BAA6B,CAAC,CAAC;QAE7D,QAAQwC,SAAS,CAACqE,MAAM;UACpB,KAAK,QAAQ;YACT,IAAMC,aAAa,GAAGtH,GAAG,CAACO,qBAAqB,CAAC;YAChDoE,WAAW,CAAC7D,GAAG,CAACwG,aAAa,EAAApE,MAAA,CAAAC,MAAA,KACtBH,SAAS,CAAC/C,IAAI;cACjBsH,SAAS,EAAEC,eAAe,CAAC;YAAC,EAC/B,CAAC;YACF;UACJ,KAAK,QAAQ;YACT,IAAMC,SAAS,GAAGzH,GAAG,CAACO,qBAAqB,EAAEyC,SAAS,CAAC/C,IAAI,CAACE,EAAE,CAAC;YAC/DwE,WAAW,CAAC+C,MAAM,CAACD,SAAS,EAAAvE,MAAA,CAAAC,MAAA,KACrBH,SAAS,CAAC/C,IAAI;cACjB0H,SAAS,EAAEH,eAAe,CAAC;YAAC,EAC/B,CAAC;YACF;UACJ,KAAK,QAAQ;YACT,IAAMI,SAAS,GAAG5H,GAAG,CAACO,qBAAqB,EAAEyC,SAAS,CAAC/C,IAAI,CAACE,EAAE,CAAC;YAC/DwE,WAAW,CAACvD,MAAM,CAACwG,SAAS,CAAC;YAC7B;QACR;MACJ,CAAC;MAAA,SA1BahD,0BAA0BA,CAAAiD,IAAA,EAAAC,IAAA;QAAA,OAAAV,2BAAA,CAAArI,KAAA,OAAAC,SAAA;MAAA;MAAA,OAA1B4F,0BAA0B;IAAA;EAAA;IAAAxG,GAAA;IAAAC,KAAA;MAAA,IAAA0J,uBAAA,OAAAxJ,kBAAA,CAAAf,OAAA,EA+BxC,WACIwF,SAAwB,EACxB2B,WAAgB,EACH;QACb,IAAMrF,iBAAiB,GAAGC,yBAAyB,CAAC,CAAC;QACrD,IAAMyI,QAAQ,GAAGC,gBAAgB,CAACjF,SAAS,CAAC9D,MAAM,EAAE8D,SAAS,CAACkF,OAAQ,CAAC;QACvE,IAAMC,SAAS,GAAGnI,GAAG,CAACV,iBAAiB,EAAE0I,QAAQ,CAAC;QAElD,QAAQhF,SAAS,CAACqE,MAAM;UACpB,KAAK,QAAQ;UACb,KAAK,QAAQ;YACT,IAAMtH,UAAU,GAAGqI,0BAA0B,CAACpF,SAAS,CAAC/C,IAAI,CAAC;YAC7D0E,WAAW,CAAC7D,GAAG,CAACqH,SAAS,EAAEpI,UAAU,CAAC;YACtC;UACJ,KAAK,QAAQ;YACT4E,WAAW,CAACvD,MAAM,CAAC+G,SAAS,CAAC;YAC7B;QACR;MACJ,CAAC;MAAA,SAlBatD,sBAAsBA,CAAAwD,IAAA,EAAAC,IAAA;QAAA,OAAAP,uBAAA,CAAAhJ,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAtB6F,sBAAsB;IAAA;EAAA;IAAAzG,GAAA;IAAAC,KAAA;MAAA,IAAAkK,0BAAA,OAAAhK,kBAAA,CAAAf,OAAA,EAuBpC,WACIwF,SAAwB,EACxB2B,WAAgB,EACH;QAGb7F,OAAO,CAAC0J,GAAG,CAAC,gCAAgC,EAAExF,SAAS,CAAC;MAC5D,CAAC;MAAA,SAPa8B,yBAAyBA,CAAA2D,IAAA,EAAAC,IAAA;QAAA,OAAAH,0BAAA,CAAAxJ,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAzB8F,yBAAyB;IAAA;EAAA;IAAA1G,GAAA;IAAAC,KAAA,EAYvC,SAAQqD,gBAAgBA,CAACzB,IAAS,EAAU;MACxC,IAAM0I,GAAG,GAAG1G,IAAI,CAACC,SAAS,CAACjC,IAAI,CAAC;MAChC,IAAI2I,IAAI,GAAG,CAAC;MACZ,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,GAAG,CAACpH,MAAM,EAAEsH,CAAC,EAAE,EAAE;QACjC,IAAMC,IAAI,GAAGH,GAAG,CAACI,UAAU,CAACF,CAAC,CAAC;QAC9BD,IAAI,GAAG,CAACA,IAAI,IAAI,CAAC,IAAIA,IAAI,GAAGE,IAAI;QAChCF,IAAI,GAAGA,IAAI,GAAGA,IAAI;MACtB;MACA,OAAOA,IAAI,CAACI,QAAQ,CAAC,CAAC;IAC1B;EAAC;IAAA5K,GAAA;IAAAC,KAAA,EAKD,SAAQ+E,mBAAmBA,CAAA,EAAW;MAClC,OAAO,MAAM6F,IAAI,CAACnH,GAAG,CAAC,CAAC,IAAIoH,IAAI,CAACC,MAAM,CAAC,CAAC,CAACH,QAAQ,CAAC,EAAE,CAAC,CAACI,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IACxE;EAAC;IAAAhL,GAAA;IAAAC,KAAA;MAAA,IAAAgL,sBAAA,OAAA9K,kBAAA,CAAAf,OAAA,EAKD,aAAqD;QACjD,IAAI;UACA,IAAMmG,UAAU,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAAClG,iBAAiB,CAACmG,MAAM,CAAC,CAAC,CAAC;UAC9D,IAAMwF,UAAU,GAAG3F,UAAU,CAAC4F,GAAG,CAAC,UAACC,EAAE;YAAA,IAAAC,eAAA;YAAA,OAAAvG,MAAA,CAAAC,MAAA,KAC9BqG,EAAE;cACL5H,SAAS,EAAE4H,EAAE,CAAC5H,SAAS,CAACsC,QAAQ,CAAC,CAAC;cAClCE,WAAW,GAAAqF,eAAA,GAAED,EAAE,CAACpF,WAAW,qBAAdqF,eAAA,CAAgBvF,QAAQ,CAAC;YAAC;UAAA,CACzC,CAAC;UAEH,MAAMnC,YAAY,CAACC,OAAO,CACtB3E,WAAW,CAACgI,UAAU,CAACqE,WAAW,EAClCzH,IAAI,CAACC,SAAS,CAACoH,UAAU,CAC7B,CAAC;QACL,CAAC,CAAC,OAAOzK,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;QAC9D;MACJ,CAAC;MAAA,SAhBayE,qBAAqBA,CAAA;QAAA,OAAA+F,sBAAA,CAAAtK,KAAA,OAAAC,SAAA;MAAA;MAAA,OAArBsE,qBAAqB;IAAA;EAAA;IAAAlF,GAAA;IAAAC,KAAA;MAAA,IAAAsL,sBAAA,OAAApL,kBAAA,CAAAf,OAAA,EAqBnC,aAAqD;QAAA,IAAAoM,MAAA;QACjD,IAAI;UACA,IAAMC,MAAM,SAAS9H,YAAY,CAACS,OAAO,CACrCnF,WAAW,CAACgI,UAAU,CAACqE,WAC3B,CAAC;UACD,IAAI,CAACG,MAAM,EAAE;UAEb,IAAMlG,UAAU,GAAG1B,IAAI,CAACQ,KAAK,CAACoH,MAAM,CAAC;UACrC,IAAI,CAAClM,iBAAiB,CAACmM,KAAK,CAAC,CAAC;UAE9BnG,UAAU,CAAC/D,OAAO,CAAC,UAAC4J,EAAO,EAAK;YAC5B,IAAMxG,SAAwB,GAAAE,MAAA,CAAAC,MAAA,KACvBqG,EAAE;cACL5H,SAAS,EAAEC,oBAAS,CAACkI,UAAU,CAACP,EAAE,CAAC5H,SAAS,CAAC;cAC7CwC,WAAW,EAAEoF,EAAE,CAACpF,WAAW,GACrBvC,oBAAS,CAACkI,UAAU,CAACP,EAAE,CAACpF,WAAW,CAAC,GACpC5C;YAAS,EAClB;YACDoI,MAAI,CAACjM,iBAAiB,CAACmD,GAAG,CAACkC,SAAS,CAAC7C,EAAE,EAAE6C,SAAS,CAAC;UACvD,CAAC,CAAC;QACN,CAAC,CAAC,OAAOnE,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;QAC9D;MACJ,CAAC;MAAA,SAvBaL,qBAAqBA,CAAA;QAAA,OAAAmL,sBAAA,CAAA5K,KAAA,OAAAC,SAAA;MAAA;MAAA,OAArBR,qBAAqB;IAAA;EAAA;IAAAJ,GAAA;IAAAC,KAAA,EA2BnC,SAAQO,2BAA2BA,CAAA,EAAS;MAAA,IAAAoL,MAAA;MAExCC,WAAW,KAAA1L,kBAAA,CAAAf,OAAA,EAAC,aAAY;QACpB,IAAMiB,MAAM,SAASZ,QAAQ,CAAC,CAAC;QAC/B,IAAMqM,SAAS,GAAGF,MAAI,CAACpM,UAAU,CAACC,QAAQ;QAE1CmM,MAAI,CAACtL,gBAAgB,CAAC;UAAEb,QAAQ,EAAEY;QAAO,CAAC,CAAC;QAG3C,IAAIA,MAAM,IAAI,CAACyL,SAAS,EAAE;UACtBpL,OAAO,CAAC0J,GAAG,CAAC,oDAAoD,CAAC;UACjE,MAAMwB,MAAI,CAACrL,wBAAwB,CAAC,CAAC;QACzC;MACJ,CAAC,GAAE,KAAK,CAAC;IACb;EAAC;IAAAP,GAAA;IAAAC,KAAA,EAKD,SAAQiC,eAAeA,CAACzB,KAAU,EAAQ;MAAA,IAAAsL,cAAA;MACtCrL,OAAO,CAACD,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;MAGnC,IAAIA,KAAK,CAACuL,IAAI,KAAK,aAAa,KAAAD,cAAA,GAAItL,KAAK,CAACwL,OAAO,aAAbF,cAAA,CAAeG,QAAQ,CAAC,SAAS,CAAC,EAAE;QACpE,IAAI,CAAC5L,gBAAgB,CAAC;UAAEb,QAAQ,EAAE;QAAM,CAAC,CAAC;MAC9C;IACJ;EAAC;IAAAO,GAAA;IAAAC,KAAA,EAKD,SAAQK,gBAAgBA,CAAC6L,OAA4B,EAAQ;MAAA,IAAAC,MAAA;MACzD,IAAI,CAAC5M,UAAU,GAAAsF,MAAA,CAAAC,MAAA,KAAQ,IAAI,CAACvF,UAAU,EAAK2M,OAAO,CAAE;MAGpD,IAAI,CAACvM,eAAe,CAAC4B,OAAO,CAAC,UAAC6K,QAAQ,EAAK;QACvC,IAAI;UACAA,QAAQ,CAACD,MAAI,CAAC5M,UAAU,CAAC;QAC7B,CAAC,CAAC,OAAOiB,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QAC1D;MACJ,CAAC,CAAC;IACN;EAAC;IAAAT,GAAA;IAAAC,KAAA,EAKD,SAAAqM,kBAAkBA,CAACD,QAAsC,EAAc;MAAA,IAAAE,MAAA;MACnE,IAAI,CAAC3M,eAAe,CAAC4M,GAAG,CAACH,QAAQ,CAAC;MAGlCA,QAAQ,CAAC,IAAI,CAAC7M,UAAU,CAAC;MAGzB,OAAO,YAAM;QACT+M,MAAI,CAAC3M,eAAe,CAACoD,MAAM,CAACqJ,QAAQ,CAAC;MACzC,CAAC;IACL;EAAC;IAAArM,GAAA;IAAAC,KAAA,EAKD,SAAAwM,aAAaA,CAAA,EAAe;MACxB,OAAA3H,MAAA,CAAAC,MAAA,KAAY,IAAI,CAACvF,UAAU;IAC/B;EAAC;IAAAQ,GAAA;IAAAC,KAAA;MAAA,IAAAyM,kBAAA,OAAAvM,kBAAA,CAAAf,OAAA,EAMD,WAAwB0B,MAAc,EAAiB;QACnD,IAAI,CAAC,IAAI,CAACtB,UAAU,CAACC,QAAQ,EAAE;UAC3B,MAAM,IAAIuB,KAAK,CAAC,iCAAiC,CAAC;QACtD;QAEA,IAAI;UACA,IAAI,CAACV,gBAAgB,CAAC;YAAEX,cAAc,EAAE;UAAK,CAAC,CAAC;UAG/C,MAAM,IAAI,CAACgN,eAAe,CAAC7L,MAAM,CAAC;UAGlC,MAAM,IAAI,CAAC8L,mBAAmB,CAAC9L,MAAM,CAAC;UAEtC,IAAI,CAACR,gBAAgB,CAAC;YAAEZ,QAAQ,EAAE+D,oBAAS,CAACC,GAAG,CAAC;UAAE,CAAC,CAAC;QACxD,CAAC,SAAS;UACN,IAAI,CAACpD,gBAAgB,CAAC;YAAEX,cAAc,EAAE;UAAM,CAAC,CAAC;QACpD;MACJ,CAAC;MAAA,SAlBKkN,iBAAiBA,CAAAC,IAAA;QAAA,OAAAJ,kBAAA,CAAA/L,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAjBiM,iBAAiB;IAAA;EAAA;IAAA7M,GAAA;IAAAC,KAAA;MAAA,IAAA8M,gBAAA,OAAA5M,kBAAA,CAAAf,OAAA,EAuBvB,WAA8B0B,MAAc,EAAiB;QACzD,IAAMI,iBAAiB,GAAGC,yBAAyB,CAAC,CAAC;QAGrDT,OAAO,CAAC0J,GAAG,CAAC,2BAA2B,EAAEtJ,MAAM,CAAC;MACpD,CAAC;MAAA,SALa6L,eAAeA,CAAAK,IAAA;QAAA,OAAAD,gBAAA,CAAApM,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAf+L,eAAe;IAAA;EAAA;IAAA3M,GAAA;IAAAC,KAAA;MAAA,IAAAgN,oBAAA,OAAA9M,kBAAA,CAAAf,OAAA,EAU7B,WAAkC0B,MAAc,EAAiB;QAC7D,IAAMqB,qBAAqB,GAAGC,6BAA6B,CAAC,CAAC;QAG7D1B,OAAO,CAAC0J,GAAG,CAAC,+BAA+B,EAAEtJ,MAAM,CAAC;MACxD,CAAC;MAAA,SALa8L,mBAAmBA,CAAAM,IAAA;QAAA,OAAAD,oBAAA,CAAAtM,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAnBgM,mBAAmB;IAAA;EAAA;IAAA5M,GAAA;IAAAC,KAAA;MAAA,IAAAkN,WAAA,OAAAhN,kBAAA,CAAAf,OAAA,EAUjC,aAAkC;QAC9B,IAAI;UACA,MAAMuE,YAAY,CAACyJ,WAAW,CAAC,CAC3BnO,WAAW,CAACgI,UAAU,CAACC,OAAO,EAC9BjI,WAAW,CAACgI,UAAU,CAACa,WAAW,EAClC7I,WAAW,CAACgI,UAAU,CAACqE,WAAW,EAClCrM,WAAW,CAACgI,UAAU,CAACoG,SAAS,CACnC,CAAC;UAEF,IAAI,CAAC9N,iBAAiB,CAACmM,KAAK,CAAC,CAAC;UAC9B,IAAI,CAACpL,gBAAgB,CAAC;YAClBf,iBAAiB,EAAE,CAAC;YACpBG,QAAQ,EAAE;UACd,CAAC,CAAC;QACN,CAAC,CAAC,OAAOe,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;QAClD;MACJ,CAAC;MAAA,SAjBK6M,UAAUA,CAAA;QAAA,OAAAH,WAAA,CAAAxM,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAV0M,UAAU;IAAA;EAAA;IAAAtN,GAAA;IAAAC,KAAA,EAlnBhB,SAAcsN,WAAWA,CAAA,EAAgB;MACrC,IAAI,CAACtO,WAAW,CAACuO,QAAQ,EAAE;QACvBvO,WAAW,CAACuO,QAAQ,GAAG,IAAIvO,WAAW,CAAC,CAAC;MAC5C;MACA,OAAOA,WAAW,CAACuO,QAAQ;IAC/B;EAAC;AAAA;AA7BQvO,WAAW,CAaIgI,UAAU,GAAG;EACjCC,OAAO,EAAE,sBAAsB;EAC/BY,WAAW,EAAE,0BAA0B;EACvCwD,WAAW,EAAE,0BAA0B;EACvC+B,SAAS,EAAE;AACf,CAAC;AA6oBE,IAAMI,WAAW,GAAAvO,OAAA,CAAAuO,WAAA,GAAGxO,WAAW,CAACsO,WAAW,CAAC,CAAC","ignoreList":[]}